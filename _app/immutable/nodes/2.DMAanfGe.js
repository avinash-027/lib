import{c as ht,a as k,f as M,e as Xt}from"../chunks/CD1qz442.js";import{i as Ie}from"../chunks/B8tiu_hu.js";import{e as Yt,u as J,h as Ft,D as Le,E as ze,G as Be,z as te,I as a,K as l,y as e,J as t,F as Y,Q as ia,L as Mt,M as Zt,O as s,P as T,aT as da,aD as Te,bd as pt,be as je,bf as ca,$ as va}from"../chunks/DAkF8UHE.js";import{h as ua}from"../chunks/CEBlMecO.js";import{d as ba,w as Nt,c as nt,o as Bt}from"../chunks/C9gZSnLM.js";import{s as oe,e as d,r as pa}from"../chunks/xc5Rns4w.js";import{p as fe,i as U,a as Ee,s as ot}from"../chunks/DNRQKU6i.js";import{t as ga,d as se,e as $e,j as De,s as wt,h as he,S as W,r as de,k as ee,l as Kt,a as Ge,b as Qe,f as Qt,g as fa,i as He,m as Rt,R as Wt,n as Ve,c as ma,o as Pt,p as Vt,E as ha}from"../chunks/ChoHfNTb.js";import{g as wa,b as xa}from"../chunks/CQqm8InT.js";import{b as Lt}from"../chunks/3hUq8g6e.js";function _a(g,r,i){Yt(()=>{var u=J(()=>r(g,i?.())||{});if(u?.destroy)return()=>u.destroy()})}function ea(g,r,i,u){var h=g.__style;if(Ft||h!==r){var v=ga(r);(!Ft||v!==g.getAttribute("style"))&&(v==null?g.removeAttribute("style"):g.style.cssText=v),g.__style=r}return u}function ya(){const{subscribe:g,set:r,update:i}=Nt([]);return{subscribe:g,set:r,update:i,load:async()=>{const u=await se.getAllEntries();return r(u),u},add:async u=>{const h=await se.addEntry(u);i(v=>[...v,{...u,id:h}])},updateEntry:async(u,h)=>{await se.updateEntry(u,h),i(v=>v.map(w=>w.id===u?{...w,...h}:w))},deleteEntry:async u=>{await se.deleteEntry(u),i(h=>h.filter(v=>v.id!==u))}}}const Et=ya(),Oe=Nt(""),Je=Nt("default"),rt=jt("libsettings:selectedCategory","All"),gt=jt("libsettings:sortField","createdAt"),ft=jt("libsettings:sortOrder","desc"),Gt=jt("lib:gridCols",4),ka=ba([Et,rt,Oe,Je,gt,ft],([g,r,i,u,h,v])=>{let w=[...g];if(r!=="All"&&(w=w.filter(p=>p.category===r)),i){const p=i.toLowerCase();w=w.filter(b=>{switch(u){case"a":return b.alternativeTitles.join(" ").toLowerCase().includes(p);case"t":return b.tags.join(" ").toLowerCase().includes(p);case"b":return b.badges.join(" ").toLowerCase().includes(p);case"c":return b.characters.map(j=>j.Name).join(" ").toLowerCase().includes(p);case"d":return b.dataType.toLowerCase().includes(p);default:return b.title.toLowerCase().includes(p)||b.alternativeTitles.join(" ").toLowerCase().includes(p)}})}return w=w.sort((p,b)=>{const j=p[h]??"",D=b[h]??"";return v==="asc"?j>D?1:-1:j<D?1:-1}),w});function jt(g,r){const i=localStorage.getItem(g),{subscribe:u,set:h,update:v}=Nt(i?JSON.parse(i):r);return{subscribe:u,set:w=>{localStorage.setItem(g,JSON.stringify(w)),h(w)},update:w=>{v(p=>{const b=w(p);return localStorage.setItem(g,JSON.stringify(b)),b})}}}let mt=null;async function Ca(){try{const i=await window.showDirectoryPicker()}catch(i){console.error("Failed to open directory picker",i),alert("Cannot open folder in this browser. Try Edge or Chrome.")}const g={mode:"readwrite"};await dirHandle.queryPermission(g)!=="granted"&&await dirHandle.requestPermission(g);const r=(await se.getDB()).transaction("settings","readwrite");await r.objectStore("settings").put(dirHandle,"backupDirHandle"),await r.objectStore("settings").put(dirHandle.name,"backupFolderName"),await r.done,localStorage.setItem("autoBackupEnabled","true"),Ot(dirHandle),await ta(dirHandle)}function Sa(){localStorage.removeItem("autoBackupEnabled"),localStorage.removeItem("autoBackupDirHandle"),localStorage.removeItem("autoBackupFolderName"),mt&&clearTimeout(mt)}async function Aa(){if(localStorage.getItem("autoBackupEnabled")!=="true")return;const r=await(await se.getDB()).get("settings","backupDirHandle");r&&Ot(r)}async function ta(g){const r=await se.exportToJSON(),u=await(await g.getFileHandle("lib-autobackup.json",{create:!0})).createWritable();await u.write(JSON.stringify(r,null,2)),await u.close(),console.log("‚úÖ Auto backup saved at",new Date().toLocaleString())}function Ot(g){mt&&clearTimeout(mt);const r=new Date,i=new Date;i.setHours(12,0,0,0);const u=new Date;u.setHours(24,0,0,0);let h;r<i?h=i:h=u;const v=h.getTime()-r.getTime();mt=window.setTimeout(async()=>{await g.queryPermission({mode:"readwrite"})==="granted"&&await ta(g),Ot(g)},v)}function Ta(g){const r=new IntersectionObserver(([i],u)=>{if(i.isIntersecting){const h=g.dataset.src;h&&(g.src=h),g.classList.add("lozad-loaded"),u.unobserve(g)}});return r.observe(g),{destroy(){r.unobserve(g)}}}var Ea=M('<div class="px-1 w-full opacity-80 text-sm h-65 md:h-55 flex items-end justify-center text-base-content/50"><div>No entries found. <ul class="list-disc list-inside mt-1"><li>Add new entries by clicking the <b>"+"</b> button.</li> <li>To Manage categories, click the "Categories" button in the <b>Drawer Menu</b>.</li></ul></div></div>'),Ma=M('<button type="button"><!></button>'),Na=M('<img class="w-full h-full object-cover lozad"/>'),ja=M('<div class="w-full h-full flex items-center justify-center text-base-content/20"><!></div>'),$a=M('<span class="absolute top-1 right-1 rounded-2xl text-[.84em] md:text-sm bg-base-200 px-1 py-0"> </span>'),Da=M('<span class="absolute top-1.5 left-1 rounded-2xl text-xs md:text-sm bg-info text-base-300 px-1 py-0 font-semibold"> </span>'),Ia=M('<div class="relative"><!> <button class="card bg-base-100 shadow-xl cursor-pointer hover:shadow-2xl transition-shadow w-full h-full"><figure class="aspect-[3/4] bg-base-300"><!></figure> <div class="card-body p-2"><!> <!> <h3 class="card-title text-xs sm:text-sm line-clamp-2"> </h3></div></button></div>'),La=M("<div></div>");function Ba(g,r){Le(r,!1);let i=fe(r,"entries",24,()=>[]),u=fe(r,"selectionMode",8,!1),h=fe(r,"selectedEntries",24,()=>new Set),v=fe(r,"gridCols",8,4);const w=nt();function p(C){!u()&&C!==void 0&&wa(`${xa}/detail/${C}`)}function b(C){w("toggleSelect",C)}const j={2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5"};Ie();var D=ht(),N=ze(D);{var I=C=>{var S=Ea();k(C,S)},L=C=>{var S=La();$e(S,5,i,x=>x.id,(x,_)=>{var P=Ia(),y=a(P);{var f=c=>{var E=Ma();let G;var ce=a(E);{var ve=K=>{var Q=ht(),q=ze(Q);he(q,()=>(te(W),J(()=>W.selectTick))),k(K,Q)},le=ia(()=>(te(h()),e(_),J(()=>h().has(e(_).id))));U(ce,K=>{e(le)&&K(ve)})}t(E),Y(K=>G=De(E,1,"rounded-xl absolute inset-0 z-10 flex items-center justify-center bg-black/20 cursor-pointer transition-opacity",null,G,K),[()=>({selected:h().has(e(_).id)})]),d("click",E,K=>{K.stopPropagation(),b(e(_).id)}),k(c,E)};U(y,c=>{u()&&c(f)})}var $=l(y,2),O=a($),F=a(O);{var H=c=>{var E=Na();_a(E,G=>Ta?.(G)),Y(()=>{wt(E,"src",(e(_),J(()=>e(_).coverImageUrl))),wt(E,"alt",(e(_),J(()=>e(_).title)))}),pa(E),k(c,E)},X=c=>{var E=ja(),G=a(E);he(G,()=>(te(W),J(()=>W.imgIcon))),t(E),k(c,E)};U(F,c=>{e(_),J(()=>e(_).coverImageUrl)?c(H):c(X,!1)})}t(O);var A=l(O,2),R=a(A);{var re=c=>{var E=$a(),G=a(E,!0);t(E),Y(()=>oe(G,(e(_),J(()=>e(_).dataType)))),k(c,E)};U(R,c=>{e(_),J(()=>e(_).dataType)&&c(re)})}var ae=l(R,2);{var Z=c=>{var E=Da(),G=a(E,!0);t(E),Y(()=>oe(G,(e(_),J(()=>e(_).rating)))),k(c,E)};U(ae,c=>{e(_),J(()=>e(_).rating!==null&&e(_).rating>0)&&c(Z)})}var ne=l(ae,2),V=a(ne,!0);t(ne),t(A),t($),t(P),Y(()=>oe(V,(e(_),J(()=>e(_).title)))),d("click",$,()=>p(e(_).id)),k(x,P)}),t(S),Y(()=>De(S,1,(te(v()),J(()=>`grid gap-2 ${j[v()]} md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10`)))),k(C,S)};U(N,C=>{te(i()),J(()=>i().length===0)?C(I):C(L,!1)})}k(g,D),Be()}var Oa=M("alternative titles <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Ja=M("tags <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Ha=M("badges <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),za=M("characters <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Ua=M('<div class="text-xs text-info mt-2">Searching in: <!> <!> <!> <!></div>'),qa=M(`<div class="bg-base-200 px-4 pt-3 pb-1 shadow-lg"><div class="flex gap-2 items-center"><input type="text" placeholder="Search ('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)" class="input input-bordered flex-1"/> <button class="btn btn-square btn-ghost" aria-label="Close search"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <!></div>`);function Fa(g,r){Le(r,!1);const i=()=>Ee(Je,"$searchMode",u),[u,h]=ot();let v=fe(r,"show",12,!1),w=T(""),p=T();async function b(){await da(),e(p)?.focus()}function j(){s(w,""),Oe.set(""),Je.set("default"),v(!1)}Mt(()=>te(v()),()=>{v()&&b()}),Mt(()=>(e(w),Oe),()=>{const x=e(w).trim(),_=x.toLowerCase();_.startsWith("a:")?(Je.set("a"),Oe.set(x.slice(2))):_.startsWith("t:")?(Je.set("t"),Oe.set(x.slice(2))):_.startsWith("b:")?(Je.set("b"),Oe.set(x.slice(2))):_.startsWith("c:")?(Je.set("c"),Oe.set(x.slice(2))):_.startsWith("d:")?(Je.set("d"),Oe.set(x.slice(2))):(Je.set("default"),Oe.set(x))}),Zt(),Ie();var D=qa(),N=a(D),I=a(N);de(I),Lt(I,x=>s(p,x),()=>e(p));var L=l(I,2);t(N);var C=l(N,2);{var S=x=>{var _=Ua(),P=l(a(_));{var y=A=>{var R=Oa();Te(2),k(A,R)};U(P,A=>{i()==="a"&&A(y)})}var f=l(P,2);{var $=A=>{var R=Ja();Te(2),k(A,R)};U(f,A=>{i()==="t"&&A($)})}var O=l(f,2);{var F=A=>{var R=Ha();Te(2),k(A,R)};U(O,A=>{i()==="b"&&A(F)})}var H=l(O,2);{var X=A=>{var R=za();Te(2),k(A,R)};U(H,A=>{i()==="c"&&A(X)})}t(_),k(x,_)};U(C,x=>{i()!=="default"&&x(S)})}t(D),ee(I,()=>e(w),x=>s(w,x)),d("click",L,j),k(g,D),Be(),h()}var Ra=M('<div class="fixed inset-0 bg-black/50 z-150 flex items-end" role="presentation"><div class="bg-base-100 w-full rounded-t-2xl p-6 max-h-[80vh] overflow-auto" role="dialog" tabindex="-1"><h3 class="text-2xl font-bold mb-6">Sort & Filter</h3> <div class="form-control mb-4"><label class="label" for="sort-field"><span class="label-text font-semibold">Sort By</span></label> <select id="sort-field" class="select select-bordered w-full"><option>Title (A-Z)</option><option>Rating</option><option>Last Edited</option><option>Date Created</option><option>Last Opened</option></select></div> <div class="form-control mb-6"><label class="label" for="sort-order"><span class="label-text font-semibold">Order</span></label> <div class="flex gap-2"><button>Ascending</button> <button>Descending</button></div></div> <div class="flex gap-2"><button class="btn btn-outline flex-1">Reset</button> <button class="btn btn-primary flex-1">Apply</button></div></div></div>');function Wa(g,r){Le(r,!1);const i=()=>Ee(gt,"$sortField",h),u=()=>Ee(ft,"$sortOrder",h),[h,v]=ot();let w=fe(r,"show",12,!1),p=T(i()),b=T(u());gt.subscribe(C=>s(p,C)),ft.subscribe(C=>s(b,C));function j(){gt.set(e(p)),ft.set(e(b)),w(!1)}function D(){s(p,"title"),s(b,"asc"),gt.set(e(p)),ft.set(e(b)),w(!1)}Ie();var N=ht(),I=ze(N);{var L=C=>{var S=Ra(),x=a(S),_=l(a(x),2),P=l(a(_),2),y=a(P);y.value=y.__value="title";var f=l(y);f.value=f.__value="rating";var $=l(f);$.value=$.__value="editedAt";var O=l($);O.value=O.__value="createdAt";var F=l(O);F.value=F.__value="openedAt",t(P),t(_);var H=l(_,2),X=l(a(H),2),A=a(X);let R;var re=l(A,2);let ae;t(X),t(H);var Z=l(H,2),ne=a(Z),V=l(ne,2);t(Z),t(x),t(S),Y(()=>{R=De(A,1,"btn flex-1",null,R,{"btn-primary":e(b)==="asc"}),wt(A,"aria-pressed",e(b)==="asc"),ae=De(re,1,"btn flex-1",null,ae,{"btn-primary":e(b)==="desc"}),wt(re,"aria-pressed",e(b)==="desc")}),Kt(P,()=>e(p),c=>s(p,c)),d("click",A,()=>s(b,"asc")),d("click",re,()=>s(b,"desc")),d("click",ne,D),d("click",V,j),d("click",x,Ge(function(c){Qe.call(this,r,c)})),d("keydown",x,function(c){Qe.call(this,r,c)}),d("click",S,()=>w(!1)),d("keydown",S,function(c){Qe.call(this,r,c)}),k(C,S)};U(I,C=>{w()&&C(L)})}k(g,N),Be(),v()}const Pa=`\`\`\`json\r
// Example\r
[\r
  {\r
    "id": 2,\r
    "title": "Solo Leveling",\r
    "alternativeTitles": [ "Only I Level Up", "Na Honja Level Up" ],\r
    "coverImageUrl": "https://example.com/covers/solo-leveling.jpg",\r
    "description": "In a world where gates connect Earth to deadly dungeons, the weakest hunter awakens a mysterious system that allows him to level up alone.",\r
    "badges": ["Manhwa", "Action", "Fantasy", "Completed"],\r
    "tags": [ "gates", "hunters", "dungeons", "system", "shadows", "awakening"],\r
    "rating": null,\r
    "createdAt": "2024-12-15T08:20:00.000Z",\r
    "openedAt": "2025-02-07T14:10:30.000Z",\r
    "editedAt": "2025-02-07T18:45:10.000Z",\r
    "characters": [\r
      {\r
        "Name": "Sung Jin-Woo",\r
        "Image": "https://example.com/characters/sung-jin-woo.png",\r
        "role": "Main",\r
        "alternativeNames": [ "Jinwoo"],\r
        "tags": ["MC", "Solo-Player"],\r
        "description": ""\r
      },\r
      {\r
        "Name": "Cha Hae-In",\r
        "role": "Main",\r
        "Image": "https://example.com/characters/cha-hae-in.png"\r
      },\r
      {\r
        "Name": "Go Gun-Hee",\r
        "role": "supporting",\r
        "Image": "https://example.com/characters/go-gun-hee.png"\r
      }\r
    ],\r
    "rows": [\r
      {\r
        "ChapterSE": "Episode 1 ‚Äì The Weakest Hunter",\r
        "Description": "E-rank hunter Sung Jin-Woo barely survives a low-level dungeon while struggling to pay his family‚Äôs medical bills.",\r
        "Tags": ["introduction", "low-rank", "desperation"],\r
        "Characters": "Sung Jin-Woo"\r
      },\r
      {\r
        "ChapterSE": "Episode 2 ‚Äì Double Dungeon",\r
        "Description": "A hidden dungeon reveals a deadly trial where survival depends on following cryptic rules.",\r
        "Tags": ["double-dungeon", "statues", "death"],\r
        "Characters": "Sung Jin-Woo, Dungeon Party"\r
      },\r
      {\r
        "ChapterSE": "Episode 3 ‚Äì The System",\r
        "Description": "After facing death, Jin-Woo awakens to a mysterious system that only he can see.",\r
        "Tags": ["awakening", "system", "rebirth"],\r
        "Characters": "Sung Jin-Woo"\r
      }\r
    ],\r
    "category": "Manhwa",\r
    "dataType": "json"\r
  },\r
  // ...\r
]\r
\`\`\``;var Va=M('<div role="alert" class="fixed bottom-2 left-2 z-300 alert alert-info alert-outline bg-base-100"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>');function Jt(g,r){let i=fe(r,"showAlert",8,!1),u=fe(r,"message",8,"");var h=ht(),v=ze(h);{var w=p=>{var b=Va(),j=l(a(b),2),D=a(j,!0);t(j),t(b),Y(()=>oe(D,u())),k(p,b)};U(v,p=>{i()&&p(w)})}k(g,h)}var Ga=M('<div class="text-xs text-gray-500 mt-1 pl-1"> <br/> ‚è∞ Every 12 hours (12:00 AM & 12:00 PM)</div>'),Xa=M('<button class="btn btn-md btn-ghost rounded-full flex justify-between py-3 px-0"><span>üïõ Auto Backup :</span> <input type="checkbox" class="toggle toggle-primary"/> </button> <!> <!>',1);function Ya(g,r){Le(r,!1);let i=T(localStorage.getItem("autoBackupEnabled")==="true"),u=T(localStorage.getItem("autoBackupFolderName")),h=T(!1),v=T("");async function w(){try{e(i)?(Sa(),s(i,!1),s(u,null),s(v,"Auto backup disabled")):(await Ca(),s(i,!0),s(u,localStorage.getItem("autoBackupFolderName")),s(v,"Auto backup enabled (12:00 AM & 12:00 PM)"))}catch{s(i,!1),s(v,"Backup permission denied")}s(h,!0),setTimeout(()=>s(h,!1),1500)}Ie();var p=Xa(),b=ze(p),j=l(a(b),2);de(j);var D=l(j,1,!0);t(b);var N=l(b,2);{var I=C=>{var S=Ga(),x=a(S);Te(2),t(S),Y(()=>oe(x,`üìÅ ${e(u)??""}/lib-autobackup.json`)),k(C,S)};U(N,C=>{e(i)&&e(u)&&C(I)})}var L=l(N,2);Jt(L,{get showAlert(){return e(h)},get message(){return e(v)}}),Y(()=>{Qt(j,e(i)),oe(D,e(i)==!0?"On":"Off")}),d("click",b,w),k(g,p),Be()}var Za=M('<div class="fixed inset-0 bg-black/50 z-150 flex" role="presentation"><div class="bg-base-100 w-80 h-full shadow-xl p-6 flex flex-col justify-between" role="dialog" tabindex="-1"><div><h2 class="text-2xl font-bold mb-6">Menu <button class="float-right cursor-pointer" aria-label="Close menu" type="button"><!></button></h2> <ul class="menu bg-base-200 rounded-box gap-1 md:gap-3"><li><button aria-label="Import JSON" class="btn btn-md btn-ghost"><!> Import JSON</button></li> <li><button aria-label="Export data" class="btn btn-md btn-ghost"><!> Export JSON</button></li> <li><button class="btn btn-md btn-ghost" aria-label="Export Markdown"><!> Export Md</button></li> <li><button aria-label="Open categories" class="btn btn-md btn-ghost"><!> Categories</button></li> <li><button class="btn btn-md btn-ghost">JSON Format</button></li></ul></div> <dialog class="modal"><div class="modal-box max-w-3xl w-85 md:w-full h-auto max-h-[65vh]"><form method="dialog"><button type="button" aria-label="CloseJSONmodal" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 text-lg p-5"><!></button></form> <h3 class="font-bold mb-2">Import JSON Structure</h3> <div class="prose max-w-full overflow-auto text-sm"><!></div></div></dialog> <div class="text-sm text-gray-500"><!> <div class="divider"></div> <p class="font-semibold my-4">ü§ñ AI √ó <a href="https://github.com/avinash-027/" target="_blank" class="link link-primary no-underline">User-A027</a> üë®‚Äçüíª</p></div></div></div>'),Ka=M('<!> <!> <input type="file" accept=".json" class="hidden"/>',1);function Qa(g,r){Le(r,!1);let i=fe(r,"show",12,!1),u=T(""),h=T(!1);const v=nt();let w=T();function p(){e(w).click()}function b(y){const $=y.target.files?.[0];if(!$)return;const O=new FileReader;O.onload=F=>{try{const H=JSON.parse(F.target?.result),X=Array.isArray(H)?H:[H];v("import",X)}catch{s(u,"Invalid JSON file"),s(h,!0),setTimeout(()=>{s(h,!1)},2e3)}},O.readAsText($)}function j(){v("export")}let D=fa.parse(Pa),N=T();function I(){e(N).showModal()}function L(){e(N).close()}Ie();var C=Ka(),S=ze(C);Jt(S,{get showAlert(){return e(h)},get message(){return e(u)}});var x=l(S,2);{var _=y=>{var f=Za(),$=a(f),O=a($),F=a(O),H=l(a(F)),X=a(H);he(X,()=>(te(W),J(()=>W.circleClose))),t(H),t(F);var A=l(F,2),R=a(A),re=a(R),ae=a(re);he(ae,()=>(te(W),J(()=>W.import))),Te(),t(re),t(R);var Z=l(R,2),ne=a(Z),V=a(ne);he(V,()=>(te(W),J(()=>W.export))),Te(),t(ne),t(Z);var c=l(Z,2),E=a(c),G=a(E);he(G,()=>(te(W),J(()=>W.export))),Te(),t(E),t(c);var ce=l(c,2),ve=a(ce),le=a(ve);he(le,()=>(te(W),J(()=>W.category))),Te(),t(ve),t(ce);var K=l(ce,2),Q=a(K);t(K),t(A),t(O);var q=l(O,2),ue=a(q),Me=a(ue),Se=a(Me),be=a(Se);he(be,()=>(te(W),J(()=>W.circleClose))),t(Se),t(Me);var pe=l(Me,4),Ae=a(pe);he(Ae,()=>D),t(pe),t(ue),t(q),Lt(q,ie=>s(N,ie),()=>e(N));var ke=l(q,2),Xe=a(ke);Ya(Xe,{}),Te(4),t(ke),t($),t(f),d("click",H,()=>i(!1)),d("click",re,p),d("click",ne,j),d("click",E,()=>v("exportMd")),d("click",ve,()=>v("showCategories")),d("click",Q,I),d("click",Se,L),d("click",q,ie=>{ie.target===e(N)&&L()}),d("click",$,Ge(function(ie){Qe.call(this,r,ie)})),d("keydown",$,Ge(function(ie){Qe.call(this,r,ie)})),d("click",f,()=>i(!1)),d("keydown",f,ie=>ie.key==="Escape"&&i(!1)),k(y,f)};U(x,y=>{i()&&y(_)})}var P=l(x,2);Lt(P,y=>s(w,y),()=>e(w)),d("change",P,b),k(g,C),Be()}var el=M('<option class="border border-base-200"> </option>'),tl=M("<span>|</span>"),al=M("<span> </span>"),ll=M('<div class="flex gap-2 flex-wrap mb-2 p-2 rounded-lg bg-base-200 border border-base-300"><div class="flex gap-2"><label class="floating-label w-full" for="charName"><span><span class="label-text">Name **</span></span> <input type="text" id="charName" placeholder="Name *" class="input input-sm w-full md:w-100"/></label> <label class="floating-label w-full" for="charRole"><span><span class="label-text">Role</span></span> <input type="text" id="charRole" placeholder="role" class="input input-sm w-full md:w-93"/></label> <button class="btn btn-sm btn-square btn-error btn-outline">‚úï</button></div> <label class="floating-label w-full" for="charImgUrl"><span><span class="label-text">Image URL</span></span> <input type="text" id="charImgUrl" placeholder="Img URL" class="input input-sm w-full"/></label> <label class="floating-label w-full sm:w-100" for="charAltNames"><span><span class="label-text">alternativeNames</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="charAltNames" placeholder="Alternative Names [Ex: Name01, name-01]" class="input input-sm w-full"/></label> <label class="floating-label w-full sm:w-1/2" for="charTags"><span><span class="label-text">char-Tags</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="charTags" placeholder="Tags [Ex: Hero, Villain]" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charDescription"><span><span class="label-text">Description</span></span> <textarea id="charDescription" placeholder="Description" class="textarea textarea-bordered w-full"></textarea></label></div>'),sl=M('<div class="card bg-base-200 border border-base-300 p-4"><div class="flex gap-2 mb-2"><label class="floating-label w-full"><span>Chapter *</span> <input type="text" placeholder="Chapter (e.g., 1-5)" class="input input-bordered w-full input-sm flex-1"/></label> <button class="btn btn-square btn-error btn-outline btn-sm"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-4 h-4 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <label class="floating-label w-full"><span>Description</span> <textarea placeholder="Description" class="textarea textarea-bordered w-full textarea-sm mb-2"></textarea></label> <label class="floating-label w-full"><span>Tags (comma separated)</span> <input type="text" placeholder="Tags (comma separated)" class="input input-bordered w-full input-sm mb-2"/></label> <label class="floating-label w-full"><span>Characters</span> <input type="text" placeholder="Characters" class="input input-bordered w-full input-sm"/></label></div>'),rl=M('<div class="fixed inset-0 bg-black/50 z-150 flex items-center justify-center p-4"><div class="bg-base-100 w-full max-w-4xl max-h-[90vh] overflow-auto rounded-lg shadow-xl"><div class="bg-base-100 border-b border-base-300 p-4 flex justify-between items-center"><h2 class="text-2xl font-bold"> </h2> <button class="btn btn-square btn-ghost btn-sm"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-6 space-y-4"><div class="form-control"><label for="newtitle" class="floating-label"><span>Title <span class="label-text-alt text-info italic">: required</span></span> <input id="newtitle" type="text" placeholder="Title" class="input input-bordered w-full" required=""/></label></div> <div class="form-control"><label for="newAltTitles" class="floating-label"><span><span class="label-text">Alternative Titles</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="newAltTitles" type="text" placeholder="Alternative Titles [Ex: Title1, Title2]" class="input input-bordered w-full"/></label></div> <div class="form-control"><label for="newCoverImg" class="floating-label"><span class="label-text">Cover Image URL</span> <input id="newCoverImg" type="text" placeholder="Cover Image URL: Web Img Link" class="input input-bordered w-full"/></label></div> <div class="form-control"><label class="floating-label"><span class="label-text">Description</span> <textarea placeholder="Description" class="textarea textarea-bordered w-full h-24"></textarea></label></div> <div class="form-control"><label for="newBadges" class="floating-label"><span><span class="label-text">Badges</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <textarea id="newBadges" placeholder="Badges [Ex: Completed, Ongoing, Author, Artist, Favorite]" class="textarea textarea-bordered w-full"></textarea></label></div> <div class="form-control"><label for="newTags" class="floating-label"><span><span class="label-text">Tags</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <textarea id="newTags" placeholder="Tags [Ex: Themes, Genres]" class="textarea textarea-bordered w-full"></textarea></label></div> <div class="form-control"><label class="floating-label"><span class="label-text font-semibold">Category</span></label> <select class="select select-bordered w-full"><option class="border border-base-content/20 hover:bg-base-200">All</option><!></select></div> <div class="form-control"><label class="flex flex-wrap gap-2 justify-between"><span><span class="label-text font-semibold">Rating <span class="text-info">(0‚Äì10)</span></span></span> <div class="text-xs md:text-sm text-info"><span class="font-semibold">Value:</span> </div></label> <div class="w-full max-w-xs"><input type="range" min="0" max="10" step="1" class="range range-xs range-info"/> <div class="flex justify-between px-2.5 mt-1 text-xs"></div> <div class="flex justify-between px-2.5 mt-1 text-xs"></div></div></div> <div class="divider">Characters</div> <div class="space-y-2"><!> <button class="btn btn-outline btn-sm">+ Add Character</button></div> <div class="divider">Chapters</div> <div class="space-y-2"><!> <button class="btn btn-outline btn-sm">+ Add Chapter</button></div></div> <div class="sticky bottom-0 bg-base-100 border-t border-base-300 p-4 flex gap-2 justify-end"><button class="btn btn-outline">Cancel</button> <button class="btn btn-primary">Save</button></div></div></div>');function nl(g,r){Le(r,!1);const i=()=>Ee(Ve,"$categories",u),[u,h]=ot();let v=fe(r,"entryId",8,null);const w=nt();let p=T(""),b=T(""),j=T(""),D=T(""),N=T(""),I=T(0),L=T(""),C=T("All"),S=T([]),x=T([]);Bt(async()=>{if(v()!==null){const m=await se.getEntryById(v());m&&(s(p,m.title),s(b,m.alternativeTitles.join(", ")),s(j,m.coverImageUrl||""),s(D,m.description),s(N,m.badges.join(", ")),s(I,Number(m.rating)),s(L,m.tags.join(", ")),s(C,m.category),s(S,m.characters.map(o=>({...o,_alternativeNamesString:(o.alternativeNames??[]).join(", "),_tagsString:(o.tags??[]).join(", ")}))),s(x,m.rows.map(o=>({...structuredClone(o),_tagsText:o.Tags.join(", ")}))))}});function _(){s(S,[...e(S),{Name:"",Image:"",role:"",alternativeNames:[],tags:[],description:"",_alternativeNamesString:"",_tagsString:""}])}function P(m){s(S,e(S).filter((o,z)=>z!==m))}function y(){s(x,[...e(x),{ChapterSE:"",Description:"",Characters:"",_tagsText:""}])}function f(m){s(x,e(x).filter((o,z)=>z!==m))}async function $(){const m={title:e(p),alternativeTitles:e(b).split(",").map(o=>o.trim()).filter(Boolean),coverImageUrl:e(j)||null,description:e(D),badges:e(N).split(",").map(o=>o.trim()).filter(Boolean),rating:Number(e(I)),createdAt:null,openedAt:null,editedAt:null,tags:e(L).split(",").map(o=>o.trim()).filter(Boolean),category:e(C)||"All",dataType:"Lib",characters:e(S).filter(o=>o.Name).map(o=>({Name:o.Name,Image:o.Image,role:o.role,description:o.description,alternativeNames:(o._alternativeNamesString??"").split(",").map(z=>z.trim()).filter(Boolean),tags:(o._tagsString??"").split(",").map(z=>z.trim()).filter(Boolean)})),rows:e(x).filter(o=>o.ChapterSE).map(o=>({ChapterSE:o.ChapterSE,Description:o.Description,Characters:o.Characters,Tags:o._tagsText.split(",").map(z=>z.trim()).filter(Boolean)}))};v()!==null?await se.updateEntry(v(),m):await se.addEntry(m),w("save")}function O(){w("cancel")}Ie();var F=rl(),H=a(F),X=a(H),A=a(X),R=a(A,!0);t(A);var re=l(A,2);t(X);var ae=l(X,2),Z=a(ae),ne=a(Z),V=l(a(ne),2);de(V),t(ne),t(Z);var c=l(Z,2),E=a(c),G=l(a(E),2);de(G),t(E),t(c);var ce=l(c,2),ve=a(ce),le=l(a(ve),2);de(le),t(ve),t(ce);var K=l(ce,2),Q=a(K),q=l(a(Q),2);pt(q),t(Q),t(K);var ue=l(K,2),Me=a(ue),Se=l(a(Me),2);pt(Se),t(Me),t(ue);var be=l(ue,2),pe=a(be),Ae=l(a(pe),2);pt(Ae),t(pe),t(be);var ke=l(be,2),Xe=l(a(ke),2),ie=a(Xe);ie.value=ie.__value="All";var xt=l(ie);$e(xt,1,()=>(i(),J(()=>i().filter(m=>m!=="All"))),He,(m,o)=>{var z=el(),we=a(z,!0);t(z);var Ce={};Y(()=>{oe(we,e(o)),Ce!==(Ce=e(o))&&(z.value=(z.__value=e(o))??"")}),k(m,z)}),t(Xe),t(ke);var et=l(ke,2),tt=a(et),_t=l(a(tt),2),yt=l(a(_t));t(_t),t(tt);var Ye=l(tt,2),it=a(Ye);de(it);var Ze=l(it,2);$e(Ze,4,()=>J(()=>Array.from({length:11},(m,o)=>o)),He,(m,o)=>{var z=tl();Y(()=>De(z,1,Rt(o===e(I)?"text-info font-bold":""))),k(m,z)}),t(Ze);var at=l(Ze,2);$e(at,4,()=>J(()=>Array.from({length:11},(m,o)=>o)),He,(m,o)=>{var z=al(),we=a(z,!0);t(z),Y(()=>{De(z,1,Rt(o===e(I)?"text-info font-bold":"")),oe(we,o)}),k(m,z)}),t(at),t(Ye),t(et);var dt=l(et,4),lt=a(dt);$e(lt,1,()=>e(S),He,(m,o,z)=>{var we=ll(),Ce=a(we),xe=a(Ce),Ue=l(a(xe),2);de(Ue),t(xe);var qe=l(xe,2),Fe=l(a(qe),2);de(Fe),t(qe);var st=l(qe,2);t(Ce);var Ne=l(Ce,2),Re=l(a(Ne),2);de(Re),t(Ne);var We=l(Ne,2),Pe=l(a(We),2);de(Pe),t(We);var _e=l(We,2),ut=l(a(_e),2);de(ut),t(_e);var At=l(_e,2),bt=l(a(At),2);pt(bt),t(At),t(we),ee(Ue,()=>e(o).Name,ye=>(e(o).Name=ye,je(()=>e(S)))),ee(Fe,()=>e(o).role,ye=>(e(o).role=ye,je(()=>e(S)))),d("click",st,()=>P(z)),ee(Re,()=>e(o).Image,ye=>(e(o).Image=ye,je(()=>e(S)))),ee(Pe,()=>e(o)._alternativeNamesString,ye=>(e(o)._alternativeNamesString=ye,je(()=>e(S)))),ee(ut,()=>e(o)._tagsString,ye=>(e(o)._tagsString=ye,je(()=>e(S)))),ee(bt,()=>e(o).description,ye=>(e(o).description=ye,je(()=>e(S)))),k(m,we)});var ct=l(lt,2);t(dt);var kt=l(dt,4),Ke=a(kt);$e(Ke,1,()=>e(x),He,(m,o,z)=>{var we=sl(),Ce=a(we),xe=a(Ce),Ue=l(a(xe),2);de(Ue),t(xe);var qe=l(xe,2);t(Ce);var Fe=l(Ce,2),st=l(a(Fe),2);pt(st),t(Fe);var Ne=l(Fe,2),Re=l(a(Ne),2);de(Re),t(Ne);var We=l(Ne,2),Pe=l(a(We),2);de(Pe),t(We),t(we),ee(Ue,()=>e(o).ChapterSE,_e=>(e(o).ChapterSE=_e,je(()=>e(x)))),d("click",qe,()=>f(z)),ee(st,()=>e(o).Description,_e=>(e(o).Description=_e,je(()=>e(x)))),ee(Re,()=>e(o)._tagsText,_e=>(e(o)._tagsText=_e,je(()=>e(x)))),ee(Pe,()=>e(o).Characters,_e=>(e(o).Characters=_e,je(()=>e(x)))),k(m,we)});var $t=l(Ke,2);t(kt),t(ae);var Ct=l(ae,2),vt=a(Ct),St=l(vt,2);t(Ct),t(H),t(F),Y(()=>{oe(R,v()!==null?"Edit Entry":"New Entry"),oe(yt,` ${e(I)??""} - ${te(Wt),e(I),J(()=>Wt[e(I)])??""}`),St.disabled=!e(p)||!e(C)}),d("click",re,O),ee(V,()=>e(p),m=>s(p,m)),ee(G,()=>e(b),m=>s(b,m)),ee(le,()=>e(j),m=>s(j,m)),ee(q,()=>e(D),m=>s(D,m)),ee(Se,()=>e(N),m=>s(N,m)),ee(Ae,()=>e(L),m=>s(L,m)),Kt(Xe,()=>e(C),m=>s(C,m)),ee(it,()=>e(I),m=>s(I,m)),d("click",ct,_),d("click",$t,y),d("click",vt,O),d("click",St,$),d("click",H,Ge(function(m){Qe.call(this,r,m)})),d("click",F,O),k(g,F),Be(),h()}var ol=M('<input class="input input-sm input-bordered flex-1 mr-2"/>'),il=M('<span class="truncate cursor-pointer"> </span>'),dl=M('<button class="btn btn-sm btn-success">Save</button>'),cl=M('<button class="btn btn-xs btn-info">Edit</button> <button class="btn btn-xs btn-error">Delete</button>',1),vl=M('<div class="flex gap-2"><!></div>'),ul=M('<li class="mb-2 flex items-center justify-between"><!> <!></li>'),bl=M(`<div class="fixed inset-0 z-150 flex bg-black/50" role="button" tabindex="0" aria-label="Close categories modal"><div class="h-full w-96 bg-base-100 p-6 shadow-xl flex flex-col" role="document"><h2 class="mb-6 text-2xl font-bold">Categories</h2> <div class="flex-1 overflow-y-auto pr-1 border border-base-content/30 rounded-xl p-1 px-2"><ul class="mb-4"></ul></div> <div class="flex gap-2 mt-3"><input class="input-bordered input flex-1" placeholder="New category"/> <button aria-label="Add new category" class="btn btn-primary">Add</button></div> <button class="btn btn-soft mt-2 w-full">Close</button> <div class="mt-1 px-1 text-xs justify-center text-success"><span> </span></div> <div class="my-2 alert alert-default alert-soft "><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>When a category is <b>deleted</b>, all entries in that category are <b>moved to the 'All'</b> category</span></div></div></div>`);function pl(g,r){Le(r,!1);const i=()=>Ee(Ve,"$categories",u),[u,h]=ot();let v=fe(r,"show",8,!1);const w=nt();let p=T(""),b=T(null),j=T("");function D(f){s(b,f),s(j,f)}async function N(f){const $=e(j).trim();if(!$||$==="All"||$===f){s(b,null);return}await Ve.rename(f,$),w("rename",{old:f,new:$}),s(b,null),S(`Category renamed to "${$}"`)}async function I(){const f=e(p).trim();!f||f==="All"||(await Ve.add(f),s(p,""))}let L=T(""),C=T(!1);function S(f,$=2e3){s(L,f),s(C,!0),setTimeout(()=>{s(C,!1)},$)}async function x(f){f!=="All"&&(await se.moveCategoryToAll(f),await Ve.remove(f),S(`Category "${f}" deleted. Entries moved to 'All'.`))}Bt(()=>{Ve.load()}),Ie();var _=ht(),P=ze(_);{var y=f=>{var $=bl(),O=a($),F=l(a(O),2),H=a(F);$e(H,5,()=>(i(),J(()=>["All",...i().filter(V=>V!=="All")])),He,(V,c)=>{var E=ul(),G=a(E);{var ce=Q=>{var q=ol();de(q),ca(q),ee(q,()=>e(j),ue=>s(j,ue)),d("keydown",q,ue=>ue.key==="Enter"&&N(e(c))),d("blur",q,()=>N(e(c))),k(Q,q)},ve=Q=>{var q=il(),ue=a(q,!0);t(q),Y(()=>oe(ue,e(c))),d("dblclick",q,()=>D(e(c))),k(Q,q)};U(G,Q=>{e(b)===e(c)?Q(ce):Q(ve,!1)})}var le=l(G,2);{var K=Q=>{var q=vl(),ue=a(q);{var Me=be=>{var pe=dl();d("click",pe,Ge(()=>N(e(c)))),k(be,pe)},Se=be=>{var pe=cl(),Ae=ze(pe),ke=l(Ae,2);d("click",Ae,Ge(()=>D(e(c)))),d("click",ke,Ge(()=>x(e(c)))),k(be,pe)};U(ue,be=>{e(b)===e(c)?be(Me):be(Se,!1)})}t(q),k(Q,q)};U(le,Q=>{e(c)!=="All"&&Q(K)})}t(E),k(V,E)}),t(H),t(F);var X=l(F,2),A=a(X);de(A);var R=l(A,2);t(X);var re=l(X,2),ae=l(re,2),Z=a(ae),ne=a(Z,!0);t(Z),t(ae),Te(2),t(O),t($),Y(()=>{ea(ae,`min-height: 1.55rem; max-height: 1.55rem; visibility: ${e(C)?"visible":"hidden"}`),oe(ne,e(L))}),ee(A,()=>e(p),V=>s(p,V)),d("click",R,I),d("click",re,()=>w("close")),d("click",O,Ge(function(V){Qe.call(this,r,V)})),d("click",$,()=>w("close")),d("keydown",$,V=>{(V.key==="Enter"||V.key===" ")&&w("close")}),k(f,$)};U(P,f=>{v()&&f(y)})}k(g,_),Be(),h()}var gl=M('<li><input type="radio" name="theme-dropdown" class="theme-controller btn btn-sm btn-block btn-ghost justify-start"/></li>'),fl=M('<div><div tabindex="0" role="button" class="btn p-2 m-0 rounded-2xl">üé® <svg width="12px" height="12px" class="inline-block h-1 w-1 fill-current opacity-60" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048"><path d="M1799 349l242 241-1017 1017L7 590l242-241 775 775 775-775z"></path></svg></div> <ul tabindex="-1" class="dropdown-content menu bg-base-300 rounded-2xl z-150 w-52 p-2 shadow-sm"></ul></div>');function ml(g,r){Le(r,!1);const i=()=>Ee(Pt,"$theme",u),[u,h]=ot(),v=["light","cupcake","night","dark","emerald","fantasy","luxury","acid","coffee","retro","business","dracula","dim","garden"];let w=fe(r,"dropdownDirection",8,"dropdown-end");function p(D){Pt.set(D)}Ie();var b=fl(),j=l(a(b),2);$e(j,5,()=>v,He,(D,N)=>{var I=gl(),L=a(I);de(L),t(I),Y(()=>{wt(L,"aria-label",e(N)),ma(L,e(N)),Qt(L,i()===e(N))}),d("change",L,()=>p(e(N))),k(D,I)}),t(j),t(b),Y(()=>De(b,1,`dropdown ${w()}`)),k(g,b),Be(),h()}var hl=M('<span class="absolute -top-6 -left-2 flex h-5 w-20 items-center justify-center rounded-full bg-red-600 text-xs font-bold text-white p-1"> </span>'),wl=M('<li><button class="w-full border border-base-300 text-left hover:bg-base-200"> </button></li>'),xl=M('<ul class="dropdown-content menu mt-3 w-52 rounded-box bg-base-100 p-2 shadow-md"></ul>'),_l=M('<div class="fixed top-16 left-1/2 z-50 flex items-center gap-4 rounded-lg border border-base-300 bg-base-100 p-2 shadow-md select-none"><div role="button" tabindex="0" class="cursor-grab rounded-md bg-base-200 p-2 hidden md:inline-block" aria-label="Drag toolbar">‚†ø</div> <div class="tooltip" data-tip="Delete"><button class="btn relative btn-square btn-error" aria-label="Delete selected"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 7h12M10 11v6m4-6v6M5 7l1 12a2 2 0 002 2h8a2 2 0 002-2l1-12M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3"></path></svg> <!></button></div> <div class="tooltip" data-tip="Select all"><button class="btn btn-square btn-ghost" aria-label="Select all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7M5 7l4 4L19 1"></path></svg></button></div> <div class="tooltip" data-tip="Deselect all"><button class="btn btn-square opacity-50 btn-ghost" aria-label="Deselect all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current opacity-20"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7M5 7l4 4L19 1"></path></svg></button></div> <div><div class="tooltip" data-tip="Move to category"><button class="btn btn-square btn-ghost" aria-label="Move to category"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4h16v4H4V4zm0 8h16v4H4v-4zm0 8h16v4H4v-4z"></path></svg></button></div> <!></div> <div class="tooltip" data-tip="Cancel"><button class="btn btn-square bg-red-700 text-white btn-ghost hover:bg-red-500" aria-label="Cancel selection"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div role="button" tabindex="0" class="drag-handle cursor-grab rounded-md bg-base-200 p-2" aria-label="Drag toolbar">‚†ø</div></div>');function yl(g,r){Le(r,!1);let i=fe(r,"selectedCount",8,0),u=fe(r,"categoryList",24,()=>[]),h=fe(r,"showCategoryDropdown",8,!1);const v=nt();let w=!1,p=0,b=0,j=T(0),D=T(0);function N(c){w=!0,p=c.clientX-e(j),b=c.clientY-e(D),window.addEventListener("pointermove",I),window.addEventListener("pointerup",L)}function I(c){w&&(s(j,c.clientX-p),s(D,c.clientY-b))}function L(){w=!1,window.removeEventListener("pointermove",I),window.removeEventListener("pointerup",L)}Ie();var C=_l(),S=a(C),x=l(S,2),_=a(x),P=l(a(_),2);{var y=c=>{var E=hl(),G=a(E,!0);t(E),Y(()=>oe(G,i())),k(c,E)};U(P,c=>{i()>0&&c(y)})}t(_),t(x);var f=l(x,2),$=a(f);t(f);var O=l(f,2),F=a(O);t(O);var H=l(O,2);let X;var A=a(H),R=a(A);t(A);var re=l(A,2);{var ae=c=>{var E=xl();$e(E,5,u,He,(G,ce)=>{var ve=wl(),le=a(ve),K=a(le,!0);t(le),t(ve),Y(()=>oe(K,e(ce))),d("click",le,()=>v("moveCategory",e(ce))),k(G,ve)}),t(E),k(c,E)};U(re,c=>{te(h()),te(u()),J(()=>h()&&u().length>0)&&c(ae)})}t(H);var Z=l(H,2),ne=a(Z);t(Z);var V=l(Z,2);t(C),Y(()=>{ea(C,`transform: translate(calc(-50% + ${e(j)??""}px), ${e(D)??""}px);`),_.disabled=i()===0,X=De(H,1,"dropdown dropdown-end",null,X,{"dropdown-open":h()}),R.disabled=i()===0}),d("pointerdown",S,N),d("click",_,()=>v("delete")),d("click",$,()=>v("selectAll")),d("click",F,()=>v("deselectAll")),d("click",R,()=>v("toggleCategoryDropdown")),d("click",ne,()=>v("cancel")),d("pointerdown",V,N),k(g,C),Be()}var kl=Xt('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4h16v16H4V4z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M8 12h8"></path></svg>'),Cl=Xt('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2"><rect x="4" y="4" width="16" height="16" stroke="currentColor" stroke-width="2"></rect><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h8"></path></svg>'),Sl=M('<button><div class="indicator"><span class="indicator-item bg-base-100 text-xs rounded-3xl px-1.5 py-0.5 -top-1"> </span> <div class="z-10"> </div></div></button>'),Al=M('<div class="flex h-screen flex-col"><div class="navbar bg-base-100 shadow-lg"><div class="flex-none"><button class="btn btn-square btn-ghost" aria-label="Open menu"><!></button></div> <div class="flex-1"><span class="text-md md:text-xl font-bold"> <span class="hide-on-320 svelte-j9gjs9"> </span></span></div> <div class="flex-none"><button class="btn btn-square btn-ghost" aria-label="Toggle search"><!></button> <div class="tooltip tooltip-bottom" data-tip="Open filters"><button class="btn btn-square btn-ghost" aria-label="Open filters"><!></button></div> <div class="tooltip tooltip-bottom" data-tip="Select entries"><button class="btn btn-square btn-ghost" aria-label="Select entries"><!></button></div> <button class="btn btn-square btn-ghost inline-block md:hidden" aria-label="Toggle grid columns" title="Toggle grid columns"><!></button> <!></div></div> <!> <div class="tabs tabs-border flex-nowrap gap-1 overflow-x-auto bg-base-200 px-2 pt-2 pb-1 scrollbar-hide"><button class="p-0 m-0" title="Toggle unique entries" aria-label="Show unique entries only"><!></button> <button><div class="z-10">All</div> <span class="bg-base-100 text-xs rounded-3xl px-1.5 py-0.5"> </span></button> <!></div> <button class="z-100 btn fixed right-6 bottom-6 btn-circle shadow-xl btn-lg btn-primary" aria-label="Add new entry"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg></button> <!>  <div class="flex-1 overflow-auto p-4"><!></div></div> <!> <!> <!> <!> <!> <!>',1);function Tl(g,r){Le(r,!1);const i=()=>Ee(ka,"$filteredEntries",p),u=()=>Ee(rt,"$selectedCategory",p),h=()=>Ee(Ve,"$categories",p),v=()=>Ee(Et,"$entries",p),w=()=>Ee(Gt,"$gridCols",p),[p,b]=ot(),j=T(),D=T();let N=T(!1),I=T(!1),L=T(!1),C=T(!1),S=T(!1),x=T(null),_=T(null),P=T(!1),y=T(new Set),f=T(!1);const $=nt();let O=T(!1),F=T(""),H=T(!1);function X(){Gt.update(n=>n===3?4:3)}async function A(){const n=await se.getAllEntries();Et.set(n),Array.from(new Set(n.map(B=>B.category).filter(B=>B&&B!=="All"))),Ve.load()}Bt(async()=>{await A(),Aa();const n=localStorage.getItem("selectedCategory");n&&rt.set(n)});function R(){s(x,null),s(S,!0),s(f,!1)}async function re(){s(S,!1),s(x,null),await A()}function ae(){s(S,!1),s(x,null)}async function Z(){s(C,!1),s(_,null),await A()}function ne(){s(C,!1),s(_,null)}let V;function c(n){s(F,n),s(H,!0),clearTimeout(V),V=window.setTimeout(()=>{s(H,!1)},1500)}async function E(n){await se.importFromJSON(n),await A(),s(L,!1)}async function G(){const n=await se.exportToJSON(),B=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),me=URL.createObjectURL(B),ge=document.createElement("a");ge.href=me,ge.download=`lib-export-${new Date().toISOString()}.json`,document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),URL.revokeObjectURL(me),s(L,!1),c("Exported to JSON üëç :Downloads/")}async function ce(){const n=await se.exportToMarkdown(),B=new Blob([n],{type:"text/markdown"}),me=URL.createObjectURL(B),ge=document.createElement("a");ge.href=me,ge.download=`lib-export-${new Date().toISOString()}.md`,document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),URL.revokeObjectURL(me),s(L,!1),c("Exported to Markdown üëç :Downloads/")}async function ve(n){await se.moveCategoryToAll(n),u()===n&&rt.set("All"),await A(),s(P,!1)}let le=T(!1);async function K(n){for(const me of e(y))v().find(Tt=>Tt.id===me)&&await se.updateEntry(me,{category:n});e(y).clear(),s(y,new Set(e(y))),s(f,!1);const B=await se.getAllEntries();Et.set(B),s(le,!1)}function Q(n){e(y).has(n)?e(y).delete(n):e(y).add(n),s(y,new Set(e(y)))}async function q(){if(e(y).size===0)return;const n=Array.from(e(y));for(const B of n)await se.deleteEntry(B);e(y).clear(),s(y,new Set(e(y))),await A(),s(f,!1)}function ue(){s(y,new Set(i().map(n=>n.id)))}function Me(){e(y).clear(),s(y,new Set(e(y)))}Mt(()=>(e(O),i(),Vt),()=>{s(j,e(O)?Array.from(new Map(i().map(n=>[Vt(n),n])).values()):i())}),Mt(()=>h(),()=>{s(D,h().filter(n=>n!=="All"))}),Zt(),Ie();var Se=Al(),be=ze(Se),pe=a(be),Ae=a(pe),ke=a(Ae),Xe=a(ke);he(Xe,()=>(te(W),J(()=>W.menu))),t(ke),t(Ae);var ie=l(Ae,2),xt=a(ie),et=a(xt);et.nodeValue="Lib ";var tt=l(et),_t=a(tt);t(tt),t(xt),t(ie);var yt=l(ie,2),Ye=a(yt),it=a(Ye);he(it,()=>(te(W),J(()=>W.search))),t(Ye);var Ze=l(Ye,2),at=a(Ze),dt=a(at);he(dt,()=>(te(W),J(()=>W.filter))),t(at),t(Ze);var lt=l(Ze,2),ct=a(lt),kt=a(ct);he(kt,()=>(te(W),J(()=>W.select))),t(ct),t(lt);var Ke=l(lt,2),$t=a(Ke);he($t,()=>(te(W),J(()=>W.toggleGrid))),t(Ke);var Ct=l(Ke,2);ml(Ct,{dropdownDirection:"dropdown-bottom dropdown-end"}),t(yt),t(pe);var vt=l(pe,2);{var St=n=>{Fa(n,{get show(){return e(N)},set show(B){s(N,B)},$$legacy:!0})};U(vt,n=>{e(N)&&n(St)})}var m=l(vt,2),o=a(m),z=a(o);{var we=n=>{var B=kl();k(n,B)},Ce=n=>{var B=Cl();k(n,B)};U(z,n=>{e(O)?n(we):n(Ce,!1)})}t(o);var xe=l(o,2);let Ue;var qe=l(a(xe),2),Fe=a(qe,!0);t(qe),t(xe);var st=l(xe,2);$e(st,1,()=>e(D),He,(n,B)=>{var me=Sl();let ge;var Tt=a(me),Dt=a(Tt),na=a(Dt,!0);t(Dt);var qt=l(Dt,2),oa=a(qt,!0);t(qt),t(Tt),t(me),Y(It=>{ge=De(me,1,"tab",null,ge,{"tab-active":u()===e(B)}),oe(na,It),oe(oa,e(B))},[()=>(v(),e(B),J(()=>v().filter(It=>It.category===e(B)).length))]),d("click",me,()=>rt.set(e(B))),k(n,me)}),t(m);var Ne=l(m,2),Re=l(Ne,2);{var We=n=>{yl(n,{get selectedCount(){return e(y),J(()=>e(y).size)},get categoryList(){return e(D)},get showCategoryDropdown(){return e(le)},$$events:{delete:q,selectAll:ue,deselectAll:Me,toggleCategoryDropdown:()=>s(le,!e(le)),moveCategory:B=>K(B.detail),cancel:()=>{s(f,!1),s(le,!1),e(y).clear(),s(y,new Set(e(y)))}}})};U(Re,n=>{e(f)&&n(We)})}var Pe=l(Re,2),_e=a(Pe);Ba(_e,{get entries(){return e(j)},get selectionMode(){return e(f)},get selectedEntries(){return e(y)},get gridCols(){return w()},$$events:{toggleSelect:n=>Q(n.detail)}}),t(Pe),t(be);var ut=l(be,2);{var At=n=>{Wa(n,{get show(){return e(I)},set show(B){s(I,B)},$$legacy:!0})};U(ut,n=>{e(I)&&n(At)})}var bt=l(ut,2);{var ye=n=>{Qa(n,{get show(){return e(L)},set show(B){s(L,B)},$$events:{import:B=>E(B.detail),export:G,exportMd:ce,showCategories:()=>{s(L,!1),s(P,!0)}},$$legacy:!0})};U(bt,n=>{e(L)&&n(ye)})}var Ht=l(bt,2);{var aa=n=>{pl(n,{get show(){return e(P)},$$events:{close:()=>s(P,!1),rename:B=>$("renameCategory",B.detail),delete:B=>ve(B.detail)}})};U(Ht,n=>{e(P)&&n(aa)})}var zt=l(Ht,2);{var la=n=>{ha(n,{get entryId(){return e(_)},$$events:{save:Z,cancel:ne}})};U(zt,n=>{e(C)&&n(la)})}var Ut=l(zt,2);{var sa=n=>{nl(n,{get entryId(){return e(x)},$$events:{save:re,cancel:ae}})};U(Ut,n=>{e(S)&&n(sa)})}var ra=l(Ut,2);Jt(ra,{get showAlert(){return e(H)},get message(){return e(F)}}),Y(()=>{oe(_t,`(${v(),J(()=>v().length)??""})`),Ue=De(xe,1,"tab relative",null,Ue,{"tab-active":u()==="All"}),oe(Fe,(v(),J(()=>v().length)))}),d("click",ke,()=>s(L,!0)),d("click",Ye,()=>{s(N,!e(N)),s(f,!1)}),d("click",at,()=>{s(I,!e(I)),s(f,!1)}),d("click",ct,()=>{e(f)&&(e(y).clear(),s(y,new Set(e(y))),s(le,!1)),s(f,!e(f))}),d("click",Ke,X),d("click",o,()=>s(O,!e(O))),d("click",xe,()=>rt.set("All")),d("click",Ne,R),k(g,Se),Be(),b()}function Jl(g){ua("1uha8ag",r=>{Yt(()=>{va.title="lib"})}),Tl(g,{})}export{Jl as component};
