import{c as yt,a as h,f as E,d as la}from"../chunks/DLeEY7fs.js";import{i as Ue}from"../chunks/D56Uv2cy.js";import{h as Xt,z as qe,A as Ye,D as Re,w as X,o as $,E as a,G as l,v as e,F as t,B as Q,aP as sa,aT as at,aU as Ft,W as s,V as A,aN as Rt,ax as je,aY as wt,aZ as $e,a_ as fa,O as ma,aW as ha}from"../chunks/BPO9GtFz.js";import{h as wa}from"../chunks/CuXflmye.js";import{d as xa,w as Ot,c as pt,g as _a,o as Ht}from"../chunks/Dpa3FFmK.js";import{s as ie,e as v,r as ya}from"../chunks/DfAXxMbk.js";import{p as ve,i as J,b as Wt,a as Ae,s as gt}from"../chunks/CrlJmSwP.js";import{t as ka,d as le,e as Ne,k as De,c as Ca,s as kt,j as pe,S as V,r as ce,l as ae,m as ra,a as Pe,b as lt,g as Sa,i as Je,n as Qt,R as Kt,o as Ge,f as Aa,h as Ea,p as ea,q as ta,E as Ta}from"../chunks/DSqSt04o.js";import{g as Ma,b as $a}from"../chunks/BpVkViDw.js";function na(w,i,f,m){var x=w.__style;if(Xt||x!==i){var p=ka(i);(!Xt||p!==w.getAttribute("style"))&&(p==null?w.removeAttribute("style"):w.style.cssText=p),w.__style=i}return m}function ja(){const{subscribe:w,set:i,update:f}=Ot([]);return{subscribe:w,set:i,update:f,load:async()=>{const m=await le.getAllEntries();return i(m),m},add:async m=>{const x=await le.addEntry(m);f(p=>[...p,{...m,id:x}])},updateEntry:async(m,x)=>{await le.updateEntry(m,x),f(p=>p.map(b=>b.id===m?{...b,...x}:b))},deleteEntry:async m=>{await le.deleteEntry(m),f(x=>x.filter(p=>p.id!==m))}}}const Lt=ja(),Se=Ot(""),ze=Ot("default"),bt=Bt("libsettings:selectedCategory","All"),xt=Bt("libsettings:sortField","createdAt"),_t=Bt("libsettings:sortOrder","desc"),aa=Bt("lib:gridCols",4),Na=xa([Lt,bt,Se,ze,xt,_t],([w,i,f,m,x,p])=>{let b=[...w];if(i!=="All"&&(b=b.filter(_=>_.category===i)),f){const _=f.toLowerCase();b=b.filter(d=>{switch(m){case"a":return d.alternativeTitles.join(" ").toLowerCase().includes(_);case"t":return d.tags.join(" ").toLowerCase().includes(_);case"b":return d.badges.join(" ").toLowerCase().includes(_);case"c":return d.characters.map(D=>D.Name).join(" ").toLowerCase().includes(_);case"d":return d.dataType.toLowerCase().includes(_);default:return d.title.toLowerCase().includes(_)||d.alternativeTitles.join(" ").toLowerCase().includes(_)}})}return b=b.sort((_,d)=>{const D=_[x]??"",I=d[x]??"";return p==="asc"?D>I?1:-1:D<I?1:-1}),b});function Bt(w,i){const f=localStorage.getItem(w),{subscribe:m,set:x,update:p}=Ot(f?JSON.parse(f):i);return{subscribe:m,set:b=>{localStorage.setItem(w,JSON.stringify(b)),x(b)},update:b=>{p(_=>{const d=b(_);return localStorage.setItem(w,JSON.stringify(d)),d})}}}let qt=null;async function Da(){if(localStorage.getItem("autoBackupEnabled")!=="true")return;const i=await(await le.getDB()).get("settings","backupDirHandle");i&&oa(i)}async function Ia(w){const i=await le.exportToJSON(),m=await(await w.getFileHandle("lib-autobackup.json",{create:!0})).createWritable();await m.write(JSON.stringify(i,null,2)),await m.close(),console.log("‚úÖ Auto backup saved at",new Date().toLocaleString())}function oa(w){qt&&clearTimeout(qt);const i=new Date,f=new Date;f.setHours(12,0,0,0);const m=new Date;m.setHours(24,0,0,0);let x;i<f?x=f:x=m;const p=x.getTime()-i.getTime();qt=window.setTimeout(async()=>{await w.queryPermission({mode:"readwrite"})==="granted"&&await Ia(w),oa(w)},p)}function La(w){const i=new IntersectionObserver(([f],m)=>{if(f.isIntersecting){const x=w.dataset.src;x&&(w.src=x),w.classList.add("lozad-loaded"),m.unobserve(w)}});return i.observe(w),{destroy(){i.unobserve(w)}}}var Oa=E('<div class="px-1 w-full opacity-80 text-sm h-65 md:h-55 flex items-end justify-center text-base-content/50 scroll-smooth"><div>No entries found. <ul class="list-disc list-inside mt-1"><li>Add new entries by clicking the <b>"+"</b> button.</li> <li>To Manage categories, click the "Categories" button in the <b>Menu</b>.</li> <li class="text-success mt-1">ID (auto-generated) and slug are <b>unique identifiers</b></li> <li class="text-success"><b>Import</b> uses fingerprint matching (slug prioritized)</li></ul></div></div>'),Ba=E('<button type="button"><!></button>'),za=E('<img class="w-full h-full object-cover lozad"/>'),Ja=E('<div class="w-full h-full flex items-center justify-center text-base-content/20"><!></div>'),Ua=E('<span class="absolute bottom-0 left-0 rounded-se-md text-[.7em] md:text-sm bg-base-200/85 px-1 py-0"> </span>'),qa=E('<span class="absolute top-0.5 left-0.5 rounded-2xl text-xs md:text-sm bg-info text-base-300 px-1 py-0 font-semibold"> </span>'),Ra=E('<div class="relative"><!> <button class="card bg-base-100 shadow-xl cursor-pointer hover:shadow-2xl transition-shadow w-full h-full"><figure class="relative aspect-[3/4] bg-base-300"><!> <!></figure> <div class="card-body p-2"><!> <h3 class="card-title text-xs sm:text-sm line-clamp-2"> </h3></div></button></div>'),Wa=E("<div></div>");function Fa(w,i){qe(i,!1);let f=ve(i,"entries",24,()=>[]),m=ve(i,"selectionMode",8,!1),x=ve(i,"selectedEntries",24,()=>new Set),p=ve(i,"gridCols",8,4);const b=pt();function _(y){!m()&&y!==void 0&&Ma(`${$a}/detail/${y}`)}function d(y){b("toggleSelect",y)}const D={2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5"};Ue();var I=yt(),U=Ye(I);{var j=y=>{var O=Oa();h(y,O)},N=y=>{var O=Wa();Ne(O,5,f,C=>C.id,(C,g)=>{var L=Ra(),B=a(L);{var n=u=>{var S=Ba();let F;var ke=a(S);{var ue=se=>{var Y=yt(),Z=Ye(Y);pe(Z,()=>(X(V),$(()=>V.selectTick))),h(se,Y)},oe=sa(()=>(X(x()),e(g),$(()=>x().has(e(g).id))));J(ke,se=>{e(oe)&&se(ue)})}t(S),Q(se=>F=De(S,1,"rounded-xl absolute inset-0 z-10 flex items-center justify-center bg-black/20 cursor-pointer transition-opacity",null,F,se),[()=>({selected:x().has(e(g).id)})]),v("click",S,se=>{se.stopPropagation(),d(e(g).id)}),h(u,S)};J(B,u=>{m()&&u(n)})}var k=l(B,2),R=a(k),H=a(R);{var G=u=>{var S=za();Ca(S,F=>La?.(F)),Q(()=>{kt(S,"src",(e(g),$(()=>e(g).coverImageUrl))),kt(S,"alt",(e(g),$(()=>e(g).title)))}),ya(S),h(u,S)},W=u=>{var S=Ja(),F=a(S);pe(F,()=>(X(V),$(()=>V.imgIcon))),t(S),h(u,S)};J(H,u=>{e(g),$(()=>e(g).coverImageUrl)?u(G):u(W,!1)})}var T=l(H,2);{var z=u=>{var S=Ua(),F=a(S,!0);t(S),Q(()=>ie(F,(e(g),$(()=>e(g).dataType)))),h(u,S)};J(T,u=>{e(g),$(()=>e(g).dataType)&&u(z)})}t(R);var K=l(R,2),ee=a(K);{var re=u=>{var S=qa(),F=a(S,!0);t(S),Q(()=>ie(F,(e(g),$(()=>e(g).rating)))),h(u,S)};J(ee,u=>{e(g),$(()=>e(g).rating!==null&&e(g).rating>0)&&u(re)})}var ne=l(ee,2),P=a(ne,!0);t(ne),t(K),t(k),t(L),Q(()=>ie(P,(e(g),$(()=>e(g).title)))),v("click",k,()=>_(e(g).id)),h(C,L)}),t(O),Q(()=>De(O,1,(X(p()),$(()=>`grid gap-2 ${D[p()]} md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 scroll-smooth`)))),h(y,O)};J(U,y=>{X(f()),$(()=>f().length===0)?y(j):y(N,!1)})}h(w,I),Re()}var Ha=E("alternative titles <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Va=E("tags <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Ga=E("badges <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Pa=E("characters <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Ya=E('<div class="text-xs text-info mt-2">Searching in: <!> <!> <!> <!></div>'),Za=E(`<div class="bg-base-200 px-4 pt-3 pb-1 shadow-lg"><div class="flex gap-2 items-center"><input type="text" placeholder="Search ('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)" class="input input-bordered flex-1"/> <button class="btn btn-square btn-ghost" aria-label="Close search"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <!></div>`);function Xa(w,i){qe(i,!1);const f=()=>Ae(ze,"$searchMode",m),[m,x]=gt();let p=ve(i,"show",12,!1),b=A(""),_=A();async function d(){await Rt(),e(_)?.focus()}function D(){s(b,""),Se.set(""),ze.set("default"),p(!1)}at(()=>Se,()=>{_a(Se)&&p(!0)}),at(()=>X(p()),()=>{p()&&d()}),at(()=>(e(b),Se),()=>{const C=e(b).trim(),g=C.toLowerCase();g.startsWith("a:")?(ze.set("a"),Se.set(C.slice(2))):g.startsWith("t:")?(ze.set("t"),Se.set(C.slice(2))):g.startsWith("b:")?(ze.set("b"),Se.set(C.slice(2))):g.startsWith("c:")?(ze.set("c"),Se.set(C.slice(2))):g.startsWith("d:")?(ze.set("d"),Se.set(C.slice(2))):(ze.set("default"),Se.set(C))}),Ft(),Ue();var I=Za(),U=a(I),j=a(U);ce(j),Wt(j,C=>s(_,C),()=>e(_));var N=l(j,2);t(U);var y=l(U,2);{var O=C=>{var g=Ya(),L=l(a(g));{var B=T=>{var z=Ha();je(2),h(T,z)};J(L,T=>{f()==="a"&&T(B)})}var n=l(L,2);{var k=T=>{var z=Va();je(2),h(T,z)};J(n,T=>{f()==="t"&&T(k)})}var R=l(n,2);{var H=T=>{var z=Ga();je(2),h(T,z)};J(R,T=>{f()==="b"&&T(H)})}var G=l(R,2);{var W=T=>{var z=Pa();je(2),h(T,z)};J(G,T=>{f()==="c"&&T(W)})}t(g),h(C,g)};J(y,C=>{f()!=="default"&&C(O)})}t(I),ae(j,()=>e(b),C=>s(b,C)),v("click",N,D),h(w,I),Re(),x()}var Qa=E('<div class="fixed inset-0 bg-black/50 z-150 flex items-end" role="presentation"><div class="bg-base-100 w-full rounded-t-2xl p-6 max-h-[80vh] overflow-auto" role="dialog" tabindex="-1"><h3 class="text-2xl font-bold mb-6">Sort & Filter</h3> <div class="form-control mb-4"><label class="label" for="sort-field"><span class="label-text font-semibold">Sort By</span></label> <select id="sort-field" class="select select-bordered w-full"><option>Title (A-Z)</option><option>Rating</option><option>Last Edited</option><option>Date Created</option><option>Last Opened</option></select></div> <div class="form-control mb-6"><label class="label" for="sort-order"><span class="label-text font-semibold">Order</span></label> <div class="flex gap-2"><button>Ascending</button> <button>Descending</button></div></div> <div class="flex gap-2"><button class="btn btn-outline flex-1">Reset</button> <button class="btn btn-primary flex-1">Apply</button></div></div></div>');function Ka(w,i){qe(i,!1);const f=()=>Ae(xt,"$sortField",x),m=()=>Ae(_t,"$sortOrder",x),[x,p]=gt();let b=ve(i,"show",12,!1),_=A(f()),d=A(m());xt.subscribe(y=>s(_,y)),_t.subscribe(y=>s(d,y));function D(){xt.set(e(_)),_t.set(e(d)),b(!1)}function I(){s(_,"title"),s(d,"asc"),xt.set(e(_)),_t.set(e(d)),b(!1)}Ue();var U=yt(),j=Ye(U);{var N=y=>{var O=Qa(),C=a(O),g=l(a(C),2),L=l(a(g),2),B=a(L);B.value=B.__value="title";var n=l(B);n.value=n.__value="rating";var k=l(n);k.value=k.__value="editedAt";var R=l(k);R.value=R.__value="createdAt";var H=l(R);H.value=H.__value="openedAt",t(L),t(g);var G=l(g,2),W=l(a(G),2),T=a(W);let z;var K=l(T,2);let ee;t(W),t(G);var re=l(G,2),ne=a(re),P=l(ne,2);t(re),t(C),t(O),Q(()=>{z=De(T,1,"btn flex-1",null,z,{"btn-primary":e(d)==="asc"}),kt(T,"aria-pressed",e(d)==="asc"),ee=De(K,1,"btn flex-1",null,ee,{"btn-primary":e(d)==="desc"}),kt(K,"aria-pressed",e(d)==="desc")}),ra(L,()=>e(_),u=>s(_,u)),v("click",T,()=>s(d,"asc")),v("click",K,()=>s(d,"desc")),v("click",ne,I),v("click",P,D),v("click",C,Pe(function(u){lt.call(this,i,u)})),v("keydown",C,function(u){lt.call(this,i,u)}),v("click",O,()=>b(!1)),v("keydown",O,function(u){lt.call(this,i,u)}),h(y,O)};J(j,y=>{b()&&y(N)})}h(w,U),Re(),p()}const el=`\`\`\`json\r
// Example\r
[\r
  {\r
    "id": 2,\r
    "title": "Solo Leveling",\r
    "slug": "solo-leveling",\r
    "alternativeTitles": [ "Only I Level Up", "Na Honja Level Up" ],\r
    "coverImageUrl": "https://example.com/covers/solo-leveling.jpg",\r
    "description": "In a world where gates connect Earth to deadly dungeons, the weakest hunter awakens a mysterious system that allows him to level up alone.",\r
    "badges": ["Manhwa", "Action", "Fantasy", "Completed"],\r
    "tags": [ "gates", "hunters", "dungeons", "system", "shadows", "awakening"],\r
    "rating": null,\r
    "createdAt": "2024-12-15T08:20:00.000Z",\r
    "openedAt": "2025-02-07T14:10:30.000Z",\r
    "editedAt": "2025-02-07T18:45:10.000Z",\r
    "characters": [\r
      {\r
        "Name": "Sung Jin-Woo",\r
        "Image": "https://example.com/characters/sung-jin-woo.png",\r
        "role": "Main",\r
        "alternativeNames": [ "Jinwoo"],\r
        "tags": ["MC", "Solo-Player"],\r
        "description": ""\r
      },\r
      {\r
        "Name": "Cha Hae-In",\r
        "role": "Main",\r
        "Image": "https://example.com/characters/cha-hae-in.png"\r
      },\r
      {\r
        "Name": "Go Gun-Hee",\r
        "role": "supporting",\r
        "Image": "https://example.com/characters/go-gun-hee.png"\r
      }\r
    ],\r
    "rows": [\r
      {\r
        "ChapterSE": "Episode 1 ‚Äì The Weakest Hunter",\r
        "Description": "E-rank hunter Sung Jin-Woo barely survives a low-level dungeon while struggling to pay his family‚Äôs medical bills.",\r
        "Tags": ["introduction", "low-rank", "desperation"],\r
        "Characters": "Sung Jin-Woo"\r
      },\r
      {\r
        "ChapterSE": "Episode 2 ‚Äì Double Dungeon",\r
        "Description": "A hidden dungeon reveals a deadly trial where survival depends on following cryptic rules.",\r
        "Tags": ["double-dungeon", "statues", "death"],\r
        "Characters": "Sung Jin-Woo, Dungeon Party"\r
      },\r
      {\r
        "ChapterSE": "Episode 3 ‚Äì The System",\r
        "Description": "After facing death, Jin-Woo awakens to a mysterious system that only he can see.",\r
        "Tags": ["awakening", "system", "rebirth"],\r
        "Characters": "Sung Jin-Woo"\r
      }\r
    ],\r
    "category": "Manhwa",\r
    "dataType": "json"\r
  },\r
  // ...\r
]\r
\`\`\``;var tl=E('<div role="alert" class="fixed bottom-2 left-2 z-300 alert alert-info alert-outline bg-base-100"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>');function ia(w,i){let f=ve(i,"showAlert",8,!1),m=ve(i,"message",8,"");var x=yt(),p=Ye(x);{var b=_=>{var d=tl(),D=l(a(d),2),I=a(D,!0);t(D),t(d),Q(()=>ie(I,m())),h(_,d)};J(p,_=>{f()&&_(b)})}h(w,x)}var al=E('<div class="text-left p-4 gap-1"><span class="loading loading-bars loading-sm text-primary"></span>Importing<span class="loading loading-bars loading-sm text-primary"></span></div>'),ll=E('<div class="fixed inset-0 bg-black/50 z-150 flex" role="presentation"><div class="bg-base-100 w-80 h-full shadow-xl p-6 flex flex-col justify-between" role="dialog" tabindex="-1"><div><h2 class="text-2xl font-bold mb-6">Menu <button class="float-right cursor-pointer" aria-label="Close menu" type="button"><!></button></h2> <ul class="menu bg-base-200 rounded-box gap-1 md:gap-3"><li><button aria-label="Import JSON" class="btn btn-md btn-ghost"><!> Import JSON</button></li> <li><button aria-label="Export data" class="btn btn-md btn-ghost"><!> Export JSON</button></li> <li><button class="btn btn-md btn-ghost" aria-label="Export Markdown"><!> Export Md</button></li> <li><button aria-label="Open categories" class="btn btn-md btn-ghost"><!> Categories</button></li> <li><button class="btn btn-md btn-ghost">JSON Format</button></li></ul> <!></div> <dialog class="modal"><div class="modal-box max-w-3xl w-85 md:w-full h-auto max-h-[65vh]"><form method="dialog"><button type="button" aria-label="CloseJSONmodal" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 text-lg p-5"><!></button></form> <h3 class="font-bold mb-2">Import JSON Structure</h3> <div class="prose max-w-full overflow-auto text-sm"><!></div></div></dialog> <div class="text-sm text-gray-500 disable"><div class="divider"></div> <p class="font-semibold my-4">ü§ñ AI √ó <a href="https://github.com/avinash-027/" target="_blank" class="link link-primary no-underline">User-A027</a> üë®‚Äçüíª</p></div></div></div>'),sl=E('<!> <!> <input type="file" accept=".json" class="hidden"/>',1);function rl(w,i){qe(i,!1);let f=ve(i,"show",12,!1),m=A(""),x=A(!1);const p=pt();let b=A(),_=ve(i,"importing",8,!1);function d(){e(b).click()}function D(n){const R=n.target.files?.[0];if(!R)return;const H=new FileReader;H.onload=G=>{try{const W=JSON.parse(G.target?.result),T=Array.isArray(W)?W:[W];p("import",T)}catch{s(m,"Invalid JSON file"),s(x,!0),setTimeout(()=>{s(x,!1)},2e3)}},H.readAsText(R)}function I(){p("export")}let U=Sa.parse(el),j=A();function N(){e(j).showModal()}function y(){e(j).close()}Ue();var O=sl(),C=Ye(O);ia(C,{get showAlert(){return e(x)},get message(){return e(m)}});var g=l(C,2);{var L=n=>{var k=ll(),R=a(k),H=a(R),G=a(H),W=l(a(G)),T=a(W);pe(T,()=>(X(V),$(()=>V.circleClose))),t(W),t(G);var z=l(G,2),K=a(z),ee=a(K),re=a(ee);pe(re,()=>(X(V),$(()=>V.import))),je(),t(ee),t(K);var ne=l(K,2),P=a(ne),u=a(P);pe(u,()=>(X(V),$(()=>V.export))),je(),t(P),t(ne);var S=l(ne,2),F=a(S),ke=a(F);pe(ke,()=>(X(V),$(()=>V.export))),je(),t(F),t(S);var ue=l(S,2),oe=a(ue),se=a(oe);pe(se,()=>(X(V),$(()=>V.category))),je(),t(oe),t(ue);var Y=l(ue,2),Z=a(Y);t(Y),t(z);var ge=l(z,2);{var Ee=te=>{var st=al();h(te,st)};J(ge,te=>{_()&&te(Ee)})}t(H);var Ce=l(H,2),fe=a(Ce),me=a(fe),xe=a(me),Te=a(xe);pe(Te,()=>(X(V),$(()=>V.circleClose))),t(xe),t(me);var Ie=l(me,4),Le=a(Ie);pe(Le,()=>U),t(Ie),t(fe),t(Ce),Wt(Ce,te=>s(j,te),()=>e(j)),je(2),t(R),t(k),v("click",W,()=>f(!1)),v("click",ee,d),v("click",P,I),v("click",F,()=>p("exportMd")),v("click",oe,()=>p("showCategories")),v("click",Z,N),v("click",xe,y),v("click",Ce,te=>{te.target===e(j)&&y()}),v("click",R,Pe(function(te){lt.call(this,i,te)})),v("keydown",R,Pe(function(te){lt.call(this,i,te)})),v("click",k,()=>f(!1)),v("keydown",k,te=>te.key==="Escape"&&f(!1)),h(n,k)};J(g,n=>{f()&&n(L)})}var B=l(g,2);Wt(B,n=>s(b,n),()=>e(b)),v("change",B,D),h(w,O),Re()}var nl=E('<p class="text-error text-sm mt-1"> </p>'),ol=E('<option class="border border-base-200"> </option>'),il=E("<span>|</span>"),dl=E("<span> </span>"),cl=E('<div class="flex gap-2 flex-wrap mb-2 p-2 rounded-lg bg-base-200 border border-base-300"><div class="flex gap-2 w-full"><label class="floating-label w-full" for="charName"><span><span class="label-text">Name **</span></span> <input type="text" id="charName" placeholder="Name *" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charRole"><span><span class="label-text">Role</span></span> <input type="text" id="charRole" placeholder="role" class="input input-sm w-full"/></label> <button class="btn btn-sm btn-square btn-error btn-outline">‚úï</button></div> <label class="floating-label w-full" for="charImgUrl"><span><span class="label-text">Image URL</span></span> <input type="text" id="charImgUrl" placeholder="Img URL" class="input input-sm w-full"/></label> <details class="w-full mt-2"><summary class="cursor-pointer text-sm font-medium text-primary text-center">Extra Details</summary> <div class="space-y-2 mt-2"><label class="floating-label w-full" for="charAltNames"><span><span class="label-text">alternativeNames</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="charAltNames" placeholder="Alternative Names [Ex: Name01, name-01]" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charTags"><span><span class="label-text">char-Tags</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="charTags" placeholder="Tags [Ex: Hero, Villain]" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charDescription"><span><span class="label-text">Description</span></span> <textarea id="charDescription" placeholder="Description" class="textarea textarea-bordered w-full"></textarea></label></div></details></div>'),vl=E('<div class="card bg-base-200 border border-base-300 p-4"><div class="flex gap-2 mb-2"><label class="floating-label w-full"><span>Chapter *</span> <input type="text" placeholder="Chapter (e.g., 1-5)" class="input input-bordered w-full input-sm flex-1"/></label> <button class="btn btn-square btn-error btn-outline btn-sm"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-4 h-4 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <label class="floating-label w-full"><span>Description</span> <textarea placeholder="Description" class="textarea textarea-bordered w-full textarea-sm mb-2"></textarea></label> <label class="floating-label w-full"><span>Tags (comma separated)</span> <input type="text" placeholder="Tags (comma separated)" class="input input-bordered w-full input-sm mb-2"/></label> <label class="floating-label w-full"><span>Characters</span> <input type="text" placeholder="Characters" class="input input-bordered w-full input-sm"/></label></div>'),ul=E('<div class="fixed inset-0 bg-black/50 z-150 flex items-center justify-center p-4"><div class="bg-base-100 w-full max-w-4xl max-h-[90vh] overflow-auto rounded-lg shadow-xl"><div class="bg-base-100 border-b border-base-300 p-4 flex justify-between items-center"><h2 class="text-2xl font-bold"> </h2> <button class="btn btn-square btn-ghost btn-sm"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-6 space-y-4"><div class="form-control"><label for="newtitle" class="floating-label"><span>Title <span class="label-text-alt text-info italic">: required</span></span> <input id="newtitle" type="text" placeholder="Title" class="input input-bordered w-full" required=""/></label> <!></div> <div class="form-control"><label for="newAltTitles" class="floating-label"><span><span class="label-text">Alternative Titles</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="newAltTitles" type="text" placeholder="Alternative Titles [Ex: Title1, Title2]" class="input input-bordered w-full"/></label></div> <div class="form-control"><label for="newCoverImg" class="floating-label"><span class="label-text">Cover Image URL</span> <input id="newCoverImg" type="text" placeholder="Cover Image URL: Web Img Link" class="input input-bordered w-full"/></label></div> <div class="form-control"><label class="floating-label"><span class="label-text">Description</span> <textarea placeholder="Description" class="textarea textarea-bordered w-full h-24"></textarea></label></div> <div class="form-control"><label for="newBadges" class="floating-label"><span><span class="label-text">Badges</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <textarea id="newBadges" placeholder="Badges [Ex: Completed, Ongoing, Author, Artist, Favorite]" class="textarea textarea-bordered w-full"></textarea></label></div> <div class="form-control"><label for="newTags" class="floating-label"><span><span class="label-text">Tags</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <textarea id="newTags" placeholder="Tags [Ex: Themes, Genres]" class="textarea textarea-bordered w-full"></textarea></label></div> <div class="form-control"><label class="floating-label"><span class="label-text font-semibold">Category</span></label> <select class="select select-bordered w-full"><option class="border border-base-content/20 hover:bg-base-200">All</option><!></select></div> <div class="form-control"><label class="flex flex-wrap gap-2 justify-between"><span><span class="label-text font-semibold">Rating <span class="text-info">(0‚Äì10)</span></span></span> <div class="text-xs md:text-sm text-info"><span class="font-semibold">Value:</span> </div></label> <div class="w-full max-w-xs"><input type="range" min="0" max="10" step="1" class="range range-xs range-info"/> <div class="flex justify-between px-2.5 mt-1 text-xs"></div> <div class="flex justify-between px-2.5 mt-1 text-xs"></div></div></div> <div class="divider">Characters</div> <div class="space-y-2"><!> <button class="btn btn-outline btn-sm">+ Add Character</button></div> <div class="divider">Chapters</div> <div class="space-y-2"><!> <button class="btn btn-outline btn-sm">+ Add Chapter</button></div></div> <div class="sticky bottom-0 bg-base-100 border-t border-base-300 p-4 flex gap-2 justify-end"><button class="btn btn-outline">Cancel</button> <button class="btn btn-primary">Save</button></div></div></div>');function bl(w,i){qe(i,!1);const f=()=>Ae(Ge,"$categories",m),[m,x]=gt(),p=A();let b=ve(i,"entryId",8,null);const _=pt();let d=A(""),D=A(""),I=A(""),U=A(""),j=A(""),N=A(0),y=A(""),O=A("All"),C=A(!1),g=A(""),L=A([]),B=A([]);Ht(async()=>{if(b()!==null){const c=await le.getEntryById(b());c&&(s(d,c.title),s(D,c.alternativeTitles.join(", ")),s(I,c.coverImageUrl||""),s(U,c.description),s(j,c.badges.join(", ")),s(N,Number(c.rating)),s(y,c.tags.join(", ")),s(O,c.category),s(L,c.characters.map(o=>({...o,_alternativeNamesString:(o.alternativeNames??[]).join(", "),_tagsString:(o.tags??[]).join(", ")}))),s(B,c.rows.map(o=>({...structuredClone(o),_tagsText:o.tags.join(", ")}))))}});function n(){s(L,[...e(L),{name:"",image:"",role:"",alternativeNames:[],tags:[],description:"",_alternativeNamesString:"",_tagsString:""}])}function k(c){s(L,e(L).filter((o,q)=>q!==c))}function R(){s(B,[...e(B),{chapterSE:"",description:"",characters:"",tags:[],_tagsText:""}])}function H(c){s(B,e(B).filter((o,q)=>q!==c))}async function G(){const c={title:e(d),slug:e(d).toLowerCase().trim().replace(/[\s]+/g,"-").replace(/[^a-z0-9\-]/g,""),alternativeTitles:e(D).split(",").map(o=>o.trim()).filter(Boolean),coverImageUrl:e(I)||null,description:e(U),badges:e(j).split(",").map(o=>o.trim()).filter(Boolean),rating:Number(e(N)),createdAt:null,openedAt:null,editedAt:null,tags:e(y).split(",").map(o=>o.trim()).filter(Boolean),category:e(O)||"All",dataType:"Lib",characters:e(L).filter(o=>o.name).map(o=>({name:o.name,image:o.image,role:o.role,description:o.description,alternativeNames:(o._alternativeNamesString??"").split(",").map(q=>q.trim()).filter(Boolean),tags:(o._tagsString??"").split(",").map(q=>q.trim()).filter(Boolean)})),rows:e(B).filter(o=>o.chapterSE).map(o=>({chapterSE:o.chapterSE,description:o.description,characters:o.characters,tags:o._tagsText.split(",").map(q=>q.trim()).filter(Boolean)}))};b()!==null?await le.updateEntry(b(),c):await le.addEntry(c),_("save")}function W(){_("cancel")}at(()=>e(d),()=>{s(p,e(d).toLowerCase().trim().replace(/[\s]+/g,"-").replace(/[^a-z0-9\-]/g,""))}),at(()=>(e(d),X(b()),e(p),e(C),Rt),()=>{e(d)?(async()=>{if(b()!==null){const c=await le.getEntryBySlug(e(p));s(C,!!c&&c.id!==b())}else s(C,!!await le.getEntryBySlug(e(p)));s(g,e(C)?`This title generates a slug(${e(p)}) that already Exists. Change title text`:""),await Rt()})():(s(C,!1),s(g,""))}),Ft(),Ue();var T=ul(),z=a(T),K=a(z),ee=a(K),re=a(ee,!0);t(ee);var ne=l(ee,2);t(K);var P=l(K,2),u=a(P),S=a(u),F=l(a(S),2);ce(F),t(S);var ke=l(S,2);{var ue=c=>{var o=nl(),q=a(o,!0);t(o),Q(()=>ie(q,e(g))),h(c,o)};J(ke,c=>{e(C)&&c(ue)})}t(u);var oe=l(u,2),se=a(oe),Y=l(a(se),2);ce(Y),t(se),t(oe);var Z=l(oe,2),ge=a(Z),Ee=l(a(ge),2);ce(Ee),t(ge),t(Z);var Ce=l(Z,2),fe=a(Ce),me=l(a(fe),2);wt(me),t(fe),t(Ce);var xe=l(Ce,2),Te=a(xe),Ie=l(a(Te),2);wt(Ie),t(Te),t(xe);var Le=l(xe,2),te=a(Le),st=l(a(te),2);wt(st),t(te),t(Le);var Ze=l(Le,2),rt=l(a(Ze),2),nt=a(rt);nt.value=nt.__value="All";var Ct=l(nt);Ne(Ct,1,()=>(f(),$(()=>f().filter(c=>c!=="All"))),Je,(c,o)=>{var q=ol(),_e=a(q,!0);t(q);var de={};Q(()=>{ie(_e,e(o)),de!==(de=e(o))&&(q.value=(q.__value=e(o))??"")}),h(c,q)}),t(rt),t(Ze);var ft=l(Ze,2),ot=a(ft),Xe=l(a(ot),2),zt=l(a(Xe));t(Xe),t(ot);var it=l(ot,2),Qe=a(it);ce(Qe);var mt=l(Qe,2);Ne(mt,4,()=>$(()=>Array.from({length:11},(c,o)=>o)),Je,(c,o)=>{var q=il();Q(()=>De(q,1,Qt(o===e(N)?"text-info font-bold":""))),h(c,q)}),t(mt);var dt=l(mt,2);Ne(dt,4,()=>$(()=>Array.from({length:11},(c,o)=>o)),Je,(c,o)=>{var q=dl(),_e=a(q,!0);t(q),Q(()=>{De(q,1,Qt(o===e(N)?"text-info font-bold":"")),ie(_e,o)}),h(c,q)}),t(dt),t(it),t(ft);var Ke=l(ft,4),St=a(Ke);Ne(St,1,()=>e(L),Je,(c,o,q)=>{var _e=cl(),de=a(_e),Me=a(de),We=l(a(Me),2);ce(We),t(Me);var et=l(Me,2),Fe=l(a(et),2);ce(Fe),t(et);var Oe=l(et,2);t(de);var Be=l(de,2),He=l(a(Be),2);ce(He),t(Be);var tt=l(Be,2),Ve=l(a(tt),2),he=a(Ve),jt=l(a(he),2);ce(jt),t(he);var ut=l(he,2),Nt=l(a(ut),2);ce(Nt),t(ut);var Dt=l(ut,2),ht=l(a(Dt),2);wt(ht),t(Dt),t(Ve),t(tt),t(_e),ae(We,()=>e(o).name,ye=>(e(o).name=ye,$e(()=>e(L)))),ae(Fe,()=>e(o).role,ye=>(e(o).role=ye,$e(()=>e(L)))),v("click",Oe,()=>k(q)),ae(He,()=>e(o).image,ye=>(e(o).image=ye,$e(()=>e(L)))),ae(jt,()=>e(o)._alternativeNamesString,ye=>(e(o)._alternativeNamesString=ye,$e(()=>e(L)))),ae(Nt,()=>e(o)._tagsString,ye=>(e(o)._tagsString=ye,$e(()=>e(L)))),ae(ht,()=>e(o).description,ye=>(e(o).description=ye,$e(()=>e(L)))),h(c,_e)});var ct=l(St,2);t(Ke);var At=l(Ke,4),Et=a(At);Ne(Et,1,()=>e(B),Je,(c,o,q)=>{var _e=vl(),de=a(_e),Me=a(de),We=l(a(Me),2);ce(We),t(Me);var et=l(Me,2);t(de);var Fe=l(de,2),Oe=l(a(Fe),2);wt(Oe),t(Fe);var Be=l(Fe,2),He=l(a(Be),2);ce(He),t(Be);var tt=l(Be,2),Ve=l(a(tt),2);ce(Ve),t(tt),t(_e),ae(We,()=>e(o).chapterSE,he=>(e(o).chapterSE=he,$e(()=>e(B)))),v("click",et,()=>H(q)),ae(Oe,()=>e(o).description,he=>(e(o).description=he,$e(()=>e(B)))),ae(He,()=>e(o)._tagsText,he=>(e(o)._tagsText=he,$e(()=>e(B)))),ae(Ve,()=>e(o).characters,he=>(e(o).characters=he,$e(()=>e(B)))),h(c,_e)});var Tt=l(Et,2);t(At),t(P);var Mt=l(P,2),$t=a(Mt),vt=l($t,2);t(Mt),t(z),t(T),Q(()=>{ie(re,b()!==null?"Edit Entry":"New Entry"),ie(zt,` ${e(N)??""} - ${X(Kt),e(N),$(()=>Kt[e(N)])??""}`),vt.disabled=!e(d)||!e(O)||e(C)}),v("click",ne,W),ae(F,()=>e(d),c=>s(d,c)),ae(Y,()=>e(D),c=>s(D,c)),ae(Ee,()=>e(I),c=>s(I,c)),ae(me,()=>e(U),c=>s(U,c)),ae(Ie,()=>e(j),c=>s(j,c)),ae(st,()=>e(y),c=>s(y,c)),ra(rt,()=>e(O),c=>s(O,c)),ae(Qe,()=>e(N),c=>s(N,c)),v("click",ct,n),v("click",Tt,R),v("click",$t,W),v("click",vt,G),v("click",z,Pe(function(c){lt.call(this,i,c)})),v("click",T,W),h(w,T),Re(),x()}var pl=E('<input class="input input-sm input-bordered flex-1 mr-2"/>'),gl=E('<span class="truncate cursor-pointer"> </span>'),fl=E('<button class="btn btn-sm btn-success">Save</button>'),ml=E('<button class="btn btn-xs btn-info">Edit</button> <button class="btn btn-xs btn-error">Delete</button>',1),hl=E('<div class="flex gap-2"><!></div>'),wl=E('<li class="mb-2 flex items-center justify-between"><!> <!></li>'),xl=E(`<div class="fixed inset-0 z-150 flex bg-black/50" role="button" tabindex="0" aria-label="Close categories modal"><div class="h-full w-96 bg-base-100 p-6 shadow-xl flex flex-col" role="document"><h2 class="mb-6 text-2xl font-bold">Categories</h2> <div class="flex-1 overflow-y-auto pr-1 border border-base-content/30 rounded-xl p-1 px-2"><ul class="mb-4"></ul></div> <div class="flex gap-2 mt-3"><input class="input-bordered input flex-1" placeholder="New category"/> <button aria-label="Add new category" class="btn btn-primary">Add</button></div> <button class="btn btn-soft mt-2 w-full">Close</button> <div class="mt-1 px-1 text-xs justify-center text-success"><span> </span></div> <div class="my-2 alert alert-default alert-soft "><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>When a category is <b>deleted</b>, all entries in that category are <b>moved to the 'All'</b> category</span></div></div></div>`);function _l(w,i){qe(i,!1);const f=()=>Ae(Ge,"$categories",m),[m,x]=gt();let p=ve(i,"show",8,!1);const b=pt();let _=A(""),d=A(null),D=A("");function I(n){s(d,n),s(D,n)}async function U(n){const k=e(D).trim();if(!k||k==="All"||k===n){s(d,null);return}await Ge.rename(n,k),b("rename",{old:n,new:k}),s(d,null),O(`Category renamed to "${k}"`)}async function j(){const n=e(_).trim();!n||n==="All"||(await Ge.add(n),s(_,""))}let N=A(""),y=A(!1);function O(n,k=2e3){s(N,n),s(y,!0),setTimeout(()=>{s(y,!1)},k)}async function C(n){n!=="All"&&(await le.moveCategoryToAll(n),await Ge.remove(n),O(`Category "${n}" deleted. Entries moved to 'All'.`))}Ht(()=>{Ge.load()}),Ue();var g=yt(),L=Ye(g);{var B=n=>{var k=xl(),R=a(k),H=l(a(R),2),G=a(H);Ne(G,5,()=>(f(),$(()=>["All",...f().filter(P=>P!=="All")])),Je,(P,u)=>{var S=wl(),F=a(S);{var ke=Y=>{var Z=pl();ce(Z),fa(Z),ae(Z,()=>e(D),ge=>s(D,ge)),v("keydown",Z,ge=>ge.key==="Enter"&&U(e(u))),v("blur",Z,()=>U(e(u))),h(Y,Z)},ue=Y=>{var Z=gl(),ge=a(Z,!0);t(Z),Q(()=>ie(ge,e(u))),v("dblclick",Z,()=>I(e(u))),h(Y,Z)};J(F,Y=>{e(d)===e(u)?Y(ke):Y(ue,!1)})}var oe=l(F,2);{var se=Y=>{var Z=hl(),ge=a(Z);{var Ee=fe=>{var me=fl();v("click",me,Pe(()=>U(e(u)))),h(fe,me)},Ce=fe=>{var me=ml(),xe=Ye(me),Te=l(xe,2);v("click",xe,Pe(()=>I(e(u)))),v("click",Te,Pe(()=>C(e(u)))),h(fe,me)};J(ge,fe=>{e(d)===e(u)?fe(Ee):fe(Ce,!1)})}t(Z),h(Y,Z)};J(oe,Y=>{e(u)!=="All"&&Y(se)})}t(S),h(P,S)}),t(G),t(H);var W=l(H,2),T=a(W);ce(T);var z=l(T,2);t(W);var K=l(W,2),ee=l(K,2),re=a(ee),ne=a(re,!0);t(re),t(ee),je(2),t(R),t(k),Q(()=>{na(ee,`min-height: 1.55rem; max-height: 1.55rem; visibility: ${e(y)?"visible":"hidden"}`),ie(ne,e(N))}),ae(T,()=>e(_),P=>s(_,P)),v("click",z,j),v("click",K,()=>b("close")),v("click",R,Pe(function(P){lt.call(this,i,P)})),v("click",k,()=>b("close")),v("keydown",k,P=>{(P.key==="Enter"||P.key===" ")&&b("close")}),h(n,k)};J(L,n=>{p()&&n(B)})}h(w,g),Re(),x()}var yl=E('<li><input type="radio" name="theme-dropdown" class="theme-controller btn btn-sm btn-block btn-ghost justify-start"/></li>'),kl=E('<div><div tabindex="0" role="button" class="btn p-2 m-0 rounded-2xl">üé® <svg width="12px" height="12px" class="inline-block h-1 w-1 fill-current opacity-60" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048"><path d="M1799 349l242 241-1017 1017L7 590l242-241 775 775 775-775z"></path></svg></div> <ul tabindex="-1" class="dropdown-content menu bg-base-300 rounded-2xl z-150 w-52 p-2 shadow-sm"></ul></div>');function Cl(w,i){qe(i,!1);const f=()=>Ae(ea,"$theme",m),[m,x]=gt(),p=["light","cupcake","night","dark","emerald","fantasy","luxury","acid","coffee","retro","business","dracula","dim","garden"];let b=ve(i,"dropdownDirection",8,"dropdown-end");function _(I){ea.set(I)}Ue();var d=kl(),D=l(a(d),2);Ne(D,5,()=>p,Je,(I,U)=>{var j=yl(),N=a(j);ce(N),t(j),Q(()=>{kt(N,"aria-label",e(U)),Aa(N,e(U)),Ea(N,f()===e(U))}),v("change",N,()=>_(e(U))),h(I,j)}),t(D),t(d),Q(()=>De(d,1,`dropdown ${b()}`)),h(w,d),Re(),x()}var Sl=E('<span class="absolute -top-6 -left-2 flex h-5 w-20 items-center justify-center rounded-full bg-red-600 text-xs font-bold text-white p-1"> </span>'),Al=E('<li><button class="w-full border border-base-300 text-left hover:bg-base-200"> </button></li>'),El=E('<ul class="dropdown-content menu mt-3 w-52 rounded-box bg-base-100 p-2 shadow-md"></ul>'),Tl=E('<div class="fixed top-16 left-1/2 z-50 flex items-center gap-4 rounded-lg border border-base-300 bg-base-100 p-2 shadow-md select-none"><div role="button" tabindex="0" class="cursor-grab rounded-md bg-base-200 p-2 hidden md:inline-block" aria-label="Drag toolbar">‚†ø</div> <div class="md:tooltip" data-tip="Delete"><button class="btn relative btn-square btn-error" aria-label="Delete selected"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 7h12M10 11v6m4-6v6M5 7l1 12a2 2 0 002 2h8a2 2 0 002-2l1-12M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3"></path></svg> <!></button></div> <div class="md:tooltip" data-tip="Select all"><button class="btn btn-square btn-ghost" aria-label="Select all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7M5 7l4 4L19 1"></path></svg></button></div> <div class="md:tooltip" data-tip="Deselect all"><button class="btn btn-square opacity-50 btn-ghost" aria-label="Deselect all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current opacity-20"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7M5 7l4 4L19 1"></path></svg></button></div> <div><div class="md:tooltip" data-tip="Move to category"><button class="btn btn-square btn-ghost" aria-label="Move to category"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4h16v4H4V4zm0 8h16v4H4v-4zm0 8h16v4H4v-4z"></path></svg></button></div> <!></div> <div class="md:tooltip" data-tip="Cancel"><button class="btn btn-square bg-red-700 text-white btn-ghost hover:bg-red-500" aria-label="Cancel selection"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div role="button" tabindex="0" class="drag-handle cursor-grab rounded-md bg-base-200 p-2" aria-label="Drag toolbar">‚†ø</div></div>');function Ml(w,i){qe(i,!1);let f=ve(i,"selectedCount",8,0),m=ve(i,"categoryList",24,()=>[]),x=ve(i,"showCategoryDropdown",8,!1);const p=pt();let b=!1,_=0,d=0,D=A(0),I=A(0);function U(u){b=!0,_=u.clientX-e(D),d=u.clientY-e(I),window.addEventListener("pointermove",j),window.addEventListener("pointerup",N)}function j(u){b&&(s(D,u.clientX-_),s(I,u.clientY-d))}function N(){b=!1,window.removeEventListener("pointermove",j),window.removeEventListener("pointerup",N)}Ue();var y=Tl(),O=a(y),C=l(O,2),g=a(C),L=l(a(g),2);{var B=u=>{var S=Sl(),F=a(S,!0);t(S),Q(()=>ie(F,f())),h(u,S)};J(L,u=>{f()>0&&u(B)})}t(g),t(C);var n=l(C,2),k=a(n);t(n);var R=l(n,2),H=a(R);t(R);var G=l(R,2);let W;var T=a(G),z=a(T);t(T);var K=l(T,2);{var ee=u=>{var S=El();Ne(S,5,m,Je,(F,ke)=>{var ue=Al(),oe=a(ue),se=a(oe,!0);t(oe),t(ue),Q(()=>ie(se,e(ke))),v("click",oe,()=>p("moveCategory",e(ke))),h(F,ue)}),t(S),h(u,S)};J(K,u=>{X(x()),X(m()),$(()=>x()&&m().length>0)&&u(ee)})}t(G);var re=l(G,2),ne=a(re);t(re);var P=l(re,2);t(y),Q(()=>{na(y,`transform: translate(calc(-50% + ${e(D)??""}px), ${e(I)??""}px);`),g.disabled=f()===0,W=De(G,1,"dropdown dropdown-end",null,W,{"dropdown-open":x()}),z.disabled=f()===0}),v("pointerdown",O,U),v("click",g,()=>p("delete")),v("click",k,()=>p("selectAll")),v("click",H,()=>p("deselectAll")),v("click",z,()=>p("toggleCategoryDropdown")),v("click",ne,()=>p("cancel")),v("pointerdown",P,U),h(w,y),Re()}var $l=la('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4h16v16H4V4z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M8 12h8"></path></svg>'),jl=la('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2"><rect x="4" y="4" width="16" height="16" stroke="currentColor" stroke-width="2"></rect><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h8"></path></svg>'),Nl=E('<button><div class="indicator"><span class="indicator-item bg-base-100 text-xs rounded-3xl px-1.5 py-0.5 -top-1"> </span> <div class="z-10"> </div></div></button>'),Dl=E('<div class="flex items-center justify-center"><span class="loading loading-dots loading-sm text-primary"></span> <span class="loading loading-ring loading-sm text-primary"></span> <span class="loading loading-dots loading-sm text-primary"></span></div>'),Il=E('<div class="flex items-center justify-center"><span class="loading loading-bars loading-sm text-primary"></span></div>'),Ll=E('<div class="flex h-screen flex-col"><div class="navbar bg-base-100 shadow-lg"><div class="flex-none"><button class="btn btn-square btn-ghost" aria-label="Open menu"><!></button></div> <div class="flex-1"><span class="text-md md:text-xl font-bold"> <span class="hide-on-320 svelte-j9gjs9"> </span></span></div> <div class="flex-none"><button class="btn btn-square btn-ghost" aria-label="Toggle search"><!></button> <div class="tooltip-bottom tooltip" data-tip="Open filters"><button class="btn btn-square btn-ghost" aria-label="Open filters"><!></button></div> <div class="tooltip-bottom tooltip" data-tip="Select entries"><button class="btn btn-square btn-ghost" aria-label="Select entries"><!></button></div> <button class="btn btn-square btn-ghost inline-block md:hidden" aria-label="Toggle grid columns" title="Toggle grid columns"><!></button> <!></div></div> <!> <div class="tabs tabs-border flex-nowrap gap-3 overflow-x-auto bg-base-200 px-2 pt-2 pb-1 scrollbar-hide"><button class="p-0 m-0" title="Toggle unique entries" aria-label="Show unique entries only"><!></button> <button><div class="z-10">All</div> <span class="bg-base-100 text-xs rounded-3xl px-1.5 py-0.5"> </span></button> <!></div> <button class="z-100 btn fixed right-6 bottom-6 btn-circle shadow-xl btn-lg btn-primary" aria-label="Add new entry"><!></button> <!>  <div class="flex-1 overflow-auto p-4"><!> <!> <!></div></div> <!> <!> <!> <!> <!> <!>',1);function Ol(w,i){qe(i,!1);const f=()=>Ae(Na,"$filteredEntries",d),m=()=>Ae(bt,"$selectedCategory",d),x=()=>Ae(Ge,"$categories",d),p=()=>Ae(Lt,"$entries",d),b=()=>Ae(Se,"$searchQuery",d),_=()=>Ae(aa,"$gridCols",d),[d,D]=gt(),I=A(),U=A();let j=A(!1),N=A(!1),y=A(!1),O=A(!1),C=A(!1),g=A(null),L=A(null),B=A(!1),n=A(new Set),k=A(!1);const R=pt();let H=A(!1),G=A(""),W=A(!1);function T(){aa.update(r=>r===3?4:3)}async function z(){const r=await le.getAllEntries();Lt.set(r),Array.from(new Set(r.map(M=>M.category).filter(M=>M&&M!=="All"))),Ge.load()}Ht(async()=>{await z(),Da();const r=localStorage.getItem("selectedCategory");r&&bt.set(r)});function K(){s(g,null),s(C,!0),s(k,!1)}async function ee(){s(C,!1),s(g,null),await z()}function re(){s(C,!1),s(g,null)}async function ne(){s(O,!1),s(L,null),await z()}function P(){s(O,!1),s(L,null)}let u;function S(r){s(G,r),s(W,!0),clearTimeout(u),u=window.setTimeout(()=>{s(W,!1)},1500)}let F=A(!1);async function ke(r){s(F,!0),await le.importFromJSON(r),await z(),s(F,!1),s(y,!1)}async function ue(){const r=await le.exportToJSON(),M=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),we=URL.createObjectURL(M),be=document.createElement("a");be.href=we,be.download=`lib-export-${new Date().toISOString()}.json`,document.body.appendChild(be),be.click(),document.body.removeChild(be),URL.revokeObjectURL(we),s(y,!1),S("Exported to JSON üëç :Downloads/")}async function oe(){const r=await le.exportToMarkdown(),M=new Blob([r],{type:"text/markdown"}),we=URL.createObjectURL(M),be=document.createElement("a");be.href=we,be.download=`lib-export-${new Date().toISOString()}.md`,document.body.appendChild(be),be.click(),document.body.removeChild(be),URL.revokeObjectURL(we),s(y,!1),S("Exported to Markdown üëç :Downloads/")}async function se(r){await le.moveCategoryToAll(r),m()===r&&bt.set("All"),await z(),s(B,!1)}let Y=A(!1);async function Z(r){for(const we of e(n))p().find(It=>It.id===we)&&await le.updateEntry(we,{category:r});e(n).clear(),s(n,new Set(e(n))),s(k,!1);const M=await le.getAllEntries();Lt.set(M),s(Y,!1)}function ge(r){e(n).has(r)?e(n).delete(r):e(n).add(r),s(n,new Set(e(n)))}let Ee=A(!1);async function Ce(){if(e(n).size===0)return;s(Ee,!0);const r=Array.from(e(n));for(const M of r)await le.deleteEntry(M);e(n).clear(),s(n,new Set(e(n))),await z(),s(k,!1),s(Ee,!1)}function fe(){s(n,new Set(f().map(r=>r.id)))}function me(){e(n).clear(),s(n,new Set(e(n)))}at(()=>(e(H),f(),ta),()=>{s(I,e(H)?Array.from(new Map(f().map(r=>[ta(r),r])).values()):f())}),at(()=>x(),()=>{s(U,x().filter(r=>r!=="All"))}),Ft(),Ue();var xe=Ll(),Te=Ye(xe),Ie=a(Te),Le=a(Ie),te=a(Le),st=a(te);pe(st,()=>(X(V),$(()=>V.menu))),t(te),t(Le);var Ze=l(Le,2),rt=a(Ze),nt=a(rt);nt.nodeValue="Lib ";var Ct=l(nt),ft=a(Ct);t(Ct),t(rt),t(Ze);var ot=l(Ze,2),Xe=a(ot),zt=a(Xe);pe(zt,()=>(X(V),$(()=>V.search))),t(Xe);var it=l(Xe,2),Qe=a(it),mt=a(Qe);pe(mt,()=>(X(V),$(()=>V.filter))),t(Qe),t(it);var dt=l(it,2),Ke=a(dt),St=a(Ke);pe(St,()=>(X(V),$(()=>V.select))),t(Ke),t(dt);var ct=l(dt,2),At=a(ct);pe(At,()=>(X(V),$(()=>V.toggleGrid))),t(ct);var Et=l(ct,2);Cl(Et,{dropdownDirection:"dropdown-bottom dropdown-end"}),t(ot),t(Ie);var Tt=l(Ie,2);{var Mt=r=>{Xa(r,{get show(){return e(j)},set show(M){s(j,M)},$$legacy:!0})},$t=sa(()=>(e(j),b(),$(()=>e(j)||b().trim()!=="")));J(Tt,r=>{e($t)&&r(Mt)})}var vt=l(Tt,2),c=a(vt),o=a(c);{var q=r=>{var M=$l();h(r,M)},_e=r=>{var M=jl();h(r,M)};J(o,r=>{e(H)?r(q):r(_e,!1)})}t(c);var de=l(c,2);let Me;var We=l(a(de),2),et=a(We,!0);t(We),t(de);var Fe=l(de,2);Ne(Fe,1,()=>e(U),Je,(r,M)=>{var we=Nl();let be;var It=a(we),Jt=a(It),pa=a(Jt,!0);t(Jt);var Zt=l(Jt,2),ga=a(Zt,!0);t(Zt),t(It),t(we),Q(Ut=>{be=De(we,1,"tab",null,be,{"tab-active":m()===e(M)}),ie(pa,Ut),ie(ga,e(M))},[()=>(p(),e(M),$(()=>p().filter(Ut=>Ut.category===e(M)).length))]),v("click",we,()=>bt.set(e(M))),h(r,we)}),t(vt);var Oe=l(vt,2),Be=a(Oe);pe(Be,()=>(X(V),$(()=>V.add))),t(Oe);var He=l(Oe,2);{var tt=r=>{Ml(r,{get selectedCount(){return e(n),$(()=>e(n).size)},get categoryList(){return e(U)},get showCategoryDropdown(){return e(Y)},$$events:{delete:Ce,selectAll:fe,deselectAll:me,toggleCategoryDropdown:()=>s(Y,!e(Y)),moveCategory:M=>Z(M.detail),cancel:()=>{s(k,!1),s(Y,!1),e(n).clear(),s(n,new Set(e(n)))}}})};J(He,r=>{e(k)&&r(tt)})}var Ve=l(He,2),he=a(Ve);{var jt=r=>{var M=Dl();h(r,M)};J(he,r=>{e(Ee)&&r(jt)})}var ut=l(he,2);{var Nt=r=>{var M=Il();h(r,M)};J(ut,r=>{e(F)&&r(Nt)})}var Dt=l(ut,2);Fa(Dt,{get entries(){return e(I)},get selectionMode(){return e(k)},get selectedEntries(){return e(n)},get gridCols(){return _()},$$events:{toggleSelect:r=>ge(r.detail)}}),t(Ve),t(Te);var ht=l(Te,2);{var ye=r=>{Ka(r,{get show(){return e(N)},set show(M){s(N,M)},$$legacy:!0})};J(ht,r=>{e(N)&&r(ye)})}var Vt=l(ht,2);{var da=r=>{rl(r,{get importing(){return e(F)},get show(){return e(y)},set show(M){s(y,M)},$$events:{import:M=>ke(M.detail),export:ue,exportMd:oe,showCategories:()=>{s(y,!1),s(B,!0)}},$$legacy:!0})};J(Vt,r=>{e(y)&&r(da)})}var Gt=l(Vt,2);{var ca=r=>{_l(r,{get show(){return e(B)},$$events:{close:()=>s(B,!1),rename:M=>R("renameCategory",M.detail),delete:M=>se(M.detail)}})};J(Gt,r=>{e(B)&&r(ca)})}var Pt=l(Gt,2);{var va=r=>{Ta(r,{get entryId(){return e(L)},$$events:{save:ne,cancel:P}})};J(Pt,r=>{e(O)&&r(va)})}var Yt=l(Pt,2);{var ua=r=>{bl(r,{get entryId(){return e(g)},$$events:{save:ee,cancel:re}})};J(Yt,r=>{e(C)&&r(ua)})}var ba=l(Yt,2);ia(ba,{get showAlert(){return e(W)},get message(){return e(G)}}),Q(()=>{ie(ft,`(${p(),$(()=>p().length)??""})`),Me=De(de,1,"tab relative",null,Me,{"tab-active":m()==="All"}),ie(et,(p(),$(()=>p().length)))}),v("click",te,()=>s(y,!0)),v("click",Xe,()=>{s(j,!e(j)),s(k,!1)}),v("click",Qe,()=>{s(N,!e(N)),s(k,!1)}),v("click",Ke,()=>{e(k)&&(e(n).clear(),s(n,new Set(e(n))),s(Y,!1)),s(k,!e(k))}),v("click",ct,T),v("click",c,()=>s(H,!e(H))),v("click",de,()=>bt.set("All")),v("click",Oe,K),h(w,xe),Re(),D()}function Vl(w){wa("1uha8ag",i=>{ma(()=>{ha.title="lib"})}),Ol(w,{})}export{Vl as component};
