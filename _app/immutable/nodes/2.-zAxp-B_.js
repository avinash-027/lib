import{c as Lt,a as p,f as h,d as Ft}from"../chunks/DLeEY7fs.js";import{i as Ve}from"../chunks/D56Uv2cy.js";import{h as Qt,z as Ge,A as it,D as Pe,w as se,o as M,E as a,G as l,v as e,F as t,B as ee,aP as Yt,W as s,aN as Ct,aT as et,aU as Ht,V as m,ax as ze,aY as _t,aZ as Be,a_ as ba,O as pa,aW as ga}from"../chunks/BPO9GtFz.js";import{h as fa}from"../chunks/CuXflmye.js";import{c as gt,o as Ot,g as ma}from"../chunks/Dpa3FFmK.js";import{s as ce,e as i,r as ha}from"../chunks/DfAXxMbk.js";import{p as ge,i as L,b as Rt,a as Ce,s as ft}from"../chunks/CrlJmSwP.js";import{t as wa,d as be,e as Ue,k as Ne,c as xa,s as pt,j as he,S as P,l as Fe,m as yt,r as pe,n as oe,o as Nt,p as It,q as aa,a as Ke,b as tt,g as _a,i as We,u as Zt,R as Xt,v as He,w as ya,f as ka,h as Ca,x as Kt,y as kt,z as ea,A as Jt,B as ta,C as Sa,E as Aa}from"../chunks/Btp1tUqd.js";import{g as Ta,b as Ea}from"../chunks/C-gPuHYX.js";function la(k,c,T,C){var E=k.__style;if(Qt||E!==c){var $=wa(c);(!Qt||$!==k.getAttribute("style"))&&($==null?k.removeAttribute("style"):k.style.cssText=$),k.__style=c}return C}let qt=null;async function $a(){if(localStorage.getItem("autoBackupEnabled")!=="true")return;const c=await(await be.getDB()).get("settings","backupDirHandle");c&&sa(c)}async function Ma(k){const c=await be.exportToJSON(),C=await(await k.getFileHandle("lib-autobackup.json",{create:!0})).createWritable();await C.write(JSON.stringify(c,null,2)),await C.close(),console.log("‚úÖ Auto backup saved at",new Date().toLocaleString())}function sa(k){qt&&clearTimeout(qt);const c=new Date,T=new Date;T.setHours(12,0,0,0);const C=new Date;C.setHours(24,0,0,0);let E;c<T?E=T:E=C;const $=E.getTime()-c.getTime();qt=window.setTimeout(async()=>{await k.queryPermission({mode:"readwrite"})==="granted"&&await Ma(k),sa(k)},$)}function Da(k){const c=new IntersectionObserver(([T],C)=>{if(T.isIntersecting){const E=k.dataset.src;E&&(k.src=E),k.classList.add("lozad-loaded"),C.unobserve(k)}});return c.observe(k),{destroy(){c.unobserve(k)}}}var ja=h('<div class="px-1 w-full opacity-80 text-sm h-65 md:h-55 flex items-end justify-center text-base-content/50 scroll-smooth"><div>No entries found. <ul class="list-disc list-inside mt-1"><li>Add new entries by clicking the <b>"+"</b> button.</li> <li>To Manage categories, click the "Categories" button in the <b>Menu</b>.</li> <li class="text-success mt-1">ID (auto-generated) and slug are <b>unique identifiers</b></li> <li class="text-success"><b>Import</b> uses fingerprint matching (slug prioritized)</li></ul></div></div>'),Na=Ft('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-12 h-12 bg-base-300/50 rounded-xl  drop-shadow-[0_0_10px_rgba(239,68,68,0.8)]" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7M5 7l4 4L19 1"></path></svg>'),Ia=h('<button type="button"><!></button>'),La=h('<img class="w-full h-full object-cover lozad"/>'),Oa=h('<div class="w-full h-full flex items-center justify-center text-base-content/20"><!></div>'),Ba=h('<span class="absolute bottom-0 left-0 rounded-se-md text-[.7em] md:text-sm bg-base-200/85 px-1 py-0"> </span>'),za=h('<span class="z-11 absolute -top-[5px] right-1 rounded-full text-[.6em] w-1/2 font-semibold px-1 py-0 line-clamp-1 break-words md:text-sm bg-info text-base-300 group-hover:hidden"> </span>'),Ua=h('<span class="absolute top-1 left-1 rounded-2xl text-xs md:text-sm bg-info text-base-300 px-1 py-0 font-semibold"> </span>'),Ja=h('<div class="relative"><!> <button class="group card bg-base-100 shadow-xl cursor-pointer hover:shadow-info/30 transition-[1px] w-full h-full transition duration-150 ease-in-out hover:-translate-y-1 hover:scale-102"><figure class="relative aspect-[3/4] bg-base-300"><!> <!></figure> <!> <div class="card-body p-2"><!> <div class="card-title text-xs sm:text-sm line-clamp-2"> </div></div></button></div>'),qa=h("<div></div>");function Ra(k,c){Ge(c,!1);let T=ge(c,"entries",24,()=>[]),C=ge(c,"selectionMode",8,!1),E=ge(c,"selectedEntries",24,()=>new Set),$=ge(c,"gridCols",8,4);const w=gt();function D(_){!C()&&_!==void 0&&Ta(`${Ea}/detail/${_}`)}function u(_){w("toggleSelect",_)}const q={2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5"};Ve();var W=Lt(),R=it(W);{var U=_=>{var O=ja();p(_,O)},S=_=>{var O=qa();Ue(O,5,T,J=>J.id,(J,v)=>{var g=Ja(),o=a(g);{var j=I=>{var y=Ia();let G;var de=a(y);{var F=ve=>{var Se=Na();p(ve,Se)},ie=Yt(()=>(se(E()),e(v),M(()=>E().has(e(v).id))));L(de,ve=>{e(ie)&&ve(F)})}t(y),ee(ve=>G=Ne(y,1,"rounded-xl absolute inset-0 z-10 flex items-center justify-center bg-black/30 text-base-accent cursor-pointer transition-opacity",null,G,ve),[()=>({selected:E().has(e(v).id)})]),i("click",y,ve=>{ve.stopPropagation(),u(e(v).id)}),p(I,y)};L(o,I=>{C()&&I(j)})}var K=l(o,2),B=a(K),Y=a(B);{var Q=I=>{var y=La();xa(y,G=>Da?.(G)),ee(()=>{pt(y,"src",(e(v),M(()=>e(v).coverImageUrl))),pt(y,"alt",(e(v),M(()=>e(v).title)))}),ha(y),p(I,y)},V=I=>{var y=Oa(),G=a(y);he(G,()=>(se(P),M(()=>P.imgIcon))),t(y),p(I,y)};L(Y,I=>{e(v),M(()=>e(v).coverImageUrl)?I(Q):I(V,!1)})}var X=l(Y,2);{var f=I=>{var y=Ba(),G=a(y,!0);t(y),ee(()=>ce(G,(e(v),M(()=>e(v).dataType)))),p(I,y)};L(X,I=>{e(v),M(()=>e(v).dataType)&&I(f)})}t(B);var b=l(B,2);{var z=I=>{var y=za(),G=a(y,!0);t(y),ee(()=>ce(G,(e(v),M(()=>e(v).category)))),p(I,y)},re=Yt(()=>(e(v),M(()=>e(v).category&&e(v).category.trim().toLowerCase()!=="all")));L(b,I=>{e(re)&&I(z)})}var te=l(b,2),le=a(te);{var N=I=>{var y=Ua(),G=a(y,!0);t(y),ee(()=>ce(G,(e(v),M(()=>e(v).rating)))),p(I,y)};L(le,I=>{e(v),M(()=>e(v).rating!==null&&e(v).rating>0)&&I(N)})}var ae=l(le,2),ne=a(ae,!0);t(ae),t(te),t(K),t(g),ee(()=>ce(ne,(e(v),M(()=>e(v).title)))),i("click",K,()=>D(e(v).id)),p(J,g)}),t(O),ee(()=>Ne(O,1,(se($()),M(()=>`grid gap-2 ${q[$()]} md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 scroll-smooth`)))),p(_,O)};L(R,_=>{se(T()),M(()=>T().length===0)?_(U):_(S,!1)})}p(k,W),Pe()}var Fa=h("alternative titles <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Ha=h("tags <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Wa=h("badges <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Va=h("characters <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Ga=h('<div class="text-xs text-info mt-2">Searching in: <!> <!> <!> <!></div>'),Pa=h(`<div class="bg-base-200 px-4 pt-3 pb-1 shadow-lg"><div class="flex gap-2 items-center"><input type="text" placeholder="Search ('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)" class="input input-bordered flex-1"/> <button class="btn px-[10px] btn-outline text-bg-accent rounded-full" aria-label="Close search"><!></button></div> <!></div>`);function Qa(k,c){Ge(c,!1);const T=()=>Ce(Fe,"$searchQuery",E),C=()=>Ce(yt,"$searchMode",E),[E,$]=ft();let w=ge(c,"show",12,!1),D=m(""),u=m(),q=m(!1);Ot(async()=>{const g=T(),o=C();g&&(w(!0),s(D,o!=="default"?`${o}:${g}`:g)),await Ct(),s(q,!0)});function W(){s(D,""),Fe.set(""),yt.set("default"),w(!1)}et(()=>Fe,()=>{ma(Fe)&&w(!0)}),et(()=>(se(w()),e(u),Ct),()=>{w()&&e(u)&&Ct().then(()=>e(u).focus())}),et(()=>(e(q),e(D),Fe),()=>{if(e(q)){const g=e(D).trim(),o=g.toLowerCase();o.startsWith("a:")?(yt.set("a"),Fe.set(g.slice(2))):o.startsWith("t:")?(yt.set("t"),Fe.set(g.slice(2))):(yt.set("default"),Fe.set(g))}}),Ht(),Ve();var R=Pa(),U=a(R),S=a(U);pe(S),Rt(S,g=>s(u,g),()=>e(u));var _=l(S,2),O=a(_);he(O,()=>(se(P),M(()=>P.closeCross))),t(_),t(U);var J=l(U,2);{var v=g=>{var o=Ga(),j=l(a(o));{var K=b=>{var z=Fa();ze(2),p(b,z)};L(j,b=>{C()==="a"&&b(K)})}var B=l(j,2);{var Y=b=>{var z=Ha();ze(2),p(b,z)};L(B,b=>{C()==="t"&&b(Y)})}var Q=l(B,2);{var V=b=>{var z=Wa();ze(2),p(b,z)};L(Q,b=>{C()==="b"&&b(V)})}var X=l(Q,2);{var f=b=>{var z=Va();ze(2),p(b,z)};L(X,b=>{C()==="c"&&b(f)})}t(o),p(g,o)};L(J,g=>{C()!=="default"&&g(v)})}t(R),oe(S,()=>e(D),g=>s(D,g)),i("click",_,W),p(k,R),Pe(),$()}var Ya=h('<div class="fixed inset-0 bg-black/50 z-150 flex items-end" role="presentation"><div class="bg-base-100 w-full rounded-t-2xl p-6 max-h-[80vh] overflow-auto" role="dialog" tabindex="-1"><h3 class="text-2xl font-bold mb-6">Sort & Filter</h3> <div class="form-control mb-4"><label class="label" for="sort-field"><span class="label-text font-semibold">Sort By</span></label> <select id="sort-field" class="select select-bordered w-full"><option>Title (A-Z)</option><option>Rating</option><option>Last Edited</option><option>Date Created</option><option>Last Opened</option></select></div> <div class="form-control mb-6"><label class="label" for="sort-order"><span class="label-text font-semibold">Order</span></label> <div class="flex gap-2"><button>Ascending</button> <button>Descending</button></div></div> <div class="flex gap-2"><button class="btn btn-outline flex-1">Reset</button> <button class="btn btn-primary flex-1">Apply</button></div></div></div>');function Za(k,c){Ge(c,!1);const T=()=>Ce(Nt,"$sortField",E),C=()=>Ce(It,"$sortOrder",E),[E,$]=ft();let w=ge(c,"show",12,!1),D=m(T()),u=m(C());Nt.subscribe(_=>s(D,_)),It.subscribe(_=>s(u,_));function q(){Nt.set(e(D)),It.set(e(u)),w(!1)}function W(){s(D,"title"),s(u,"asc"),Nt.set(e(D)),It.set(e(u)),w(!1)}Ve();var R=Lt(),U=it(R);{var S=_=>{var O=Ya(),J=a(O),v=l(a(J),2),g=l(a(v),2),o=a(g);o.value=o.__value="title";var j=l(o);j.value=j.__value="rating";var K=l(j);K.value=K.__value="editedAt";var B=l(K);B.value=B.__value="createdAt";var Y=l(B);Y.value=Y.__value="openedAt",t(g),t(v);var Q=l(v,2),V=l(a(Q),2),X=a(V);let f;var b=l(X,2);let z;t(V),t(Q);var re=l(Q,2),te=a(re),le=l(te,2);t(re),t(J),t(O),ee(()=>{f=Ne(X,1,"btn flex-1",null,f,{"btn-primary":e(u)==="asc"}),pt(X,"aria-pressed",e(u)==="asc"),z=Ne(b,1,"btn flex-1",null,z,{"btn-primary":e(u)==="desc"}),pt(b,"aria-pressed",e(u)==="desc")}),aa(g,()=>e(D),N=>s(D,N)),i("click",X,()=>s(u,"asc")),i("click",b,()=>s(u,"desc")),i("click",te,W),i("click",le,q),i("click",J,Ke(function(N){tt.call(this,c,N)})),i("keydown",J,function(N){tt.call(this,c,N)}),i("click",O,()=>w(!1)),i("keydown",O,function(N){tt.call(this,c,N)}),p(_,O)};L(U,_=>{w()&&_(S)})}p(k,R),Pe(),$()}const Xa=`\`\`\`json\r
// Example\r
[\r
  {\r
    "id": 2,\r
    "title": "Solo Leveling",\r
    "slug": "solo-leveling",\r
    "alternativeTitles": [ "Only I Level Up", "Na Honja Level Up" ],\r
    "coverImageUrl": "https://example.com/covers/solo-leveling.jpg",\r
    "description": "In a world where gates connect Earth to deadly dungeons, the weakest hunter awakens a mysterious system that allows him to level up alone.",\r
    "badges": ["Manhwa", "Action", "Fantasy", "Completed"],\r
    "tags": [ "gates", "hunters", "dungeons", "system", "shadows", "awakening"],\r
    "rating": null,\r
    "createdAt": "2024-12-15T08:20:00.000Z",\r
    "openedAt": "2025-02-07T14:10:30.000Z",\r
    "editedAt": "2025-02-07T18:45:10.000Z",\r
    "characters": [\r
      {\r
        "Name": "Sung Jin-Woo",\r
        "Image": "https://example.com/characters/sung-jin-woo.png",\r
        "role": "Main",\r
        "alternativeNames": [ "Jinwoo"],\r
        "tags": ["MC", "Solo-Player"],\r
        "description": ""\r
      },\r
      {\r
        "Name": "Cha Hae-In",\r
        "role": "Main",\r
        "Image": "https://example.com/characters/cha-hae-in.png"\r
      },\r
      {\r
        "Name": "Go Gun-Hee",\r
        "role": "supporting",\r
        "Image": "https://example.com/characters/go-gun-hee.png"\r
      }\r
    ],\r
    "rows": [\r
      {\r
        "ChapterSE": "Episode 1 ‚Äì The Weakest Hunter",\r
        "Description": "E-rank hunter Sung Jin-Woo barely survives a low-level dungeon while struggling to pay his family‚Äôs medical bills.",\r
        "Tags": ["introduction", "low-rank", "desperation"],\r
        "Characters": "Sung Jin-Woo"\r
      },\r
      {\r
        "ChapterSE": "Episode 2 ‚Äì Double Dungeon",\r
        "Description": "A hidden dungeon reveals a deadly trial where survival depends on following cryptic rules.",\r
        "Tags": ["double-dungeon", "statues", "death"],\r
        "Characters": "Sung Jin-Woo, Dungeon Party"\r
      },\r
      {\r
        "ChapterSE": "Episode 3 ‚Äì The System",\r
        "Description": "After facing death, Jin-Woo awakens to a mysterious system that only he can see.",\r
        "Tags": ["awakening", "system", "rebirth"],\r
        "Characters": "Sung Jin-Woo"\r
      }\r
    ],\r
    "category": "Manhwa",\r
    "dataType": "json"\r
  },\r
  // ...\r
]\r
\`\`\``;var Ka=h('<div role="alert" class="fixed bottom-2 left-2 z-300 alert alert-info alert-outline bg-base-100"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>');function ra(k,c){let T=ge(c,"showAlert",8,!1),C=ge(c,"message",8,"");var E=Lt(),$=it(E);{var w=D=>{var u=Ka(),q=l(a(u),2),W=a(q,!0);t(q),t(u),ee(()=>ce(W,C())),p(D,u)};L($,D=>{T()&&D(w)})}p(k,E)}var el=h('<div class="text-left p-4 gap-1"><span class="loading loading-bars loading-sm text-primary"></span>Importing<span class="loading loading-bars loading-sm text-primary"></span></div>'),tl=h('<div class="fixed inset-0 bg-black/50 z-150 flex" role="presentation"><div class="bg-base-100 w-80 h-full shadow-xl p-6 flex flex-col justify-between" role="dialog" tabindex="-1"><div><h2 class="text-2xl font-bold mb-6">Menu <button class="float-right cursor-pointer" aria-label="Close menu" type="button"><!></button></h2> <ul class="menu bg-base-200 rounded-box gap-1 md:gap-3"><li><button aria-label="Import JSON" class="btn btn-md btn-ghost"><!> Import JSON</button></li> <li><button aria-label="Export data" class="btn btn-md btn-ghost"><!> Export JSON</button></li> <li><button class="btn btn-md btn-ghost" aria-label="Export Markdown"><!> Export Md</button></li> <li><button aria-label="Open categories" class="btn btn-md btn-ghost"><!> Categories</button></li> <li><button class="btn btn-md btn-ghost">JSON Format</button></li></ul> <!></div> <dialog class="modal"><div class="modal-box max-w-3xl w-85 md:w-full h-auto max-h-[65vh]"><form method="dialog"><button type="button" aria-label="CloseJSONmodal" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 text-lg p-5"><!></button></form> <h3 class="font-bold mb-2">Import JSON Structure</h3> <div class="prose max-w-full overflow-auto text-sm"><!></div></div></dialog> <div class="text-sm text-gray-500 disable"><div class="divider"></div> <p class="font-semibold my-4">ü§ñ AI √ó <a href="https://github.com/avinash-027/" target="_blank" class="link link-primary no-underline">User-A027</a> üë®‚Äçüíª</p></div></div></div>'),al=h('<!> <!> <input type="file" accept=".json" class="hidden"/>',1);function ll(k,c){Ge(c,!1);let T=ge(c,"show",12,!1),C=m(""),E=m(!1);const $=gt();let w=m(),D=ge(c,"importing",8,!1);function u(){e(w).click()}function q(j){const B=j.target.files?.[0];if(!B)return;const Y=new FileReader;Y.onload=Q=>{try{const V=JSON.parse(Q.target?.result),X=Array.isArray(V)?V:[V];$("import",X)}catch{s(C,"Invalid JSON file"),s(E,!0),setTimeout(()=>{s(E,!1)},2e3)}},Y.readAsText(B)}function W(){$("export")}let R=_a.parse(Xa),U=m();function S(){e(U).showModal()}function _(){e(U).close()}Ve();var O=al(),J=it(O);ra(J,{get showAlert(){return e(E)},get message(){return e(C)}});var v=l(J,2);{var g=j=>{var K=tl(),B=a(K),Y=a(B),Q=a(Y),V=l(a(Q)),X=a(V);he(X,()=>(se(P),M(()=>P.circleClose))),t(V),t(Q);var f=l(Q,2),b=a(f),z=a(b),re=a(z);he(re,()=>(se(P),M(()=>P.import))),ze(),t(z),t(b);var te=l(b,2),le=a(te),N=a(le);he(N,()=>(se(P),M(()=>P.export))),ze(),t(le),t(te);var ae=l(te,2),ne=a(ae),I=a(ne);he(I,()=>(se(P),M(()=>P.export))),ze(),t(ne),t(ae);var y=l(ae,2),G=a(y),de=a(G);he(de,()=>(se(P),M(()=>P.category))),ze(),t(G),t(y);var F=l(y,2),ie=a(F);t(F),t(f);var ve=l(f,2);{var Se=x=>{var Z=el();p(x,Z)};L(ve,x=>{D()&&x(Se)})}t(Y);var _e=l(Y,2),Je=a(_e),Te=a(Je),Ae=a(Te),Ie=a(Ae);he(Ie,()=>(se(P),M(()=>P.circleClose))),t(Ae),t(Te);var Ee=l(Te,4),$e=a(Ee);he($e,()=>R),t(Ee),t(Je),t(_e),Rt(_e,x=>s(U,x),()=>e(U)),ze(2),t(B),t(K),i("click",V,()=>T(!1)),i("click",z,u),i("click",le,W),i("click",ne,()=>$("exportMd")),i("click",G,()=>$("showCategories")),i("click",ie,S),i("click",Ae,_),i("click",_e,x=>{x.target===e(U)&&_()}),i("click",B,Ke(function(x){tt.call(this,c,x)})),i("keydown",B,Ke(function(x){tt.call(this,c,x)})),i("click",K,()=>T(!1)),i("keydown",K,x=>x.key==="Escape"&&T(!1)),p(j,K)};L(v,j=>{T()&&j(g)})}var o=l(v,2);Rt(o,j=>s(w,j),()=>e(w)),i("change",o,q),p(k,O),Pe()}var sl=h('<p class="text-error text-sm mt-1"> </p>'),rl=h('<option class="border border-base-200"> </option>'),nl=h("<span>|</span>"),ol=h("<span> </span>"),il=h('<div class="flex gap-2 flex-wrap mb-2 p-2 rounded-lg bg-base-200 border border-base-300"><div class="flex gap-2 w-full"><label class="floating-label w-full" for="charName"><span><span class="label-text">Name **</span></span> <input type="text" id="charName" placeholder="Name *" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charRole"><span><span class="label-text">Role</span></span> <input type="text" id="charRole" placeholder="role" class="input input-sm w-full"/></label> <button class="btn btn-sm btn-square btn-error btn-outline">‚úï</button></div> <label class="floating-label w-full" for="charImgUrl"><span><span class="label-text">Image URL</span></span> <input type="text" id="charImgUrl" placeholder="Img URL" class="input input-sm w-full"/></label> <details class="w-full mt-2"><summary class="cursor-pointer text-sm font-medium text-primary text-center">Extra Details</summary> <div class="space-y-2 mt-2"><label class="floating-label w-full" for="charAltNames"><span><span class="label-text">alternativeNames</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="charAltNames" placeholder="Alternative Names [Ex: Name01, name-01]" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charTags"><span><span class="label-text">char-Tags</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="charTags" placeholder="Tags [Ex: Hero, Villain]" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charDescription"><span><span class="label-text">Description</span></span> <textarea id="charDescription" placeholder="Description" class="textarea textarea-bordered w-full"></textarea></label></div></details></div>'),dl=h('<div class="card bg-base-200 border border-base-300 p-4"><div class="flex gap-2 mb-2"><label class="floating-label w-full"><span>Chapter *</span> <input type="text" placeholder="Chapter (e.g., 1-5)" class="input input-bordered w-full input-sm flex-1"/></label> <button class="btn btn-square btn-error btn-outline btn-sm"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-4 h-4 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <label class="floating-label w-full"><span>Description</span> <textarea placeholder="Description" class="textarea textarea-bordered w-full textarea-sm mb-2"></textarea></label> <label class="floating-label w-full"><span>Tags (comma separated)</span> <input type="text" placeholder="Tags (comma separated)" class="input input-bordered w-full input-sm mb-2"/></label> <label class="floating-label w-full"><span>Characters</span> <input type="text" placeholder="Characters" class="input input-bordered w-full input-sm"/></label></div>'),cl=h('<div class="fixed inset-0 bg-black/50 z-150 flex items-center justify-center p-4"><div class="bg-base-100 w-full max-w-4xl max-h-[90vh] overflow-auto rounded-lg shadow-xl"><div class="bg-base-100 border-b border-base-300 p-4 flex justify-between items-center"><h2 class="text-2xl font-bold"> </h2> <button class="btn btn-square btn-ghost btn-sm"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-6 space-y-4"><div class="form-control"><label for="newtitle" class="floating-label"><span>Title <span class="label-text-alt text-info italic">: required</span></span> <input id="newtitle" type="text" placeholder="Title" class="input input-bordered w-full" required=""/></label> <!></div> <div class="form-control"><label for="newAltTitles" class="floating-label"><span><span class="label-text">Alternative Titles</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="newAltTitles" type="text" placeholder="Alternative Titles [Ex: Title1, Title2]" class="input input-bordered w-full"/></label></div> <div class="form-control"><label for="newCoverImg" class="floating-label"><span class="label-text">Cover Image URL</span> <input id="newCoverImg" type="text" placeholder="Cover Image URL: Web Img Link" class="input input-bordered w-full"/></label></div> <div class="form-control"><label class="floating-label"><span class="label-text">Description</span> <textarea placeholder="Description" class="textarea textarea-bordered w-full h-24"></textarea></label></div> <div class="form-control"><label for="newBadges" class="floating-label"><span><span class="label-text">Badges</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <textarea id="newBadges" placeholder="Badges [Ex: Completed, Ongoing, Author, Artist, Favorite]" class="textarea textarea-bordered w-full"></textarea></label></div> <div class="form-control"><label for="newTags" class="floating-label"><span><span class="label-text">Tags</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <textarea id="newTags" placeholder="Tags [Ex: Themes, Genres]" class="textarea textarea-bordered w-full"></textarea></label></div> <div class="form-control"><label class="floating-label"><span class="label-text font-semibold">Category</span></label> <select class="select select-bordered w-full"><option class="border border-base-content/20 hover:bg-base-200">All</option><!></select></div> <div class="form-control"><label class="flex flex-wrap gap-2 justify-between"><span><span class="label-text font-semibold">Rating <span class="text-info">(0‚Äì10)</span></span></span> <div class="text-xs md:text-sm text-info"><span class="font-semibold">Value:</span> </div></label> <div class="w-full max-w-xs"><input type="range" min="0" max="10" step="1" class="range range-xs range-info"/> <div class="flex justify-between px-2.5 mt-1 text-xs"></div> <div class="flex justify-between px-2.5 mt-1 text-xs"></div></div></div> <div class="divider">Characters</div> <div class="space-y-2"><!> <button class="btn btn-outline btn-sm">+ Add Character</button></div> <div class="divider">Chapters</div> <div class="space-y-2"><!> <button class="btn btn-outline btn-sm">+ Add Chapter</button></div></div> <div class="sticky bottom-0 bg-base-100 border-t border-base-300 p-4 flex gap-2 justify-end"><button class="btn btn-outline">Cancel</button> <button class="btn btn-primary">Save</button></div></div></div>');function vl(k,c){Ge(c,!1);const T=()=>Ce(He,"$categories",C),[C,E]=ft(),$=m();let w=ge(c,"entryId",8,null);const D=gt();let u=m(""),q=m(""),W=m(""),R=m(""),U=m(""),S=m(0),_=m(""),O=m("All"),J=m(!1),v=m(""),g=m([]),o=m([]);Ot(async()=>{if(w()!==null){const d=await be.getEntryById(w());d&&(s(u,d.title),s(q,d.alternativeTitles.join(", ")),s(W,d.coverImageUrl||""),s(R,d.description),s(U,d.badges.join(", ")),s(S,Number(d.rating)),s(_,d.tags.join(", ")),s(O,d.category),s(g,d.characters.map(n=>({...n,_alternativeNamesString:(n.alternativeNames??[]).join(", "),_tagsString:(n.tags??[]).join(", ")}))),s(o,d.rows.map(n=>({...structuredClone(n),_tagsText:n.tags.join(", ")}))))}});function j(){s(g,[...e(g),{name:"",image:"",role:"",alternativeNames:[],tags:[],description:"",_alternativeNamesString:"",_tagsString:""}])}function K(d){s(g,e(g).filter((n,H)=>H!==d))}function B(){s(o,[...e(o),{chapterSE:"",description:"",characters:"",tags:[],_tagsText:""}])}function Y(d){s(o,e(o).filter((n,H)=>H!==d))}async function Q(){const d={title:e(u),slug:e(u).toLowerCase().trim().replace(/[\s]+/g,"-").replace(/[^a-z0-9\-]/g,""),alternativeTitles:e(q).split(",").map(n=>n.trim()).filter(Boolean),coverImageUrl:e(W)||null,description:e(R),badges:e(U).split(",").map(n=>n.trim()).filter(Boolean),rating:Number(e(S)),createdAt:null,openedAt:null,editedAt:null,tags:e(_).split(",").map(n=>n.trim()).filter(Boolean),category:e(O)||"All",dataType:"Lib",characters:e(g).filter(n=>n.name).map(n=>({name:n.name,image:n.image,role:n.role,description:n.description,alternativeNames:(n._alternativeNamesString??"").split(",").map(H=>H.trim()).filter(Boolean),tags:(n._tagsString??"").split(",").map(H=>H.trim()).filter(Boolean)})),rows:e(o).filter(n=>n.chapterSE).map(n=>({chapterSE:n.chapterSE,description:n.description,characters:n.characters,tags:n._tagsText.split(",").map(H=>H.trim()).filter(Boolean)}))};w()!==null?await be.updateEntry(w(),d):await be.addEntry(d),D("save")}function V(){D("cancel")}et(()=>e(u),()=>{s($,e(u).toLowerCase().trim().replace(/[\s]+/g,"-").replace(/[^a-z0-9\-]/g,""))}),et(()=>(e(u),se(w()),e($),e(J),Ct),()=>{e(u)?(async()=>{if(w()!==null){const d=await be.getEntryBySlug(e($));s(J,!!d&&d.id!==w())}else s(J,!!await be.getEntryBySlug(e($)));s(v,e(J)?`This title generates a slug(${e($)}) that already Exists. Change title text`:""),await Ct()})():(s(J,!1),s(v,""))}),Ht(),Ve();var X=cl(),f=a(X),b=a(f),z=a(b),re=a(z,!0);t(z);var te=l(z,2);t(b);var le=l(b,2),N=a(le),ae=a(N),ne=l(a(ae),2);pe(ne),t(ae);var I=l(ae,2);{var y=d=>{var n=sl(),H=a(n,!0);t(n),ee(()=>ce(H,e(v))),p(d,n)};L(I,d=>{e(J)&&d(y)})}t(N);var G=l(N,2),de=a(G),F=l(a(de),2);pe(F),t(de),t(G);var ie=l(G,2),ve=a(ie),Se=l(a(ve),2);pe(Se),t(ve),t(ie);var _e=l(ie,2),Je=a(_e),Te=l(a(Je),2);_t(Te),t(Je),t(_e);var Ae=l(_e,2),Ie=a(Ae),Ee=l(a(Ie),2);_t(Ee),t(Ie),t(Ae);var $e=l(Ae,2),x=a($e),Z=l(a(x),2);_t(Z),t(x),t($e);var fe=l($e,2),Qe=l(a(fe),2),Ye=a(Qe);Ye.value=Ye.__value="All";var Me=l(Ye);Ue(Me,1,()=>(T(),M(()=>T().filter(d=>d!=="All"))),We,(d,n)=>{var H=rl(),ue=a(H,!0);t(H);var ye={};ee(()=>{ce(ue,e(n)),ye!==(ye=e(n))&&(H.value=(H.__value=e(n))??"")}),p(d,H)}),t(Qe),t(fe);var De=l(fe,2),qe=a(De),Re=l(a(qe),2),Bt=l(a(Re));t(Re),t(qe);var dt=l(qe,2),at=a(dt);pe(at);var mt=l(at,2);Ue(mt,4,()=>M(()=>Array.from({length:11},(d,n)=>n)),We,(d,n)=>{var H=nl();ee(()=>Ne(H,1,Zt(n===e(S)?"text-info font-bold":""))),p(d,H)}),t(mt);var ct=l(mt,2);Ue(ct,4,()=>M(()=>Array.from({length:11},(d,n)=>n)),We,(d,n)=>{var H=ol(),ue=a(H,!0);t(H),ee(()=>{Ne(H,1,Zt(n===e(S)?"text-info font-bold":"")),ce(ue,n)}),p(d,H)}),t(ct),t(dt),t(De);var lt=l(De,4),St=a(lt);Ue(St,1,()=>e(g),We,(d,n,H)=>{var ue=il(),ye=a(ue),Le=a(ye),rt=l(a(Le),2);pe(rt),t(Le);var nt=l(Le,2),je=l(a(nt),2);pe(je),t(nt);var bt=l(nt,2);t(ye);var Oe=l(ye,2),ot=l(a(Oe),2);pe(ot),t(Oe);var Ze=l(Oe,2),Xe=l(a(Ze),2),ke=a(Xe),ht=l(a(ke),2);pe(ht),t(ke);var wt=l(ke,2),Mt=l(a(wt),2);pe(Mt),t(wt);var xt=l(wt,2),Dt=l(a(xt),2);_t(Dt),t(xt),t(Xe),t(Ze),t(ue),oe(rt,()=>e(n).name,we=>(e(n).name=we,Be(()=>e(g)))),oe(je,()=>e(n).role,we=>(e(n).role=we,Be(()=>e(g)))),i("click",bt,()=>K(H)),oe(ot,()=>e(n).image,we=>(e(n).image=we,Be(()=>e(g)))),oe(ht,()=>e(n)._alternativeNamesString,we=>(e(n)._alternativeNamesString=we,Be(()=>e(g)))),oe(Mt,()=>e(n)._tagsString,we=>(e(n)._tagsString=we,Be(()=>e(g)))),oe(Dt,()=>e(n).description,we=>(e(n).description=we,Be(()=>e(g)))),p(d,ue)});var vt=l(St,2);t(lt);var At=l(lt,4),Tt=a(At);Ue(Tt,1,()=>e(o),We,(d,n,H)=>{var ue=dl(),ye=a(ue),Le=a(ye),rt=l(a(Le),2);pe(rt),t(Le);var nt=l(Le,2);t(ye);var je=l(ye,2),bt=l(a(je),2);_t(bt),t(je);var Oe=l(je,2),ot=l(a(Oe),2);pe(ot),t(Oe);var Ze=l(Oe,2),Xe=l(a(Ze),2);pe(Xe),t(Ze),t(ue),oe(rt,()=>e(n).chapterSE,ke=>(e(n).chapterSE=ke,Be(()=>e(o)))),i("click",nt,()=>Y(H)),oe(bt,()=>e(n).description,ke=>(e(n).description=ke,Be(()=>e(o)))),oe(ot,()=>e(n)._tagsText,ke=>(e(n)._tagsText=ke,Be(()=>e(o)))),oe(Xe,()=>e(n).characters,ke=>(e(n).characters=ke,Be(()=>e(o)))),p(d,ue)});var Et=l(Tt,2);t(At),t(le);var $t=l(le,2),ut=a($t),st=l(ut,2);t($t),t(f),t(X),ee(()=>{ce(re,w()!==null?"Edit Entry":"New Entry"),ce(Bt,` ${e(S)??""} - ${se(Xt),e(S),M(()=>Xt[e(S)])??""}`),st.disabled=!e(u)||!e(O)||e(J)}),i("click",te,V),oe(ne,()=>e(u),d=>s(u,d)),oe(F,()=>e(q),d=>s(q,d)),oe(Se,()=>e(W),d=>s(W,d)),oe(Te,()=>e(R),d=>s(R,d)),oe(Ee,()=>e(U),d=>s(U,d)),oe(Z,()=>e(_),d=>s(_,d)),aa(Qe,()=>e(O),d=>s(O,d)),oe(at,()=>e(S),d=>s(S,d)),i("click",vt,j),i("click",Et,B),i("click",ut,V),i("click",st,Q),i("click",f,Ke(function(d){tt.call(this,c,d)})),i("click",X,V),p(k,X),Pe(),E()}var ul=h('<div class="absolute -top-1 left-0 right-0 h-[2px] bg-primary rounded"></div>'),bl=h('<div class="absolute -bottom-1 left-0 right-0 h-[2px] bg-primary rounded"></div>'),pl=h('<input class="input input-sm input-bordered flex-1 mr-2"/>'),gl=h('<span class="truncate cursor-pointer"> </span>'),fl=h('<button class="btn btn-sm btn-success">Save</button>'),ml=h('<button class="btn btn-xs btn-info">Edit</button> <button class="btn btn-xs btn-error">Delete</button>',1),hl=h('<div class="flex gap-2"><!></div>'),wl=h("<li><!> <!> <!> <!></li>"),xl=h(`<div class="fixed inset-0 z-150 flex bg-black/50" role="button" tabindex="0" aria-label="Close categories modal"><div class="h-full w-96 bg-base-100 p-6 shadow-xl flex flex-col" role="document"><h2 class="mb-6 text-2xl font-bold">Categories</h2> <div class="flex-1 overflow-y-auto pr-1 border border-base-content/30 rounded-xl p-1 px-2"><ul class="mb-4"></ul></div> <div class="flex gap-2 mt-3"><input class="input-bordered input flex-1" placeholder="New category"/> <button aria-label="Add new category" class="btn btn-primary">Add</button></div> <button class="btn btn-soft mt-2 w-full">Close</button> <div class="mt-1 px-1 text-xs justify-center text-success"><span> </span></div> <div class="my-2 alert alert-default alert-soft "><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>When a category is <b>deleted</b>, all entries in that category are <b>moved to the 'All'</b> category</span></div></div></div>`);function _l(k,c){Ge(c,!1);const T=()=>Ce(He,"$categories",C),[C,E]=ft();let $=ge(c,"show",8,!1);const w=gt();let D=m(""),u=m(null),q=m("");function W(f){s(u,f),s(q,f)}async function R(f){const b=e(q).trim();if(!b||b==="All"||b===f){s(u,null);return}await He.rename(f,b),w("rename",{old:f,new:b}),s(u,null),O(`Category renamed to "${b}"`)}async function U(){const f=e(D).trim();!f||f==="All"||(await He.add(f),s(D,""))}let S=m(""),_=m(!1);function O(f,b=2e3){s(S,f),s(_,!0),setTimeout(()=>{s(_,!1)},b)}async function J(f){f!=="All"&&(await be.moveCategoryToAll(f),await He.remove(f),O(`Category "${f}" deleted. Entries moved to 'All'.`))}Ot(()=>{He.load()});let v=m(null),g=m(null),o=m(null);function j(f,b){s(v,b),f.dataTransfer?.setData("text/plain",b),f.dataTransfer.effectAllowed="move"}function K(){s(v,null)}function B(){s(v,null),s(g,null),s(o,null)}async function Y(f,b){if(f.preventDefault(),!e(v)||e(v)===b){B();return}const z=T().filter(le=>le!=="All"),re=z.indexOf(e(v));let te=z.indexOf(b);e(o)==="below"&&(te+=1),z.splice(re,1),z.splice(te>re?te-1:te,0,e(v)),await be.reorderCategories(z),await He.load(),B()}Ve();var Q=Lt(),V=it(Q);{var X=f=>{var b=xl(),z=a(b),re=l(a(z),2),te=a(re);Ue(te,5,()=>(T(),M(()=>["All",...T().filter(de=>de!=="All")])),We,(de,F)=>{var ie=wl(),ve=a(ie);{var Se=x=>{var Z=ul();p(x,Z)};L(ve,x=>{e(g)===e(F)&&e(o)==="above"&&x(Se)})}var _e=l(ve,2);{var Je=x=>{var Z=bl();p(x,Z)};L(_e,x=>{e(g)===e(F)&&e(o)==="below"&&x(Je)})}var Te=l(_e,2);{var Ae=x=>{var Z=pl();pe(Z),ba(Z),oe(Z,()=>e(q),fe=>s(q,fe)),i("keydown",Z,fe=>fe.key==="Enter"&&R(e(F))),i("blur",Z,()=>R(e(F))),p(x,Z)},Ie=x=>{var Z=gl(),fe=a(Z,!0);t(Z),ee(()=>ce(fe,e(F))),i("dblclick",Z,()=>W(e(F))),p(x,Z)};L(Te,x=>{e(u)===e(F)?x(Ae):x(Ie,!1)})}var Ee=l(Te,2);{var $e=x=>{var Z=hl(),fe=a(Z);{var Qe=Me=>{var De=fl();i("click",De,Ke(()=>R(e(F)))),p(Me,De)},Ye=Me=>{var De=ml(),qe=it(De),Re=l(qe,2);i("click",qe,Ke(()=>W(e(F)))),i("click",Re,Ke(()=>J(e(F)))),p(Me,De)};L(fe,Me=>{e(u)===e(F)?Me(Qe):Me(Ye,!1)})}t(Z),p(x,Z)};L(Ee,x=>{e(F)!=="All"&&x($e)})}t(ie),ee(()=>{Ne(ie,1,`mb-2 flex items-center justify-between cursor-grab active:cursor-grabbing 
			         transition-all duration-150 rounded-lg p-1
			         ${e(v)===e(F)?"bg-primary/20 border border-primary shadow-md scale-[1.02]":"hover:bg-base-200"}`),pt(ie,"draggable",e(F)!=="All")}),i("dragstart",ie,x=>j(x,e(F))),i("dragend",ie,K),i("dragover",ie,ya(function(x){tt.call(this,c,x)})),i("drop",ie,x=>Y(x,e(F))),p(de,ie)}),t(te),t(re);var le=l(re,2),N=a(le);pe(N);var ae=l(N,2);t(le);var ne=l(le,2),I=l(ne,2),y=a(I),G=a(y,!0);t(y),t(I),ze(2),t(z),t(b),ee(()=>{la(I,`min-height: 1.55rem; max-height: 1.55rem; visibility: ${e(_)?"visible":"hidden"}`),ce(G,e(S))}),oe(N,()=>e(D),de=>s(D,de)),i("click",ae,U),i("click",ne,()=>w("close")),i("click",z,Ke(function(de){tt.call(this,c,de)})),i("click",b,()=>w("close")),p(f,b)};L(V,f=>{$()&&f(X)})}p(k,Q),Pe(),E()}var yl=h('<li><input type="radio" name="theme-dropdown" class="theme-controller btn btn-sm btn-block btn-ghost justify-start"/></li>'),kl=h('<div><div tabindex="0" role="button" class="btn p-2 m-0 rounded-2xl">üé® <svg width="12px" height="12px" class="inline-block h-1 w-1 fill-current opacity-60" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048"><path d="M1799 349l242 241-1017 1017L7 590l242-241 775 775 775-775z"></path></svg></div> <ul tabindex="-1" class="dropdown-content menu bg-base-300 rounded-2xl z-150 w-52 p-2 shadow-sm"></ul></div>');function Cl(k,c){Ge(c,!1);const T=()=>Ce(Kt,"$theme",C),[C,E]=ft(),$=["light","cupcake","night","dark","emerald","fantasy","luxury","acid","coffee","retro","business","dracula","dim","garden"];let w=ge(c,"dropdownDirection",8,"dropdown-end");function D(W){Kt.set(W)}Ve();var u=kl(),q=l(a(u),2);Ue(q,5,()=>$,We,(W,R)=>{var U=yl(),S=a(U);pe(S),t(U),ee(()=>{pt(S,"aria-label",e(R)),ka(S,e(R)),Ca(S,T()===e(R))}),i("change",S,()=>D(e(R))),p(W,U)}),t(q),t(u),ee(()=>Ne(u,1,`dropdown ${w()}`)),p(k,u),Pe(),E()}var Sl=h('<span class="absolute -top-6 -left-2 flex h-5 w-20 items-center justify-center rounded-full bg-red-600 text-xs font-bold text-white p-1"> </span>'),Al=h('<li><button class="w-full border border-base-300 text-left hover:bg-base-200"> </button></li>'),Tl=h('<ul class="dropdown-content menu mt-3 w-52 rounded-box bg-base-100 p-2 shadow-md"></ul>'),El=h('<div class="fixed top-16 left-1/2 z-50 flex items-center gap-4 rounded-lg border border-base-300 bg-base-100 p-2 shadow-md select-none"><div role="button" tabindex="0" class="cursor-grab rounded-md bg-base-200 p-2 hidden md:inline-block" aria-label="Drag toolbar">‚†ø</div> <div class="md:tooltip" data-tip="Delete"><button class="btn relative btn-square btn-error" aria-label="Delete selected"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 7h12M10 11v6m4-6v6M5 7l1 12a2 2 0 002 2h8a2 2 0 002-2l1-12M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3"></path></svg> <!></button></div> <div class="md:tooltip" data-tip="Select all"><button class="btn btn-square btn-ghost" aria-label="Select all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7M5 7l4 4L19 1"></path></svg></button></div> <div class="md:tooltip" data-tip="Deselect all"><button class="btn btn-square opacity-50 btn-ghost" aria-label="Deselect all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current opacity-20"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7M5 7l4 4L19 1"></path></svg></button></div> <div><div class="md:tooltip" data-tip="Move to category"><button class="btn btn-square btn-ghost" aria-label="Move to category"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4h16v4H4V4zm0 8h16v4H4v-4zm0 8h16v4H4v-4z"></path></svg></button></div> <!></div> <div class="md:tooltip" data-tip="Cancel"><button class="btn btn-square bg-red-700 text-white btn-ghost hover:bg-red-500" aria-label="Cancel selection"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div role="button" tabindex="0" class="drag-handle cursor-grab rounded-md bg-base-200 p-2" aria-label="Drag toolbar">‚†ø</div></div>');function $l(k,c){Ge(c,!1);let T=ge(c,"selectedCount",8,0),C=ge(c,"categoryList",24,()=>[]),E=ge(c,"showCategoryDropdown",8,!1);const $=gt();let w=!1,D=0,u=0,q=m(0),W=m(0);function R(N){w=!0,D=N.clientX-e(q),u=N.clientY-e(W),window.addEventListener("pointermove",U),window.addEventListener("pointerup",S)}function U(N){w&&(s(q,N.clientX-D),s(W,N.clientY-u))}function S(){w=!1,window.removeEventListener("pointermove",U),window.removeEventListener("pointerup",S)}Ve();var _=El(),O=a(_),J=l(O,2),v=a(J),g=l(a(v),2);{var o=N=>{var ae=Sl(),ne=a(ae,!0);t(ae),ee(()=>ce(ne,T())),p(N,ae)};L(g,N=>{T()>0&&N(o)})}t(v),t(J);var j=l(J,2),K=a(j);t(j);var B=l(j,2),Y=a(B);t(B);var Q=l(B,2);let V;var X=a(Q),f=a(X);t(X);var b=l(X,2);{var z=N=>{var ae=Tl();Ue(ae,5,C,We,(ne,I)=>{var y=Al(),G=a(y),de=a(G,!0);t(G),t(y),ee(()=>ce(de,e(I))),i("click",G,()=>$("moveCategory",e(I))),p(ne,y)}),t(ae),p(N,ae)};L(b,N=>{se(E()),se(C()),M(()=>E()&&C().length>0)&&N(z)})}t(Q);var re=l(Q,2),te=a(re);t(re);var le=l(re,2);t(_),ee(()=>{la(_,`transform: translate(calc(-50% + ${e(q)??""}px), ${e(W)??""}px);`),v.disabled=T()===0,V=Ne(Q,1,"dropdown dropdown-end",null,V,{"dropdown-open":E()}),f.disabled=T()===0}),i("pointerdown",O,R),i("click",v,()=>$("delete")),i("click",K,()=>$("selectAll")),i("click",Y,()=>$("deselectAll")),i("click",f,()=>$("toggleCategoryDropdown")),i("click",te,()=>$("cancel")),i("pointerdown",le,R),p(k,_),Pe()}var Ml=Ft('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4h16v16H4V4z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M8 12h8"></path></svg>'),Dl=Ft('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2"><rect x="4" y="4" width="16" height="16" stroke="currentColor" stroke-width="2"></rect><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h8"></path></svg>'),jl=h('<button><div class="indicator"><span class="indicator-item bg-base-100 text-xs rounded-3xl px-1.5 py-0.5 -top-1"> </span> <div class="z-10"> </div></div></button>'),Nl=h('<div class="flex items-center justify-center"><span class="loading loading-dots loading-sm text-primary"></span> <span class="loading loading-ring loading-sm text-primary"></span> <span class="loading loading-dots loading-sm text-primary"></span></div>'),Il=h('<div class="flex items-center justify-center"><span class="loading loading-bars loading-sm text-primary"></span></div>'),Ll=h('<div class="flex h-screen flex-col"><div class="navbar bg-base-100 shadow-lg"><div class="flex-none"><button class="btn btn-square btn-ghost" aria-label="Open menu"><!></button></div> <div class="flex-1"><span class="text-md md:text-xl font-bold"> <span class="hide-on-320 svelte-j9gjs9"> </span></span></div> <div class="flex-none"><button class="btn btn-square btn-ghost" aria-label="Toggle search"><!></button> <div class="tooltip-bottom tooltip" data-tip="Open filters"><button class="btn btn-square btn-ghost" aria-label="Open filters"><!></button></div> <div class="tooltip-bottom tooltip" data-tip="Select entries"><button class="btn btn-square btn-ghost" aria-label="Select entries"><!></button></div> <button class="btn btn-square btn-ghost inline-block md:hidden" aria-label="Toggle grid columns" title="Toggle grid columns"><!></button> <!></div></div> <!> <div class="tabs tabs-border flex-nowrap gap-3 overflow-x-auto bg-base-200 px-2 pt-2 pb-1 scrollbar-hide"><button class="p-0 m-0" title="Toggle unique entries" aria-label="Show unique entries only"><!></button> <button><div class="z-10">All</div> <span class="bg-base-100 text-xs rounded-3xl px-1.5 py-0.5"> </span></button> <!></div> <button class="z-100 btn fixed right-6 bottom-6 btn-circle shadow-xl btn-lg btn-primary" aria-label="Add new entry"><!></button> <!>  <div class="flex-1 overflow-auto p-4"><!> <!> <!></div></div> <!> <!> <!> <!> <!> <!>',1);function Ol(k,c){Ge(c,!1);const T=()=>Ce(Fe,"$searchQuery",u),C=()=>Ce(Sa,"$filteredEntries",u),E=()=>Ce(kt,"$selectedCategory",u),$=()=>Ce(He,"$categories",u),w=()=>Ce(Jt,"$entries",u),D=()=>Ce(ta,"$gridCols",u),[u,q]=ft(),W=m(),R=m();let U=m(!1),S=m(!1),_=m(!1),O=m(!1),J=m(null),v=m(null),g=m(!1),o=m(new Set),j=m(!1);const K=gt();let B=m(!1),Y=m(!1),Q=m(""),V=m(!1);function X(){ta.update(r=>r===3?4:3)}async function f(){const r=await be.getAllEntries();Jt.set(r),Array.from(new Set(r.map(A=>A.category).filter(A=>A&&A!=="All"))),He.load()}Ot(async()=>{await f(),$a();const r=localStorage.getItem("selectedCategory");r&&kt.set(r)});function b(){s(J,null),s(O,!0),s(j,!1)}async function z(){s(O,!1),s(J,null),await f()}function re(){s(O,!1),s(J,null)}async function te(){s(_,!1),s(v,null),await f()}function le(){s(_,!1),s(v,null)}let N;function ae(r){s(Q,r),s(V,!0),clearTimeout(N),N=window.setTimeout(()=>{s(V,!1)},1500)}let ne=m(!1);async function I(r){s(ne,!0),await be.importFromJSON(r),await f(),s(ne,!1),s(S,!1)}async function y(){const r=await be.exportToJSON(),A=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),xe=URL.createObjectURL(A),me=document.createElement("a");me.href=xe,me.download=`lib-export-${new Date().toISOString()}.json`,document.body.appendChild(me),me.click(),document.body.removeChild(me),URL.revokeObjectURL(xe),s(S,!1),ae("Exported to JSON üëç :Downloads/")}async function G(){const r=await be.exportToMarkdown(),A=new Blob([r],{type:"text/markdown"}),xe=URL.createObjectURL(A),me=document.createElement("a");me.href=xe,me.download=`lib-export-${new Date().toISOString()}.md`,document.body.appendChild(me),me.click(),document.body.removeChild(me),URL.revokeObjectURL(xe),s(S,!1),ae("Exported to Markdown üëç :Downloads/")}async function de(r){await be.moveCategoryToAll(r),E()===r&&kt.set("All"),await f(),s(g,!1)}let F=m(!1);async function ie(r){for(const xe of e(o))w().find(jt=>jt.id===xe)&&await be.updateEntry(xe,{category:r});e(o).clear(),s(o,new Set(e(o))),s(j,!1);const A=await be.getAllEntries();Jt.set(A),s(F,!1)}function ve(r){e(o).has(r)?e(o).delete(r):e(o).add(r),s(o,new Set(e(o)))}let Se=m(!1);async function _e(){if(e(o).size===0)return;s(Se,!0);const r=Array.from(e(o));for(const A of r)await be.deleteEntry(A);e(o).clear(),s(o,new Set(e(o))),await f(),s(j,!1),s(Se,!1)}function Je(){s(o,new Set(C().map(r=>r.id)))}function Te(){e(o).clear(),s(o,new Set(e(o)))}et(()=>T(),()=>{T().trim().length>0&&s(B,!0)}),et(()=>(e(Y),C(),ea),()=>{s(W,e(Y)?Array.from(new Map(C().map(r=>[ea(r),r])).values()):C())}),et(()=>$(),()=>{s(R,$().filter(r=>r!=="All"))}),Ht(),Ve();var Ae=Ll(),Ie=it(Ae),Ee=a(Ie),$e=a(Ee),x=a($e),Z=a(x);he(Z,()=>(se(P),M(()=>P.menu))),t(x),t($e);var fe=l($e,2),Qe=a(fe),Ye=a(Qe);Ye.nodeValue="Lib ";var Me=l(Ye),De=a(Me);t(Me),t(Qe),t(fe);var qe=l(fe,2),Re=a(qe),Bt=a(Re);he(Bt,()=>(se(P),M(()=>P.search))),t(Re);var dt=l(Re,2),at=a(dt),mt=a(at);he(mt,()=>(se(P),M(()=>P.filter))),t(at),t(dt);var ct=l(dt,2),lt=a(ct),St=a(lt);he(St,()=>(se(P),M(()=>P.select))),t(lt),t(ct);var vt=l(ct,2),At=a(vt);he(At,()=>(se(P),M(()=>P.toggleGrid))),t(vt);var Tt=l(vt,2);Cl(Tt,{dropdownDirection:"dropdown-bottom dropdown-end"}),t(qe),t(Ee);var Et=l(Ee,2);{var $t=r=>{Qa(r,{get show(){return e(B)},set show(A){s(B,A)},$$legacy:!0})};L(Et,r=>{e(B)&&r($t)})}var ut=l(Et,2),st=a(ut),d=a(st);{var n=r=>{var A=Ml();p(r,A)},H=r=>{var A=Dl();p(r,A)};L(d,r=>{e(Y)?r(n):r(H,!1)})}t(st);var ue=l(st,2);let ye;var Le=l(a(ue),2),rt=a(Le,!0);t(Le),t(ue);var nt=l(ue,2);Ue(nt,1,()=>e(R),We,(r,A)=>{var xe=jl();let me;var jt=a(xe),zt=a(jt),va=a(zt,!0);t(zt);var Pt=l(zt,2),ua=a(Pt,!0);t(Pt),t(jt),t(xe),ee(Ut=>{me=Ne(xe,1,"tab",null,me,{"tab-active":E()===e(A)}),ce(va,Ut),ce(ua,e(A))},[()=>(w(),e(A),M(()=>w().filter(Ut=>Ut.category===e(A)).length))]),i("click",xe,()=>kt.set(e(A))),p(r,xe)}),t(ut);var je=l(ut,2),bt=a(je);he(bt,()=>(se(P),M(()=>P.add))),t(je);var Oe=l(je,2);{var ot=r=>{$l(r,{get selectedCount(){return e(o),M(()=>e(o).size)},get categoryList(){return e(R)},get showCategoryDropdown(){return e(F)},$$events:{delete:_e,selectAll:Je,deselectAll:Te,toggleCategoryDropdown:()=>s(F,!e(F)),moveCategory:A=>ie(A.detail),cancel:()=>{s(j,!1),s(F,!1),e(o).clear(),s(o,new Set(e(o)))}}})};L(Oe,r=>{e(j)&&r(ot)})}var Ze=l(Oe,2),Xe=a(Ze);{var ke=r=>{var A=Nl();p(r,A)};L(Xe,r=>{e(Se)&&r(ke)})}var ht=l(Xe,2);{var wt=r=>{var A=Il();p(r,A)};L(ht,r=>{e(ne)&&r(wt)})}var Mt=l(ht,2);Ra(Mt,{get entries(){return e(W)},get selectionMode(){return e(j)},get selectedEntries(){return e(o)},get gridCols(){return D()},$$events:{toggleSelect:r=>ve(r.detail)}}),t(Ze),t(Ie);var xt=l(Ie,2);{var Dt=r=>{Za(r,{get show(){return e(U)},set show(A){s(U,A)},$$legacy:!0})};L(xt,r=>{e(U)&&r(Dt)})}var we=l(xt,2);{var na=r=>{ll(r,{get importing(){return e(ne)},get show(){return e(S)},set show(A){s(S,A)},$$events:{import:A=>I(A.detail),export:y,exportMd:G,showCategories:()=>{s(S,!1),s(g,!0)}},$$legacy:!0})};L(we,r=>{e(S)&&r(na)})}var Wt=l(we,2);{var oa=r=>{_l(r,{get show(){return e(g)},$$events:{close:()=>s(g,!1),rename:A=>K("renameCategory",A.detail),delete:A=>de(A.detail)}})};L(Wt,r=>{e(g)&&r(oa)})}var Vt=l(Wt,2);{var ia=r=>{Aa(r,{get entryId(){return e(v)},$$events:{save:te,cancel:le}})};L(Vt,r=>{e(_)&&r(ia)})}var Gt=l(Vt,2);{var da=r=>{vl(r,{get entryId(){return e(J)},$$events:{save:z,cancel:re}})};L(Gt,r=>{e(O)&&r(da)})}var ca=l(Gt,2);ra(ca,{get showAlert(){return e(V)},get message(){return e(Q)}}),ee(()=>{ce(De,`(${w(),M(()=>w().length)??""})`),ye=Ne(ue,1,"tab relative",null,ye,{"tab-active":E()==="All"}),ce(rt,(w(),M(()=>w().length)))}),i("click",x,()=>s(S,!0)),i("click",Re,()=>{s(B,!e(B)),s(j,!1)}),i("click",at,()=>{s(U,!e(U)),s(j,!1)}),i("click",lt,()=>{e(j)&&(e(o).clear(),s(o,new Set(e(o))),s(F,!1)),s(j,!e(j))}),i("click",vt,X),i("click",st,()=>s(Y,!e(Y))),i("click",ue,()=>kt.set("All")),i("click",je,b),p(k,Ae),Pe(),q()}function Vl(k){fa("1uha8ag",c=>{pa(()=>{ga.title="lib"})}),Ol(k,{})}export{Vl as component};
