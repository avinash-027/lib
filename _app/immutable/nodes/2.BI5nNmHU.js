import{c as wt,a as k,f as M,d as Zt}from"../chunks/DIo1Mb-Q.js";import{i as Le}from"../chunks/BaBAM0Xm.js";import{h as Rt,D as Be,E as qe,G as Oe,z as K,u as J,I as a,K as l,y as e,J as t,F as Z,aP as ia,aT as mt,aU as Xt,W as s,V as T,aN as da,ax as Me,aY as pt,aZ as Ne,a_ as ca,e as va,aW as ua}from"../chunks/BKQwOs6K.js";import{h as ba}from"../chunks/B3mhA-Ep.js";import{d as pa,w as Nt,c as ot,g as ga,o as Jt}from"../chunks/Ou4Y_0Z5.js";import{s as oe,e as d,r as fa}from"../chunks/UijS7mQC.js";import{p as me,i as z,a as $e,s as it}from"../chunks/BezKbsVq.js";import{t as ma,d as se,e as Ie,k as De,c as ha,s as xt,j as fe,S as F,r as de,l as te,m as Kt,a as Pe,b as Qe,h as Qt,g as wa,i as Ue,n as Wt,R as Pt,o as We,f as xa,p as Vt,q as Gt,E as _a}from"../chunks/uHcNKebj.js";import{g as ya,b as ka}from"../chunks/CyTIuLfi.js";import{b as Ot}from"../chunks/DEv7LI8C.js";function ea(f,n,i,p){var h=f.__style;if(Rt||h!==n){var c=ma(n);(!Rt||c!==f.getAttribute("style"))&&(c==null?f.removeAttribute("style"):f.style.cssText=c),f.__style=n}return p}function Ca(){const{subscribe:f,set:n,update:i}=Nt([]);return{subscribe:f,set:n,update:i,load:async()=>{const p=await se.getAllEntries();return n(p),p},add:async p=>{const h=await se.addEntry(p);i(c=>[...c,{...p,id:h}])},updateEntry:async(p,h)=>{await se.updateEntry(p,h),i(c=>c.map(w=>w.id===p?{...w,...h}:w))},deleteEntry:async p=>{await se.deleteEntry(p),i(h=>h.filter(c=>c.id!==p))}}}const jt=Ca(),Ee=Nt(""),Je=Nt("default"),nt=It("libsettings:selectedCategory","All"),gt=It("libsettings:sortField","createdAt"),ft=It("libsettings:sortOrder","desc"),Yt=It("lib:gridCols",4),Sa=pa([jt,nt,Ee,Je,gt,ft],([f,n,i,p,h,c])=>{let w=[...f];if(n!=="All"&&(w=w.filter(b=>b.category===n)),i){const b=i.toLowerCase();w=w.filter(u=>{switch(p){case"a":return u.alternativeTitles.join(" ").toLowerCase().includes(b);case"t":return u.tags.join(" ").toLowerCase().includes(b);case"b":return u.badges.join(" ").toLowerCase().includes(b);case"c":return u.characters.map(j=>j.Name).join(" ").toLowerCase().includes(b);case"d":return u.dataType.toLowerCase().includes(b);default:return u.title.toLowerCase().includes(b)||u.alternativeTitles.join(" ").toLowerCase().includes(b)}})}return w=w.sort((b,u)=>{const j=b[h]??"",I=u[h]??"";return c==="asc"?j>I?1:-1:j<I?1:-1}),w});function It(f,n){const i=localStorage.getItem(f),{subscribe:p,set:h,update:c}=Nt(i?JSON.parse(i):n);return{subscribe:p,set:w=>{localStorage.setItem(f,JSON.stringify(w)),h(w)},update:w=>{c(b=>{const u=w(b);return localStorage.setItem(f,JSON.stringify(u)),u})}}}let ht=null;async function Aa(){try{const i=await window.showDirectoryPicker()}catch(i){console.error("Failed to open directory picker",i),alert("Cannot open folder in this browser. Try Edge or Chrome.")}const f={mode:"readwrite"};await dirHandle.queryPermission(f)!=="granted"&&await dirHandle.requestPermission(f);const n=(await se.getDB()).transaction("settings","readwrite");await n.objectStore("settings").put(dirHandle,"backupDirHandle"),await n.objectStore("settings").put(dirHandle.name,"backupFolderName"),await n.done,localStorage.setItem("autoBackupEnabled","true"),Ut(dirHandle),await ta(dirHandle)}function Ta(){localStorage.removeItem("autoBackupEnabled"),localStorage.removeItem("autoBackupDirHandle"),localStorage.removeItem("autoBackupFolderName"),ht&&clearTimeout(ht)}async function Ea(){if(localStorage.getItem("autoBackupEnabled")!=="true")return;const n=await(await se.getDB()).get("settings","backupDirHandle");n&&Ut(n)}async function ta(f){const n=await se.exportToJSON(),p=await(await f.getFileHandle("lib-autobackup.json",{create:!0})).createWritable();await p.write(JSON.stringify(n,null,2)),await p.close(),console.log("‚úÖ Auto backup saved at",new Date().toLocaleString())}function Ut(f){ht&&clearTimeout(ht);const n=new Date,i=new Date;i.setHours(12,0,0,0);const p=new Date;p.setHours(24,0,0,0);let h;n<i?h=i:h=p;const c=h.getTime()-n.getTime();ht=window.setTimeout(async()=>{await f.queryPermission({mode:"readwrite"})==="granted"&&await ta(f),Ut(f)},c)}function Ma(f){const n=new IntersectionObserver(([i],p)=>{if(i.isIntersecting){const h=f.dataset.src;h&&(f.src=h),f.classList.add("lozad-loaded"),p.unobserve(f)}});return n.observe(f),{destroy(){n.unobserve(f)}}}var $a=M('<div class="px-1 w-full opacity-80 text-sm h-65 md:h-55 flex items-end justify-center text-base-content/50"><div>No entries found. <ul class="list-disc list-inside mt-1"><li>Add new entries by clicking the <b>"+"</b> button.</li> <li>To Manage categories, click the "Categories" button in the <b>Drawer Menu</b>.</li></ul></div></div>'),ja=M('<button type="button"><!></button>'),Na=M('<img class="w-full h-full object-cover lozad"/>'),Ia=M('<div class="w-full h-full flex items-center justify-center text-base-content/20"><!></div>'),Da=M('<span class="absolute top-1 right-1 rounded-2xl text-[.84em] md:text-sm bg-base-200 px-1 py-0"> </span>'),La=M('<span class="absolute top-1.5 left-1 rounded-2xl text-xs md:text-sm bg-info text-base-300 px-1 py-0 font-semibold"> </span>'),Ba=M('<div class="relative"><!> <button class="card bg-base-100 shadow-xl cursor-pointer hover:shadow-2xl transition-shadow w-full h-full"><figure class="aspect-[3/4] bg-base-300"><!></figure> <div class="card-body p-2"><!> <!> <h3 class="card-title text-xs sm:text-sm line-clamp-2"> </h3></div></button></div>'),Oa=M("<div></div>");function Ja(f,n){Be(n,!1);let i=me(n,"entries",24,()=>[]),p=me(n,"selectionMode",8,!1),h=me(n,"selectedEntries",24,()=>new Set),c=me(n,"gridCols",8,4);const w=ot();function b(C){!p()&&C!==void 0&&ya(`${ka}/detail/${C}`)}function u(C){w("toggleSelect",C)}const j={2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5"};Le();var I=wt(),$=qe(I);{var D=C=>{var S=$a();k(C,S)},L=C=>{var S=Oa();Ie(S,5,i,x=>x.id,(x,_)=>{var P=Ba(),y=a(P);{var g=v=>{var E=ja();let G;var ce=a(E);{var ve=Q=>{var ee=wt(),H=qe(ee);fe(H,()=>(K(F),J(()=>F.selectTick))),k(Q,ee)},le=ia(()=>(K(h()),e(_),J(()=>h().has(e(_).id))));z(ce,Q=>{e(le)&&Q(ve)})}t(E),Z(Q=>G=De(E,1,"rounded-xl absolute inset-0 z-10 flex items-center justify-center bg-black/20 cursor-pointer transition-opacity",null,G,Q),[()=>({selected:h().has(e(_).id)})]),d("click",E,Q=>{Q.stopPropagation(),u(e(_).id)}),k(v,E)};z(y,v=>{p()&&v(g)})}var N=l(y,2),O=a(N),R=a(O);{var U=v=>{var E=Na();ha(E,G=>Ma?.(G)),Z(()=>{xt(E,"src",(e(_),J(()=>e(_).coverImageUrl))),xt(E,"alt",(e(_),J(()=>e(_).title)))}),fa(E),k(v,E)},Y=v=>{var E=Ia(),G=a(E);fe(G,()=>(K(F),J(()=>F.imgIcon))),t(E),k(v,E)};z(R,v=>{e(_),J(()=>e(_).coverImageUrl)?v(U):v(Y,!1)})}t(O);var A=l(O,2),W=a(A);{var re=v=>{var E=Da(),G=a(E,!0);t(E),Z(()=>oe(G,(e(_),J(()=>e(_).dataType)))),k(v,E)};z(W,v=>{e(_),J(()=>e(_).dataType)&&v(re)})}var ae=l(W,2);{var X=v=>{var E=La(),G=a(E,!0);t(E),Z(()=>oe(G,(e(_),J(()=>e(_).rating)))),k(v,E)};z(ae,v=>{e(_),J(()=>e(_).rating!==null&&e(_).rating>0)&&v(X)})}var ne=l(ae,2),V=a(ne,!0);t(ne),t(A),t(N),t(P),Z(()=>oe(V,(e(_),J(()=>e(_).title)))),d("click",N,()=>b(e(_).id)),k(x,P)}),t(S),Z(()=>De(S,1,(K(c()),J(()=>`grid gap-2 ${j[c()]} md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10`)))),k(C,S)};z($,C=>{K(i()),J(()=>i().length===0)?C(D):C(L,!1)})}k(f,I),Oe()}var Ua=M("alternative titles <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),qa=M("tags <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),za=M("badges <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Ha=M("characters <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Fa=M('<div class="text-xs text-info mt-2">Searching in: <!> <!> <!> <!></div>'),Ra=M(`<div class="bg-base-200 px-4 pt-3 pb-1 shadow-lg"><div class="flex gap-2 items-center"><input type="text" placeholder="Search ('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)" class="input input-bordered flex-1"/> <button class="btn btn-square btn-ghost" aria-label="Close search"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <!></div>`);function Wa(f,n){Be(n,!1);const i=()=>$e(Je,"$searchMode",p),[p,h]=it();let c=me(n,"show",12,!1),w=T(""),b=T();async function u(){await da(),e(b)?.focus()}function j(){s(w,""),Ee.set(""),Je.set("default"),c(!1)}mt(()=>Ee,()=>{ga(Ee)&&c(!0)}),mt(()=>K(c()),()=>{c()&&u()}),mt(()=>(e(w),Ee),()=>{const x=e(w).trim(),_=x.toLowerCase();_.startsWith("a:")?(Je.set("a"),Ee.set(x.slice(2))):_.startsWith("t:")?(Je.set("t"),Ee.set(x.slice(2))):_.startsWith("b:")?(Je.set("b"),Ee.set(x.slice(2))):_.startsWith("c:")?(Je.set("c"),Ee.set(x.slice(2))):_.startsWith("d:")?(Je.set("d"),Ee.set(x.slice(2))):(Je.set("default"),Ee.set(x))}),Xt(),Le();var I=Ra(),$=a(I),D=a($);de(D),Ot(D,x=>s(b,x),()=>e(b));var L=l(D,2);t($);var C=l($,2);{var S=x=>{var _=Fa(),P=l(a(_));{var y=A=>{var W=Ua();Me(2),k(A,W)};z(P,A=>{i()==="a"&&A(y)})}var g=l(P,2);{var N=A=>{var W=qa();Me(2),k(A,W)};z(g,A=>{i()==="t"&&A(N)})}var O=l(g,2);{var R=A=>{var W=za();Me(2),k(A,W)};z(O,A=>{i()==="b"&&A(R)})}var U=l(O,2);{var Y=A=>{var W=Ha();Me(2),k(A,W)};z(U,A=>{i()==="c"&&A(Y)})}t(_),k(x,_)};z(C,x=>{i()!=="default"&&x(S)})}t(I),te(D,()=>e(w),x=>s(w,x)),d("click",L,j),k(f,I),Oe(),h()}var Pa=M('<div class="fixed inset-0 bg-black/50 z-150 flex items-end" role="presentation"><div class="bg-base-100 w-full rounded-t-2xl p-6 max-h-[80vh] overflow-auto" role="dialog" tabindex="-1"><h3 class="text-2xl font-bold mb-6">Sort & Filter</h3> <div class="form-control mb-4"><label class="label" for="sort-field"><span class="label-text font-semibold">Sort By</span></label> <select id="sort-field" class="select select-bordered w-full"><option>Title (A-Z)</option><option>Rating</option><option>Last Edited</option><option>Date Created</option><option>Last Opened</option></select></div> <div class="form-control mb-6"><label class="label" for="sort-order"><span class="label-text font-semibold">Order</span></label> <div class="flex gap-2"><button>Ascending</button> <button>Descending</button></div></div> <div class="flex gap-2"><button class="btn btn-outline flex-1">Reset</button> <button class="btn btn-primary flex-1">Apply</button></div></div></div>');function Va(f,n){Be(n,!1);const i=()=>$e(gt,"$sortField",h),p=()=>$e(ft,"$sortOrder",h),[h,c]=it();let w=me(n,"show",12,!1),b=T(i()),u=T(p());gt.subscribe(C=>s(b,C)),ft.subscribe(C=>s(u,C));function j(){gt.set(e(b)),ft.set(e(u)),w(!1)}function I(){s(b,"title"),s(u,"asc"),gt.set(e(b)),ft.set(e(u)),w(!1)}Le();var $=wt(),D=qe($);{var L=C=>{var S=Pa(),x=a(S),_=l(a(x),2),P=l(a(_),2),y=a(P);y.value=y.__value="title";var g=l(y);g.value=g.__value="rating";var N=l(g);N.value=N.__value="editedAt";var O=l(N);O.value=O.__value="createdAt";var R=l(O);R.value=R.__value="openedAt",t(P),t(_);var U=l(_,2),Y=l(a(U),2),A=a(Y);let W;var re=l(A,2);let ae;t(Y),t(U);var X=l(U,2),ne=a(X),V=l(ne,2);t(X),t(x),t(S),Z(()=>{W=De(A,1,"btn flex-1",null,W,{"btn-primary":e(u)==="asc"}),xt(A,"aria-pressed",e(u)==="asc"),ae=De(re,1,"btn flex-1",null,ae,{"btn-primary":e(u)==="desc"}),xt(re,"aria-pressed",e(u)==="desc")}),Kt(P,()=>e(b),v=>s(b,v)),d("click",A,()=>s(u,"asc")),d("click",re,()=>s(u,"desc")),d("click",ne,I),d("click",V,j),d("click",x,Pe(function(v){Qe.call(this,n,v)})),d("keydown",x,function(v){Qe.call(this,n,v)}),d("click",S,()=>w(!1)),d("keydown",S,function(v){Qe.call(this,n,v)}),k(C,S)};z(D,C=>{w()&&C(L)})}k(f,$),Oe(),c()}const Ga=`\`\`\`json\r
// Example\r
[\r
  {\r
    "id": 2,\r
    "title": "Solo Leveling",\r
    "alternativeTitles": [ "Only I Level Up", "Na Honja Level Up" ],\r
    "coverImageUrl": "https://example.com/covers/solo-leveling.jpg",\r
    "description": "In a world where gates connect Earth to deadly dungeons, the weakest hunter awakens a mysterious system that allows him to level up alone.",\r
    "badges": ["Manhwa", "Action", "Fantasy", "Completed"],\r
    "tags": [ "gates", "hunters", "dungeons", "system", "shadows", "awakening"],\r
    "rating": null,\r
    "createdAt": "2024-12-15T08:20:00.000Z",\r
    "openedAt": "2025-02-07T14:10:30.000Z",\r
    "editedAt": "2025-02-07T18:45:10.000Z",\r
    "characters": [\r
      {\r
        "Name": "Sung Jin-Woo",\r
        "Image": "https://example.com/characters/sung-jin-woo.png",\r
        "role": "Main",\r
        "alternativeNames": [ "Jinwoo"],\r
        "tags": ["MC", "Solo-Player"],\r
        "description": ""\r
      },\r
      {\r
        "Name": "Cha Hae-In",\r
        "role": "Main",\r
        "Image": "https://example.com/characters/cha-hae-in.png"\r
      },\r
      {\r
        "Name": "Go Gun-Hee",\r
        "role": "supporting",\r
        "Image": "https://example.com/characters/go-gun-hee.png"\r
      }\r
    ],\r
    "rows": [\r
      {\r
        "ChapterSE": "Episode 1 ‚Äì The Weakest Hunter",\r
        "Description": "E-rank hunter Sung Jin-Woo barely survives a low-level dungeon while struggling to pay his family‚Äôs medical bills.",\r
        "Tags": ["introduction", "low-rank", "desperation"],\r
        "Characters": "Sung Jin-Woo"\r
      },\r
      {\r
        "ChapterSE": "Episode 2 ‚Äì Double Dungeon",\r
        "Description": "A hidden dungeon reveals a deadly trial where survival depends on following cryptic rules.",\r
        "Tags": ["double-dungeon", "statues", "death"],\r
        "Characters": "Sung Jin-Woo, Dungeon Party"\r
      },\r
      {\r
        "ChapterSE": "Episode 3 ‚Äì The System",\r
        "Description": "After facing death, Jin-Woo awakens to a mysterious system that only he can see.",\r
        "Tags": ["awakening", "system", "rebirth"],\r
        "Characters": "Sung Jin-Woo"\r
      }\r
    ],\r
    "category": "Manhwa",\r
    "dataType": "json"\r
  },\r
  // ...\r
]\r
\`\`\``;var Ya=M('<div role="alert" class="fixed bottom-2 left-2 z-300 alert alert-info alert-outline bg-base-100"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>');function qt(f,n){let i=me(n,"showAlert",8,!1),p=me(n,"message",8,"");var h=wt(),c=qe(h);{var w=b=>{var u=Ya(),j=l(a(u),2),I=a(j,!0);t(j),t(u),Z(()=>oe(I,p())),k(b,u)};z(c,b=>{i()&&b(w)})}k(f,h)}var Za=M('<div class="text-xs text-gray-500 mt-1 pl-1"> <br/> ‚è∞ Every 12 hours (12:00 AM & 12:00 PM)</div>'),Xa=M('<button class="btn btn-md btn-ghost rounded-full flex justify-between py-3 px-0"><span>üïõ Auto Backup :</span> <input type="checkbox" class="toggle toggle-primary"/> </button> <!> <!>',1);function Ka(f,n){Be(n,!1);let i=T(localStorage.getItem("autoBackupEnabled")==="true"),p=T(localStorage.getItem("autoBackupFolderName")),h=T(!1),c=T("");async function w(){try{e(i)?(Ta(),s(i,!1),s(p,null),s(c,"Auto backup disabled")):(await Aa(),s(i,!0),s(p,localStorage.getItem("autoBackupFolderName")),s(c,"Auto backup enabled (12:00 AM & 12:00 PM)"))}catch{s(i,!1),s(c,"Backup permission denied")}s(h,!0),setTimeout(()=>s(h,!1),1500)}Le();var b=Xa(),u=qe(b),j=l(a(u),2);de(j);var I=l(j,1,!0);t(u);var $=l(u,2);{var D=C=>{var S=Za(),x=a(S);Me(2),t(S),Z(()=>oe(x,`üìÅ ${e(p)??""}/lib-autobackup.json`)),k(C,S)};z($,C=>{e(i)&&e(p)&&C(D)})}var L=l($,2);qt(L,{get showAlert(){return e(h)},get message(){return e(c)}}),Z(()=>{Qt(j,e(i)),oe(I,e(i)==!0?"On":"Off")}),d("click",u,w),k(f,b),Oe()}var Qa=M('<div class="fixed inset-0 bg-black/50 z-150 flex" role="presentation"><div class="bg-base-100 w-80 h-full shadow-xl p-6 flex flex-col justify-between" role="dialog" tabindex="-1"><div><h2 class="text-2xl font-bold mb-6">Menu <button class="float-right cursor-pointer" aria-label="Close menu" type="button"><!></button></h2> <ul class="menu bg-base-200 rounded-box gap-1 md:gap-3"><li><button aria-label="Import JSON" class="btn btn-md btn-ghost"><!> Import JSON</button></li> <li><button aria-label="Export data" class="btn btn-md btn-ghost"><!> Export JSON</button></li> <li><button class="btn btn-md btn-ghost" aria-label="Export Markdown"><!> Export Md</button></li> <li><button aria-label="Open categories" class="btn btn-md btn-ghost"><!> Categories</button></li> <li><button class="btn btn-md btn-ghost">JSON Format</button></li></ul></div> <dialog class="modal"><div class="modal-box max-w-3xl w-85 md:w-full h-auto max-h-[65vh]"><form method="dialog"><button type="button" aria-label="CloseJSONmodal" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 text-lg p-5"><!></button></form> <h3 class="font-bold mb-2">Import JSON Structure</h3> <div class="prose max-w-full overflow-auto text-sm"><!></div></div></dialog> <div class="text-sm text-gray-500"><!> <div class="divider"></div> <p class="font-semibold my-4">ü§ñ AI √ó <a href="https://github.com/avinash-027/" target="_blank" class="link link-primary no-underline">User-A027</a> üë®‚Äçüíª</p></div></div></div>'),el=M('<!> <!> <input type="file" accept=".json" class="hidden"/>',1);function tl(f,n){Be(n,!1);let i=me(n,"show",12,!1),p=T(""),h=T(!1);const c=ot();let w=T();function b(){e(w).click()}function u(y){const N=y.target.files?.[0];if(!N)return;const O=new FileReader;O.onload=R=>{try{const U=JSON.parse(R.target?.result),Y=Array.isArray(U)?U:[U];c("import",Y)}catch{s(p,"Invalid JSON file"),s(h,!0),setTimeout(()=>{s(h,!1)},2e3)}},O.readAsText(N)}function j(){c("export")}let I=wa.parse(Ga),$=T();function D(){e($).showModal()}function L(){e($).close()}Le();var C=el(),S=qe(C);qt(S,{get showAlert(){return e(h)},get message(){return e(p)}});var x=l(S,2);{var _=y=>{var g=Qa(),N=a(g),O=a(N),R=a(O),U=l(a(R)),Y=a(U);fe(Y,()=>(K(F),J(()=>F.circleClose))),t(U),t(R);var A=l(R,2),W=a(A),re=a(W),ae=a(re);fe(ae,()=>(K(F),J(()=>F.import))),Me(),t(re),t(W);var X=l(W,2),ne=a(X),V=a(ne);fe(V,()=>(K(F),J(()=>F.export))),Me(),t(ne),t(X);var v=l(X,2),E=a(v),G=a(E);fe(G,()=>(K(F),J(()=>F.export))),Me(),t(E),t(v);var ce=l(v,2),ve=a(ce),le=a(ve);fe(le,()=>(K(F),J(()=>F.category))),Me(),t(ve),t(ce);var Q=l(ce,2),ee=a(Q);t(Q),t(A),t(O);var H=l(O,2),ue=a(H),je=a(ue),Ae=a(je),be=a(Ae);fe(be,()=>(K(F),J(()=>F.circleClose))),t(Ae),t(je);var pe=l(je,4),Te=a(pe);fe(Te,()=>I),t(pe),t(ue),t(H),Ot(H,ie=>s($,ie),()=>e($));var ke=l(H,2),Ve=a(ke);Ka(Ve,{}),Me(4),t(ke),t(N),t(g),d("click",U,()=>i(!1)),d("click",re,b),d("click",ne,j),d("click",E,()=>c("exportMd")),d("click",ve,()=>c("showCategories")),d("click",ee,D),d("click",Ae,L),d("click",H,ie=>{ie.target===e($)&&L()}),d("click",N,Pe(function(ie){Qe.call(this,n,ie)})),d("keydown",N,Pe(function(ie){Qe.call(this,n,ie)})),d("click",g,()=>i(!1)),d("keydown",g,ie=>ie.key==="Escape"&&i(!1)),k(y,g)};z(x,y=>{i()&&y(_)})}var P=l(x,2);Ot(P,y=>s(w,y),()=>e(w)),d("change",P,u),k(f,C),Oe()}var al=M('<option class="border border-base-200"> </option>'),ll=M("<span>|</span>"),sl=M("<span> </span>"),rl=M('<div class="flex gap-2 flex-wrap mb-2 p-2 rounded-lg bg-base-200 border border-base-300"><div class="flex gap-2 w-full"><label class="floating-label w-full" for="charName"><span><span class="label-text">Name **</span></span> <input type="text" id="charName" placeholder="Name *" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charRole"><span><span class="label-text">Role</span></span> <input type="text" id="charRole" placeholder="role" class="input input-sm w-full"/></label> <button class="btn btn-sm btn-square btn-error btn-outline">‚úï</button></div> <label class="floating-label w-full" for="charImgUrl"><span><span class="label-text">Image URL</span></span> <input type="text" id="charImgUrl" placeholder="Img URL" class="input input-sm w-full"/></label> <details class="w-full mt-2"><summary class="cursor-pointer text-sm font-medium text-primary text-center">Extra Details</summary> <div class="space-y-2 mt-2"><label class="floating-label w-full" for="charAltNames"><span><span class="label-text">alternativeNames</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="charAltNames" placeholder="Alternative Names [Ex: Name01, name-01]" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charTags"><span><span class="label-text">char-Tags</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="charTags" placeholder="Tags [Ex: Hero, Villain]" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charDescription"><span><span class="label-text">Description</span></span> <textarea id="charDescription" placeholder="Description" class="textarea textarea-bordered w-full"></textarea></label></div></details></div>'),nl=M('<div class="card bg-base-200 border border-base-300 p-4"><div class="flex gap-2 mb-2"><label class="floating-label w-full"><span>Chapter *</span> <input type="text" placeholder="Chapter (e.g., 1-5)" class="input input-bordered w-full input-sm flex-1"/></label> <button class="btn btn-square btn-error btn-outline btn-sm"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-4 h-4 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <label class="floating-label w-full"><span>Description</span> <textarea placeholder="Description" class="textarea textarea-bordered w-full textarea-sm mb-2"></textarea></label> <label class="floating-label w-full"><span>Tags (comma separated)</span> <input type="text" placeholder="Tags (comma separated)" class="input input-bordered w-full input-sm mb-2"/></label> <label class="floating-label w-full"><span>Characters</span> <input type="text" placeholder="Characters" class="input input-bordered w-full input-sm"/></label></div>'),ol=M('<div class="fixed inset-0 bg-black/50 z-150 flex items-center justify-center p-4"><div class="bg-base-100 w-full max-w-4xl max-h-[90vh] overflow-auto rounded-lg shadow-xl"><div class="bg-base-100 border-b border-base-300 p-4 flex justify-between items-center"><h2 class="text-2xl font-bold"> </h2> <button class="btn btn-square btn-ghost btn-sm"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-6 space-y-4"><div class="form-control"><label for="newtitle" class="floating-label"><span>Title <span class="label-text-alt text-info italic">: required</span></span> <input id="newtitle" type="text" placeholder="Title" class="input input-bordered w-full" required=""/></label></div> <div class="form-control"><label for="newAltTitles" class="floating-label"><span><span class="label-text">Alternative Titles</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="newAltTitles" type="text" placeholder="Alternative Titles [Ex: Title1, Title2]" class="input input-bordered w-full"/></label></div> <div class="form-control"><label for="newCoverImg" class="floating-label"><span class="label-text">Cover Image URL</span> <input id="newCoverImg" type="text" placeholder="Cover Image URL: Web Img Link" class="input input-bordered w-full"/></label></div> <div class="form-control"><label class="floating-label"><span class="label-text">Description</span> <textarea placeholder="Description" class="textarea textarea-bordered w-full h-24"></textarea></label></div> <div class="form-control"><label for="newBadges" class="floating-label"><span><span class="label-text">Badges</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <textarea id="newBadges" placeholder="Badges [Ex: Completed, Ongoing, Author, Artist, Favorite]" class="textarea textarea-bordered w-full"></textarea></label></div> <div class="form-control"><label for="newTags" class="floating-label"><span><span class="label-text">Tags</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <textarea id="newTags" placeholder="Tags [Ex: Themes, Genres]" class="textarea textarea-bordered w-full"></textarea></label></div> <div class="form-control"><label class="floating-label"><span class="label-text font-semibold">Category</span></label> <select class="select select-bordered w-full"><option class="border border-base-content/20 hover:bg-base-200">All</option><!></select></div> <div class="form-control"><label class="flex flex-wrap gap-2 justify-between"><span><span class="label-text font-semibold">Rating <span class="text-info">(0‚Äì10)</span></span></span> <div class="text-xs md:text-sm text-info"><span class="font-semibold">Value:</span> </div></label> <div class="w-full max-w-xs"><input type="range" min="0" max="10" step="1" class="range range-xs range-info"/> <div class="flex justify-between px-2.5 mt-1 text-xs"></div> <div class="flex justify-between px-2.5 mt-1 text-xs"></div></div></div> <div class="divider">Characters</div> <div class="space-y-2"><!> <button class="btn btn-outline btn-sm">+ Add Character</button></div> <div class="divider">Chapters</div> <div class="space-y-2"><!> <button class="btn btn-outline btn-sm">+ Add Chapter</button></div></div> <div class="sticky bottom-0 bg-base-100 border-t border-base-300 p-4 flex gap-2 justify-end"><button class="btn btn-outline">Cancel</button> <button class="btn btn-primary">Save</button></div></div></div>');function il(f,n){Be(n,!1);const i=()=>$e(We,"$categories",p),[p,h]=it();let c=me(n,"entryId",8,null);const w=ot();let b=T(""),u=T(""),j=T(""),I=T(""),$=T(""),D=T(0),L=T(""),C=T("All"),S=T([]),x=T([]);Jt(async()=>{if(c()!==null){const m=await se.getEntryById(c());m&&(s(b,m.title),s(u,m.alternativeTitles.join(", ")),s(j,m.coverImageUrl||""),s(I,m.description),s($,m.badges.join(", ")),s(D,Number(m.rating)),s(L,m.tags.join(", ")),s(C,m.category),s(S,m.characters.map(o=>({...o,_alternativeNamesString:(o.alternativeNames??[]).join(", "),_tagsString:(o.tags??[]).join(", ")}))),s(x,m.rows.map(o=>({...structuredClone(o),_tagsText:o.tags.join(", ")}))))}});function _(){s(S,[...e(S),{Name:"",Image:"",role:"",alternativeNames:[],tags:[],description:"",_alternativeNamesString:"",_tagsString:""}])}function P(m){s(S,e(S).filter((o,q)=>q!==m))}function y(){s(x,[...e(x),{chapterSE:"",description:"",characters:"",_tagsText:""}])}function g(m){s(x,e(x).filter((o,q)=>q!==m))}async function N(){const m={title:e(b),alternativeTitles:e(u).split(",").map(o=>o.trim()).filter(Boolean),coverImageUrl:e(j)||null,description:e(I),badges:e($).split(",").map(o=>o.trim()).filter(Boolean),rating:Number(e(D)),createdAt:null,openedAt:null,editedAt:null,tags:e(L).split(",").map(o=>o.trim()).filter(Boolean),category:e(C)||"All",dataType:"Lib",characters:e(S).filter(o=>o.name).map(o=>({name:o.name,image:o.image,role:o.role,description:o.description,alternativeNames:(o._alternativeNamesString??"").split(",").map(q=>q.trim()).filter(Boolean),tags:(o._tagsString??"").split(",").map(q=>q.trim()).filter(Boolean)})),rows:e(x).filter(o=>o.chapterSE).map(o=>({chapterSE:o.chapterSE,description:o.description,characters:o.characters,tags:o._tagsText.split(",").map(q=>q.trim()).filter(Boolean)}))};c()!==null?await se.updateEntry(c(),m):await se.addEntry(m),w("save")}function O(){w("cancel")}Le();var R=ol(),U=a(R),Y=a(U),A=a(Y),W=a(A,!0);t(A);var re=l(A,2);t(Y);var ae=l(Y,2),X=a(ae),ne=a(X),V=l(a(ne),2);de(V),t(ne),t(X);var v=l(X,2),E=a(v),G=l(a(E),2);de(G),t(E),t(v);var ce=l(v,2),ve=a(ce),le=l(a(ve),2);de(le),t(ve),t(ce);var Q=l(ce,2),ee=a(Q),H=l(a(ee),2);pt(H),t(ee),t(Q);var ue=l(Q,2),je=a(ue),Ae=l(a(je),2);pt(Ae),t(je),t(ue);var be=l(ue,2),pe=a(be),Te=l(a(pe),2);pt(Te),t(pe),t(be);var ke=l(be,2),Ve=l(a(ke),2),ie=a(Ve);ie.value=ie.__value="All";var _t=l(ie);Ie(_t,1,()=>(i(),J(()=>i().filter(m=>m!=="All"))),Ue,(m,o)=>{var q=al(),_e=a(q,!0);t(q);var Ce={};Z(()=>{oe(_e,e(o)),Ce!==(Ce=e(o))&&(q.value=(q.__value=e(o))??"")}),k(m,q)}),t(Ve),t(ke);var et=l(ke,2),tt=a(et),yt=l(a(tt),2),kt=l(a(yt));t(yt),t(tt);var Ge=l(tt,2),dt=a(Ge);de(dt);var Ye=l(dt,2);Ie(Ye,4,()=>J(()=>Array.from({length:11},(m,o)=>o)),Ue,(m,o)=>{var q=ll();Z(()=>De(q,1,Wt(o===e(D)?"text-info font-bold":""))),k(m,q)}),t(Ye);var at=l(Ye,2);Ie(at,4,()=>J(()=>Array.from({length:11},(m,o)=>o)),Ue,(m,o)=>{var q=sl(),_e=a(q,!0);t(q),Z(()=>{De(q,1,Wt(o===e(D)?"text-info font-bold":"")),oe(_e,o)}),k(m,q)}),t(at),t(Ge),t(et);var ct=l(et,4),lt=a(ct);Ie(lt,1,()=>e(S),Ue,(m,o,q)=>{var _e=rl(),Ce=a(_e),ye=a(Ce),ze=l(a(ye),2);de(ze),t(ye);var He=l(ye,2),Fe=l(a(He),2);de(Fe),t(He);var st=l(He,2);t(Ce);var Se=l(Ce,2),Xe=l(a(Se),2);de(Xe),t(Se);var Re=l(Se,2),Ke=l(a(Re),2),he=a(Ke),Tt=l(a(he),2);de(Tt),t(he);var rt=l(he,2),Et=l(a(rt),2);de(Et),t(rt);var bt=l(rt,2),Mt=l(a(bt),2);pt(Mt),t(bt),t(Ke),t(Re),t(_e),te(ze,()=>e(o).name,we=>(e(o).name=we,Ne(()=>e(S)))),te(Fe,()=>e(o).role,we=>(e(o).role=we,Ne(()=>e(S)))),d("click",st,()=>P(q)),te(Xe,()=>e(o).image,we=>(e(o).image=we,Ne(()=>e(S)))),te(Tt,()=>e(o)._alternativeNamesString,we=>(e(o)._alternativeNamesString=we,Ne(()=>e(S)))),te(Et,()=>e(o)._tagsString,we=>(e(o)._tagsString=we,Ne(()=>e(S)))),te(Mt,()=>e(o).description,we=>(e(o).description=we,Ne(()=>e(S)))),k(m,_e)});var vt=l(lt,2);t(ct);var Ct=l(ct,4),Ze=a(Ct);Ie(Ze,1,()=>e(x),Ue,(m,o,q)=>{var _e=nl(),Ce=a(_e),ye=a(Ce),ze=l(a(ye),2);de(ze),t(ye);var He=l(ye,2);t(Ce);var Fe=l(Ce,2),st=l(a(Fe),2);pt(st),t(Fe);var Se=l(Fe,2),Xe=l(a(Se),2);de(Xe),t(Se);var Re=l(Se,2),Ke=l(a(Re),2);de(Ke),t(Re),t(_e),te(ze,()=>e(o).chapterSE,he=>(e(o).chapterSE=he,Ne(()=>e(x)))),d("click",He,()=>g(q)),te(st,()=>e(o).description,he=>(e(o).description=he,Ne(()=>e(x)))),te(Xe,()=>e(o)._tagsText,he=>(e(o)._tagsText=he,Ne(()=>e(x)))),te(Ke,()=>e(o).characters,he=>(e(o).characters=he,Ne(()=>e(x)))),k(m,_e)});var Dt=l(Ze,2);t(Ct),t(ae);var St=l(ae,2),ut=a(St),At=l(ut,2);t(St),t(U),t(R),Z(()=>{oe(W,c()!==null?"Edit Entry":"New Entry"),oe(kt,` ${e(D)??""} - ${K(Pt),e(D),J(()=>Pt[e(D)])??""}`),At.disabled=!e(b)||!e(C)}),d("click",re,O),te(V,()=>e(b),m=>s(b,m)),te(G,()=>e(u),m=>s(u,m)),te(le,()=>e(j),m=>s(j,m)),te(H,()=>e(I),m=>s(I,m)),te(Ae,()=>e($),m=>s($,m)),te(Te,()=>e(L),m=>s(L,m)),Kt(Ve,()=>e(C),m=>s(C,m)),te(dt,()=>e(D),m=>s(D,m)),d("click",vt,_),d("click",Dt,y),d("click",ut,O),d("click",At,N),d("click",U,Pe(function(m){Qe.call(this,n,m)})),d("click",R,O),k(f,R),Oe(),h()}var dl=M('<input class="input input-sm input-bordered flex-1 mr-2"/>'),cl=M('<span class="truncate cursor-pointer"> </span>'),vl=M('<button class="btn btn-sm btn-success">Save</button>'),ul=M('<button class="btn btn-xs btn-info">Edit</button> <button class="btn btn-xs btn-error">Delete</button>',1),bl=M('<div class="flex gap-2"><!></div>'),pl=M('<li class="mb-2 flex items-center justify-between"><!> <!></li>'),gl=M(`<div class="fixed inset-0 z-150 flex bg-black/50" role="button" tabindex="0" aria-label="Close categories modal"><div class="h-full w-96 bg-base-100 p-6 shadow-xl flex flex-col" role="document"><h2 class="mb-6 text-2xl font-bold">Categories</h2> <div class="flex-1 overflow-y-auto pr-1 border border-base-content/30 rounded-xl p-1 px-2"><ul class="mb-4"></ul></div> <div class="flex gap-2 mt-3"><input class="input-bordered input flex-1" placeholder="New category"/> <button aria-label="Add new category" class="btn btn-primary">Add</button></div> <button class="btn btn-soft mt-2 w-full">Close</button> <div class="mt-1 px-1 text-xs justify-center text-success"><span> </span></div> <div class="my-2 alert alert-default alert-soft "><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>When a category is <b>deleted</b>, all entries in that category are <b>moved to the 'All'</b> category</span></div></div></div>`);function fl(f,n){Be(n,!1);const i=()=>$e(We,"$categories",p),[p,h]=it();let c=me(n,"show",8,!1);const w=ot();let b=T(""),u=T(null),j=T("");function I(g){s(u,g),s(j,g)}async function $(g){const N=e(j).trim();if(!N||N==="All"||N===g){s(u,null);return}await We.rename(g,N),w("rename",{old:g,new:N}),s(u,null),S(`Category renamed to "${N}"`)}async function D(){const g=e(b).trim();!g||g==="All"||(await We.add(g),s(b,""))}let L=T(""),C=T(!1);function S(g,N=2e3){s(L,g),s(C,!0),setTimeout(()=>{s(C,!1)},N)}async function x(g){g!=="All"&&(await se.moveCategoryToAll(g),await We.remove(g),S(`Category "${g}" deleted. Entries moved to 'All'.`))}Jt(()=>{We.load()}),Le();var _=wt(),P=qe(_);{var y=g=>{var N=gl(),O=a(N),R=l(a(O),2),U=a(R);Ie(U,5,()=>(i(),J(()=>["All",...i().filter(V=>V!=="All")])),Ue,(V,v)=>{var E=pl(),G=a(E);{var ce=ee=>{var H=dl();de(H),ca(H),te(H,()=>e(j),ue=>s(j,ue)),d("keydown",H,ue=>ue.key==="Enter"&&$(e(v))),d("blur",H,()=>$(e(v))),k(ee,H)},ve=ee=>{var H=cl(),ue=a(H,!0);t(H),Z(()=>oe(ue,e(v))),d("dblclick",H,()=>I(e(v))),k(ee,H)};z(G,ee=>{e(u)===e(v)?ee(ce):ee(ve,!1)})}var le=l(G,2);{var Q=ee=>{var H=bl(),ue=a(H);{var je=be=>{var pe=vl();d("click",pe,Pe(()=>$(e(v)))),k(be,pe)},Ae=be=>{var pe=ul(),Te=qe(pe),ke=l(Te,2);d("click",Te,Pe(()=>I(e(v)))),d("click",ke,Pe(()=>x(e(v)))),k(be,pe)};z(ue,be=>{e(u)===e(v)?be(je):be(Ae,!1)})}t(H),k(ee,H)};z(le,ee=>{e(v)!=="All"&&ee(Q)})}t(E),k(V,E)}),t(U),t(R);var Y=l(R,2),A=a(Y);de(A);var W=l(A,2);t(Y);var re=l(Y,2),ae=l(re,2),X=a(ae),ne=a(X,!0);t(X),t(ae),Me(2),t(O),t(N),Z(()=>{ea(ae,`min-height: 1.55rem; max-height: 1.55rem; visibility: ${e(C)?"visible":"hidden"}`),oe(ne,e(L))}),te(A,()=>e(b),V=>s(b,V)),d("click",W,D),d("click",re,()=>w("close")),d("click",O,Pe(function(V){Qe.call(this,n,V)})),d("click",N,()=>w("close")),d("keydown",N,V=>{(V.key==="Enter"||V.key===" ")&&w("close")}),k(g,N)};z(P,g=>{c()&&g(y)})}k(f,_),Oe(),h()}var ml=M('<li><input type="radio" name="theme-dropdown" class="theme-controller btn btn-sm btn-block btn-ghost justify-start"/></li>'),hl=M('<div><div tabindex="0" role="button" class="btn p-2 m-0 rounded-2xl">üé® <svg width="12px" height="12px" class="inline-block h-1 w-1 fill-current opacity-60" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048"><path d="M1799 349l242 241-1017 1017L7 590l242-241 775 775 775-775z"></path></svg></div> <ul tabindex="-1" class="dropdown-content menu bg-base-300 rounded-2xl z-150 w-52 p-2 shadow-sm"></ul></div>');function wl(f,n){Be(n,!1);const i=()=>$e(Vt,"$theme",p),[p,h]=it(),c=["light","cupcake","night","dark","emerald","fantasy","luxury","acid","coffee","retro","business","dracula","dim","garden"];let w=me(n,"dropdownDirection",8,"dropdown-end");function b(I){Vt.set(I)}Le();var u=hl(),j=l(a(u),2);Ie(j,5,()=>c,Ue,(I,$)=>{var D=ml(),L=a(D);de(L),t(D),Z(()=>{xt(L,"aria-label",e($)),xa(L,e($)),Qt(L,i()===e($))}),d("change",L,()=>b(e($))),k(I,D)}),t(j),t(u),Z(()=>De(u,1,`dropdown ${w()}`)),k(f,u),Oe(),h()}var xl=M('<span class="absolute -top-6 -left-2 flex h-5 w-20 items-center justify-center rounded-full bg-red-600 text-xs font-bold text-white p-1"> </span>'),_l=M('<li><button class="w-full border border-base-300 text-left hover:bg-base-200"> </button></li>'),yl=M('<ul class="dropdown-content menu mt-3 w-52 rounded-box bg-base-100 p-2 shadow-md"></ul>'),kl=M('<div class="fixed top-16 left-1/2 z-50 flex items-center gap-4 rounded-lg border border-base-300 bg-base-100 p-2 shadow-md select-none"><div role="button" tabindex="0" class="cursor-grab rounded-md bg-base-200 p-2 hidden md:inline-block" aria-label="Drag toolbar">‚†ø</div> <div class="tooltip" data-tip="Delete"><button class="btn relative btn-square btn-error" aria-label="Delete selected"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 7h12M10 11v6m4-6v6M5 7l1 12a2 2 0 002 2h8a2 2 0 002-2l1-12M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3"></path></svg> <!></button></div> <div class="tooltip" data-tip="Select all"><button class="btn btn-square btn-ghost" aria-label="Select all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7M5 7l4 4L19 1"></path></svg></button></div> <div class="tooltip" data-tip="Deselect all"><button class="btn btn-square opacity-50 btn-ghost" aria-label="Deselect all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current opacity-20"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7M5 7l4 4L19 1"></path></svg></button></div> <div><div class="tooltip" data-tip="Move to category"><button class="btn btn-square btn-ghost" aria-label="Move to category"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4h16v4H4V4zm0 8h16v4H4v-4zm0 8h16v4H4v-4z"></path></svg></button></div> <!></div> <div class="tooltip" data-tip="Cancel"><button class="btn btn-square bg-red-700 text-white btn-ghost hover:bg-red-500" aria-label="Cancel selection"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div role="button" tabindex="0" class="drag-handle cursor-grab rounded-md bg-base-200 p-2" aria-label="Drag toolbar">‚†ø</div></div>');function Cl(f,n){Be(n,!1);let i=me(n,"selectedCount",8,0),p=me(n,"categoryList",24,()=>[]),h=me(n,"showCategoryDropdown",8,!1);const c=ot();let w=!1,b=0,u=0,j=T(0),I=T(0);function $(v){w=!0,b=v.clientX-e(j),u=v.clientY-e(I),window.addEventListener("pointermove",D),window.addEventListener("pointerup",L)}function D(v){w&&(s(j,v.clientX-b),s(I,v.clientY-u))}function L(){w=!1,window.removeEventListener("pointermove",D),window.removeEventListener("pointerup",L)}Le();var C=kl(),S=a(C),x=l(S,2),_=a(x),P=l(a(_),2);{var y=v=>{var E=xl(),G=a(E,!0);t(E),Z(()=>oe(G,i())),k(v,E)};z(P,v=>{i()>0&&v(y)})}t(_),t(x);var g=l(x,2),N=a(g);t(g);var O=l(g,2),R=a(O);t(O);var U=l(O,2);let Y;var A=a(U),W=a(A);t(A);var re=l(A,2);{var ae=v=>{var E=yl();Ie(E,5,p,Ue,(G,ce)=>{var ve=_l(),le=a(ve),Q=a(le,!0);t(le),t(ve),Z(()=>oe(Q,e(ce))),d("click",le,()=>c("moveCategory",e(ce))),k(G,ve)}),t(E),k(v,E)};z(re,v=>{K(h()),K(p()),J(()=>h()&&p().length>0)&&v(ae)})}t(U);var X=l(U,2),ne=a(X);t(X);var V=l(X,2);t(C),Z(()=>{ea(C,`transform: translate(calc(-50% + ${e(j)??""}px), ${e(I)??""}px);`),_.disabled=i()===0,Y=De(U,1,"dropdown dropdown-end",null,Y,{"dropdown-open":h()}),W.disabled=i()===0}),d("pointerdown",S,$),d("click",_,()=>c("delete")),d("click",N,()=>c("selectAll")),d("click",R,()=>c("deselectAll")),d("click",W,()=>c("toggleCategoryDropdown")),d("click",ne,()=>c("cancel")),d("pointerdown",V,$),k(f,C),Oe()}var Sl=Zt('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4h16v16H4V4z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M8 12h8"></path></svg>'),Al=Zt('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2"><rect x="4" y="4" width="16" height="16" stroke="currentColor" stroke-width="2"></rect><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h8"></path></svg>'),Tl=M('<button><div class="indicator"><span class="indicator-item bg-base-100 text-xs rounded-3xl px-1.5 py-0.5 -top-1"> </span> <div class="z-10"> </div></div></button>'),El=M('<div class="flex h-screen flex-col"><div class="navbar bg-base-100 shadow-lg"><div class="flex-none"><button class="btn btn-square btn-ghost" aria-label="Open menu"><!></button></div> <div class="flex-1"><span class="text-md md:text-xl font-bold"> <span class="hide-on-320 svelte-j9gjs9"> </span></span></div> <div class="flex-none"><button class="btn btn-square btn-ghost" aria-label="Toggle search"><!></button> <div class="tooltip tooltip-bottom" data-tip="Open filters"><button class="btn btn-square btn-ghost" aria-label="Open filters"><!></button></div> <div class="tooltip tooltip-bottom" data-tip="Select entries"><button class="btn btn-square btn-ghost" aria-label="Select entries"><!></button></div> <button class="btn btn-square btn-ghost inline-block md:hidden" aria-label="Toggle grid columns" title="Toggle grid columns"><!></button> <!></div></div> <!> <div class="tabs tabs-border flex-nowrap gap-1 overflow-x-auto bg-base-200 px-2 pt-2 pb-1 scrollbar-hide"><button class="p-0 m-0" title="Toggle unique entries" aria-label="Show unique entries only"><!></button> <button><div class="z-10">All</div> <span class="bg-base-100 text-xs rounded-3xl px-1.5 py-0.5"> </span></button> <!></div> <button class="z-100 btn fixed right-6 bottom-6 btn-circle shadow-xl btn-lg btn-primary" aria-label="Add new entry"><!></button> <!>  <div class="flex-1 overflow-auto p-4"><!></div></div> <!> <!> <!> <!> <!> <!>',1);function Ml(f,n){Be(n,!1);const i=()=>$e(Sa,"$filteredEntries",b),p=()=>$e(nt,"$selectedCategory",b),h=()=>$e(We,"$categories",b),c=()=>$e(jt,"$entries",b),w=()=>$e(Yt,"$gridCols",b),[b,u]=it(),j=T(),I=T();let $=T(!1),D=T(!1),L=T(!1),C=T(!1),S=T(!1),x=T(null),_=T(null),P=T(!1),y=T(new Set),g=T(!1);const N=ot();let O=T(!1),R=T(""),U=T(!1);function Y(){Yt.update(r=>r===3?4:3)}async function A(){const r=await se.getAllEntries();jt.set(r),Array.from(new Set(r.map(B=>B.category).filter(B=>B&&B!=="All"))),We.load()}Jt(async()=>{await A(),Ea();const r=localStorage.getItem("selectedCategory");r&&nt.set(r)});function W(){s(x,null),s(S,!0),s(g,!1)}async function re(){s(S,!1),s(x,null),await A()}function ae(){s(S,!1),s(x,null)}async function X(){s(C,!1),s(_,null),await A()}function ne(){s(C,!1),s(_,null)}let V;function v(r){s(R,r),s(U,!0),clearTimeout(V),V=window.setTimeout(()=>{s(U,!1)},1500)}async function E(r){await se.importFromJSON(r),await A(),s(L,!1)}async function G(){const r=await se.exportToJSON(),B=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),xe=URL.createObjectURL(B),ge=document.createElement("a");ge.href=xe,ge.download=`lib-export-${new Date().toISOString()}.json`,document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),URL.revokeObjectURL(xe),s(L,!1),v("Exported to JSON üëç :Downloads/")}async function ce(){const r=await se.exportToMarkdown(),B=new Blob([r],{type:"text/markdown"}),xe=URL.createObjectURL(B),ge=document.createElement("a");ge.href=xe,ge.download=`lib-export-${new Date().toISOString()}.md`,document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),URL.revokeObjectURL(xe),s(L,!1),v("Exported to Markdown üëç :Downloads/")}async function ve(r){await se.moveCategoryToAll(r),p()===r&&nt.set("All"),await A(),s(P,!1)}let le=T(!1);async function Q(r){for(const xe of e(y))c().find($t=>$t.id===xe)&&await se.updateEntry(xe,{category:r});e(y).clear(),s(y,new Set(e(y))),s(g,!1);const B=await se.getAllEntries();jt.set(B),s(le,!1)}function ee(r){e(y).has(r)?e(y).delete(r):e(y).add(r),s(y,new Set(e(y)))}async function H(){if(e(y).size===0)return;const r=Array.from(e(y));for(const B of r)await se.deleteEntry(B);e(y).clear(),s(y,new Set(e(y))),await A(),s(g,!1)}function ue(){s(y,new Set(i().map(r=>r.id)))}function je(){e(y).clear(),s(y,new Set(e(y)))}mt(()=>(e(O),i(),Gt),()=>{s(j,e(O)?Array.from(new Map(i().map(r=>[Gt(r),r])).values()):i())}),mt(()=>h(),()=>{s(I,h().filter(r=>r!=="All"))}),Xt(),Le();var Ae=El(),be=qe(Ae),pe=a(be),Te=a(pe),ke=a(Te),Ve=a(ke);fe(Ve,()=>(K(F),J(()=>F.menu))),t(ke),t(Te);var ie=l(Te,2),_t=a(ie),et=a(_t);et.nodeValue="Lib ";var tt=l(et),yt=a(tt);t(tt),t(_t),t(ie);var kt=l(ie,2),Ge=a(kt),dt=a(Ge);fe(dt,()=>(K(F),J(()=>F.search))),t(Ge);var Ye=l(Ge,2),at=a(Ye),ct=a(at);fe(ct,()=>(K(F),J(()=>F.filter))),t(at),t(Ye);var lt=l(Ye,2),vt=a(lt),Ct=a(vt);fe(Ct,()=>(K(F),J(()=>F.select))),t(vt),t(lt);var Ze=l(lt,2),Dt=a(Ze);fe(Dt,()=>(K(F),J(()=>F.toggleGrid))),t(Ze);var St=l(Ze,2);wl(St,{dropdownDirection:"dropdown-bottom dropdown-end"}),t(kt),t(pe);var ut=l(pe,2);{var At=r=>{Wa(r,{get show(){return e($)},set show(B){s($,B)},$$legacy:!0})};z(ut,r=>{e($)&&r(At)})}var m=l(ut,2),o=a(m),q=a(o);{var _e=r=>{var B=Sl();k(r,B)},Ce=r=>{var B=Al();k(r,B)};z(q,r=>{e(O)?r(_e):r(Ce,!1)})}t(o);var ye=l(o,2);let ze;var He=l(a(ye),2),Fe=a(He,!0);t(He),t(ye);var st=l(ye,2);Ie(st,1,()=>e(I),Ue,(r,B)=>{var xe=Tl();let ge;var $t=a(xe),Lt=a($t),na=a(Lt,!0);t(Lt);var Ft=l(Lt,2),oa=a(Ft,!0);t(Ft),t($t),t(xe),Z(Bt=>{ge=De(xe,1,"tab",null,ge,{"tab-active":p()===e(B)}),oe(na,Bt),oe(oa,e(B))},[()=>(c(),e(B),J(()=>c().filter(Bt=>Bt.category===e(B)).length))]),d("click",xe,()=>nt.set(e(B))),k(r,xe)}),t(m);var Se=l(m,2),Xe=a(Se);fe(Xe,()=>(K(F),J(()=>F.add))),t(Se);var Re=l(Se,2);{var Ke=r=>{Cl(r,{get selectedCount(){return e(y),J(()=>e(y).size)},get categoryList(){return e(I)},get showCategoryDropdown(){return e(le)},$$events:{delete:H,selectAll:ue,deselectAll:je,toggleCategoryDropdown:()=>s(le,!e(le)),moveCategory:B=>Q(B.detail),cancel:()=>{s(g,!1),s(le,!1),e(y).clear(),s(y,new Set(e(y)))}}})};z(Re,r=>{e(g)&&r(Ke)})}var he=l(Re,2),Tt=a(he);Ja(Tt,{get entries(){return e(j)},get selectionMode(){return e(g)},get selectedEntries(){return e(y)},get gridCols(){return w()},$$events:{toggleSelect:r=>ee(r.detail)}}),t(he),t(be);var rt=l(be,2);{var Et=r=>{Va(r,{get show(){return e(D)},set show(B){s(D,B)},$$legacy:!0})};z(rt,r=>{e(D)&&r(Et)})}var bt=l(rt,2);{var Mt=r=>{tl(r,{get show(){return e(L)},set show(B){s(L,B)},$$events:{import:B=>E(B.detail),export:G,exportMd:ce,showCategories:()=>{s(L,!1),s(P,!0)}},$$legacy:!0})};z(bt,r=>{e(L)&&r(Mt)})}var we=l(bt,2);{var aa=r=>{fl(r,{get show(){return e(P)},$$events:{close:()=>s(P,!1),rename:B=>N("renameCategory",B.detail),delete:B=>ve(B.detail)}})};z(we,r=>{e(P)&&r(aa)})}var zt=l(we,2);{var la=r=>{_a(r,{get entryId(){return e(_)},$$events:{save:X,cancel:ne}})};z(zt,r=>{e(C)&&r(la)})}var Ht=l(zt,2);{var sa=r=>{il(r,{get entryId(){return e(x)},$$events:{save:re,cancel:ae}})};z(Ht,r=>{e(S)&&r(sa)})}var ra=l(Ht,2);qt(ra,{get showAlert(){return e(U)},get message(){return e(R)}}),Z(()=>{oe(yt,`(${c(),J(()=>c().length)??""})`),ze=De(ye,1,"tab relative",null,ze,{"tab-active":p()==="All"}),oe(Fe,(c(),J(()=>c().length)))}),d("click",ke,()=>s(L,!0)),d("click",Ge,()=>{s($,!e($)),s(g,!1)}),d("click",at,()=>{s(D,!e(D)),s(g,!1)}),d("click",vt,()=>{e(g)&&(e(y).clear(),s(y,new Set(e(y))),s(le,!1)),s(g,!e(g))}),d("click",Ze,Y),d("click",o,()=>s(O,!e(O))),d("click",ye,()=>nt.set("All")),d("click",Se,W),k(f,Ae),Oe(),u()}function ql(f){ba("1uha8ag",n=>{va(()=>{ua.title="lib"})}),Ml(f,{})}export{ql as component};
