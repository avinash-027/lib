import{c as _t,a as k,f as M,d as Zt}from"../chunks/DIo1Mb-Q.js";import{i as Le}from"../chunks/BaBAM0Xm.js";import{h as Rt,D as Be,E as Ue,G as Oe,z as te,u as J,I as a,K as l,y as e,J as t,F as Z,aP as oa,aT as wt,aU as Xt,W as s,V as T,aN as ia,ax as Ee,aY as ft,aZ as Ne,a_ as da,e as ca,aW as va}from"../chunks/BKQwOs6K.js";import{h as ua}from"../chunks/B3mhA-Ep.js";import{d as ba,w as Nt,c as nt,g as pa,o as Jt}from"../chunks/Ou4Y_0Z5.js";import{s as oe,e as d,r as ga}from"../chunks/UijS7mQC.js";import{p as fe,i as q,a as Me,s as ot}from"../chunks/BezKbsVq.js";import{t as fa,d as se,e as Ie,k as De,c as ma,s as yt,j as he,S as W,r as de,l as ee,m as Kt,a as Ve,b as Qe,h as Qt,g as ha,i as He,n as Wt,R as Pt,o as Pe,f as wa,p as Vt,q as Gt,E as xa}from"../chunks/BBCQDpWt.js";import{g as _a,b as ya}from"../chunks/f5m_idUa.js";import{b as Ot}from"../chunks/DEv7LI8C.js";function ea(f,n,i,p){var h=f.__style;if(Rt||h!==n){var c=fa(n);(!Rt||c!==f.getAttribute("style"))&&(c==null?f.removeAttribute("style"):f.style.cssText=c),f.__style=n}return p}function ka(){const{subscribe:f,set:n,update:i}=Nt([]);return{subscribe:f,set:n,update:i,load:async()=>{const p=await se.getAllEntries();return n(p),p},add:async p=>{const h=await se.addEntry(p);i(c=>[...c,{...p,id:h}])},updateEntry:async(p,h)=>{await se.updateEntry(p,h),i(c=>c.map(w=>w.id===p?{...w,...h}:w))},deleteEntry:async p=>{await se.deleteEntry(p),i(h=>h.filter(c=>c.id!==p))}}}const $t=ka(),Te=Nt(""),Je=Nt("default"),rt=It("libsettings:selectedCategory","All"),mt=It("libsettings:sortField","createdAt"),ht=It("libsettings:sortOrder","desc"),Yt=It("lib:gridCols",4),Ca=ba([$t,rt,Te,Je,mt,ht],([f,n,i,p,h,c])=>{let w=[...f];if(n!=="All"&&(w=w.filter(b=>b.category===n)),i){const b=i.toLowerCase();w=w.filter(u=>{switch(p){case"a":return u.alternativeTitles.join(" ").toLowerCase().includes(b);case"t":return u.tags.join(" ").toLowerCase().includes(b);case"b":return u.badges.join(" ").toLowerCase().includes(b);case"c":return u.characters.map($=>$.Name).join(" ").toLowerCase().includes(b);case"d":return u.dataType.toLowerCase().includes(b);default:return u.title.toLowerCase().includes(b)||u.alternativeTitles.join(" ").toLowerCase().includes(b)}})}return w=w.sort((b,u)=>{const $=b[h]??"",I=u[h]??"";return c==="asc"?$>I?1:-1:$<I?1:-1}),w});function It(f,n){const i=localStorage.getItem(f),{subscribe:p,set:h,update:c}=Nt(i?JSON.parse(i):n);return{subscribe:p,set:w=>{localStorage.setItem(f,JSON.stringify(w)),h(w)},update:w=>{c(b=>{const u=w(b);return localStorage.setItem(f,JSON.stringify(u)),u})}}}let xt=null;async function Sa(){try{const i=await window.showDirectoryPicker()}catch(i){console.error("Failed to open directory picker",i),alert("Cannot open folder in this browser. Try Edge or Chrome.")}const f={mode:"readwrite"};await dirHandle.queryPermission(f)!=="granted"&&await dirHandle.requestPermission(f);const n=(await se.getDB()).transaction("settings","readwrite");await n.objectStore("settings").put(dirHandle,"backupDirHandle"),await n.objectStore("settings").put(dirHandle.name,"backupFolderName"),await n.done,localStorage.setItem("autoBackupEnabled","true"),Ht(dirHandle),await ta(dirHandle)}function Aa(){localStorage.removeItem("autoBackupEnabled"),localStorage.removeItem("autoBackupDirHandle"),localStorage.removeItem("autoBackupFolderName"),xt&&clearTimeout(xt)}async function Ta(){if(localStorage.getItem("autoBackupEnabled")!=="true")return;const n=await(await se.getDB()).get("settings","backupDirHandle");n&&Ht(n)}async function ta(f){const n=await se.exportToJSON(),p=await(await f.getFileHandle("lib-autobackup.json",{create:!0})).createWritable();await p.write(JSON.stringify(n,null,2)),await p.close(),console.log("‚úÖ Auto backup saved at",new Date().toLocaleString())}function Ht(f){xt&&clearTimeout(xt);const n=new Date,i=new Date;i.setHours(12,0,0,0);const p=new Date;p.setHours(24,0,0,0);let h;n<i?h=i:h=p;const c=h.getTime()-n.getTime();xt=window.setTimeout(async()=>{await f.queryPermission({mode:"readwrite"})==="granted"&&await ta(f),Ht(f)},c)}function Ea(f){const n=new IntersectionObserver(([i],p)=>{if(i.isIntersecting){const h=f.dataset.src;h&&(f.src=h),f.classList.add("lozad-loaded"),p.unobserve(f)}});return n.observe(f),{destroy(){n.unobserve(f)}}}var Ma=M('<div class="px-1 w-full opacity-80 text-sm h-65 md:h-55 flex items-end justify-center text-base-content/50"><div>No entries found. <ul class="list-disc list-inside mt-1"><li>Add new entries by clicking the <b>"+"</b> button.</li> <li>To Manage categories, click the "Categories" button in the <b>Drawer Menu</b>.</li></ul></div></div>'),ja=M('<button type="button"><!></button>'),$a=M('<img class="w-full h-full object-cover lozad"/>'),Na=M('<div class="w-full h-full flex items-center justify-center text-base-content/20"><!></div>'),Ia=M('<span class="absolute top-1 right-1 rounded-2xl text-[.84em] md:text-sm bg-base-200 px-1 py-0"> </span>'),Da=M('<span class="absolute top-1.5 left-1 rounded-2xl text-xs md:text-sm bg-info text-base-300 px-1 py-0 font-semibold"> </span>'),La=M('<div class="relative"><!> <button class="card bg-base-100 shadow-xl cursor-pointer hover:shadow-2xl transition-shadow w-full h-full"><figure class="aspect-[3/4] bg-base-300"><!></figure> <div class="card-body p-2"><!> <!> <h3 class="card-title text-xs sm:text-sm line-clamp-2"> </h3></div></button></div>'),Ba=M("<div></div>");function Oa(f,n){Be(n,!1);let i=fe(n,"entries",24,()=>[]),p=fe(n,"selectionMode",8,!1),h=fe(n,"selectedEntries",24,()=>new Set),c=fe(n,"gridCols",8,4);const w=nt();function b(C){!p()&&C!==void 0&&_a(`${ya}/detail/${C}`)}function u(C){w("toggleSelect",C)}const $={2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5"};Le();var I=_t(),j=Ue(I);{var D=C=>{var S=Ma();k(C,S)},L=C=>{var S=Ba();Ie(S,5,i,x=>x.id,(x,_)=>{var P=La(),y=a(P);{var g=v=>{var E=ja();let G;var ce=a(E);{var ve=K=>{var Q=_t(),z=Ue(Q);he(z,()=>(te(W),J(()=>W.selectTick))),k(K,Q)},le=oa(()=>(te(h()),e(_),J(()=>h().has(e(_).id))));q(ce,K=>{e(le)&&K(ve)})}t(E),Z(K=>G=De(E,1,"rounded-xl absolute inset-0 z-10 flex items-center justify-center bg-black/20 cursor-pointer transition-opacity",null,G,K),[()=>({selected:h().has(e(_).id)})]),d("click",E,K=>{K.stopPropagation(),u(e(_).id)}),k(v,E)};q(y,v=>{p()&&v(g)})}var N=l(y,2),O=a(N),F=a(O);{var H=v=>{var E=$a();ma(E,G=>Ea?.(G)),Z(()=>{yt(E,"src",(e(_),J(()=>e(_).coverImageUrl))),yt(E,"alt",(e(_),J(()=>e(_).title)))}),ga(E),k(v,E)},Y=v=>{var E=Na(),G=a(E);he(G,()=>(te(W),J(()=>W.imgIcon))),t(E),k(v,E)};q(F,v=>{e(_),J(()=>e(_).coverImageUrl)?v(H):v(Y,!1)})}t(O);var A=l(O,2),R=a(A);{var re=v=>{var E=Ia(),G=a(E,!0);t(E),Z(()=>oe(G,(e(_),J(()=>e(_).dataType)))),k(v,E)};q(R,v=>{e(_),J(()=>e(_).dataType)&&v(re)})}var ae=l(R,2);{var X=v=>{var E=Da(),G=a(E,!0);t(E),Z(()=>oe(G,(e(_),J(()=>e(_).rating)))),k(v,E)};q(ae,v=>{e(_),J(()=>e(_).rating!==null&&e(_).rating>0)&&v(X)})}var ne=l(ae,2),V=a(ne,!0);t(ne),t(A),t(N),t(P),Z(()=>oe(V,(e(_),J(()=>e(_).title)))),d("click",N,()=>b(e(_).id)),k(x,P)}),t(S),Z(()=>De(S,1,(te(c()),J(()=>`grid gap-2 ${$[c()]} md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10`)))),k(C,S)};q(j,C=>{te(i()),J(()=>i().length===0)?C(D):C(L,!1)})}k(f,I),Oe()}var Ja=M("alternative titles <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Ha=M("tags <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),Ua=M("badges <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),qa=M("characters <br/>('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)",1),za=M('<div class="text-xs text-info mt-2">Searching in: <!> <!> <!> <!></div>'),Fa=M(`<div class="bg-base-200 px-4 pt-3 pb-1 shadow-lg"><div class="flex gap-2 items-center"><input type="text" placeholder="Search ('a:' altTitles, 't:' tags, 'b:' badges, 'c:' characters, 'd:' dataType)" class="input input-bordered flex-1"/> <button class="btn btn-square btn-ghost" aria-label="Close search"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <!></div>`);function Ra(f,n){Be(n,!1);const i=()=>Me(Je,"$searchMode",p),[p,h]=ot();let c=fe(n,"show",12,!1),w=T(""),b=T();async function u(){await ia(),e(b)?.focus()}function $(){s(w,""),Te.set(""),Je.set("default"),c(!1)}wt(()=>Te,()=>{pa(Te)&&c(!0)}),wt(()=>te(c()),()=>{c()&&u()}),wt(()=>(e(w),Te),()=>{const x=e(w).trim(),_=x.toLowerCase();_.startsWith("a:")?(Je.set("a"),Te.set(x.slice(2))):_.startsWith("t:")?(Je.set("t"),Te.set(x.slice(2))):_.startsWith("b:")?(Je.set("b"),Te.set(x.slice(2))):_.startsWith("c:")?(Je.set("c"),Te.set(x.slice(2))):_.startsWith("d:")?(Je.set("d"),Te.set(x.slice(2))):(Je.set("default"),Te.set(x))}),Xt(),Le();var I=Fa(),j=a(I),D=a(j);de(D),Ot(D,x=>s(b,x),()=>e(b));var L=l(D,2);t(j);var C=l(j,2);{var S=x=>{var _=za(),P=l(a(_));{var y=A=>{var R=Ja();Ee(2),k(A,R)};q(P,A=>{i()==="a"&&A(y)})}var g=l(P,2);{var N=A=>{var R=Ha();Ee(2),k(A,R)};q(g,A=>{i()==="t"&&A(N)})}var O=l(g,2);{var F=A=>{var R=Ua();Ee(2),k(A,R)};q(O,A=>{i()==="b"&&A(F)})}var H=l(O,2);{var Y=A=>{var R=qa();Ee(2),k(A,R)};q(H,A=>{i()==="c"&&A(Y)})}t(_),k(x,_)};q(C,x=>{i()!=="default"&&x(S)})}t(I),ee(D,()=>e(w),x=>s(w,x)),d("click",L,$),k(f,I),Oe(),h()}var Wa=M('<div class="fixed inset-0 bg-black/50 z-150 flex items-end" role="presentation"><div class="bg-base-100 w-full rounded-t-2xl p-6 max-h-[80vh] overflow-auto" role="dialog" tabindex="-1"><h3 class="text-2xl font-bold mb-6">Sort & Filter</h3> <div class="form-control mb-4"><label class="label" for="sort-field"><span class="label-text font-semibold">Sort By</span></label> <select id="sort-field" class="select select-bordered w-full"><option>Title (A-Z)</option><option>Rating</option><option>Last Edited</option><option>Date Created</option><option>Last Opened</option></select></div> <div class="form-control mb-6"><label class="label" for="sort-order"><span class="label-text font-semibold">Order</span></label> <div class="flex gap-2"><button>Ascending</button> <button>Descending</button></div></div> <div class="flex gap-2"><button class="btn btn-outline flex-1">Reset</button> <button class="btn btn-primary flex-1">Apply</button></div></div></div>');function Pa(f,n){Be(n,!1);const i=()=>Me(mt,"$sortField",h),p=()=>Me(ht,"$sortOrder",h),[h,c]=ot();let w=fe(n,"show",12,!1),b=T(i()),u=T(p());mt.subscribe(C=>s(b,C)),ht.subscribe(C=>s(u,C));function $(){mt.set(e(b)),ht.set(e(u)),w(!1)}function I(){s(b,"title"),s(u,"asc"),mt.set(e(b)),ht.set(e(u)),w(!1)}Le();var j=_t(),D=Ue(j);{var L=C=>{var S=Wa(),x=a(S),_=l(a(x),2),P=l(a(_),2),y=a(P);y.value=y.__value="title";var g=l(y);g.value=g.__value="rating";var N=l(g);N.value=N.__value="editedAt";var O=l(N);O.value=O.__value="createdAt";var F=l(O);F.value=F.__value="openedAt",t(P),t(_);var H=l(_,2),Y=l(a(H),2),A=a(Y);let R;var re=l(A,2);let ae;t(Y),t(H);var X=l(H,2),ne=a(X),V=l(ne,2);t(X),t(x),t(S),Z(()=>{R=De(A,1,"btn flex-1",null,R,{"btn-primary":e(u)==="asc"}),yt(A,"aria-pressed",e(u)==="asc"),ae=De(re,1,"btn flex-1",null,ae,{"btn-primary":e(u)==="desc"}),yt(re,"aria-pressed",e(u)==="desc")}),Kt(P,()=>e(b),v=>s(b,v)),d("click",A,()=>s(u,"asc")),d("click",re,()=>s(u,"desc")),d("click",ne,I),d("click",V,$),d("click",x,Ve(function(v){Qe.call(this,n,v)})),d("keydown",x,function(v){Qe.call(this,n,v)}),d("click",S,()=>w(!1)),d("keydown",S,function(v){Qe.call(this,n,v)}),k(C,S)};q(D,C=>{w()&&C(L)})}k(f,j),Oe(),c()}const Va=`\`\`\`json\r
// Example\r
[\r
  {\r
    "id": 2,\r
    "title": "Solo Leveling",\r
    "alternativeTitles": [ "Only I Level Up", "Na Honja Level Up" ],\r
    "coverImageUrl": "https://example.com/covers/solo-leveling.jpg",\r
    "description": "In a world where gates connect Earth to deadly dungeons, the weakest hunter awakens a mysterious system that allows him to level up alone.",\r
    "badges": ["Manhwa", "Action", "Fantasy", "Completed"],\r
    "tags": [ "gates", "hunters", "dungeons", "system", "shadows", "awakening"],\r
    "rating": null,\r
    "createdAt": "2024-12-15T08:20:00.000Z",\r
    "openedAt": "2025-02-07T14:10:30.000Z",\r
    "editedAt": "2025-02-07T18:45:10.000Z",\r
    "characters": [\r
      {\r
        "Name": "Sung Jin-Woo",\r
        "Image": "https://example.com/characters/sung-jin-woo.png",\r
        "role": "Main",\r
        "alternativeNames": [ "Jinwoo"],\r
        "tags": ["MC", "Solo-Player"],\r
        "description": ""\r
      },\r
      {\r
        "Name": "Cha Hae-In",\r
        "role": "Main",\r
        "Image": "https://example.com/characters/cha-hae-in.png"\r
      },\r
      {\r
        "Name": "Go Gun-Hee",\r
        "role": "supporting",\r
        "Image": "https://example.com/characters/go-gun-hee.png"\r
      }\r
    ],\r
    "rows": [\r
      {\r
        "ChapterSE": "Episode 1 ‚Äì The Weakest Hunter",\r
        "Description": "E-rank hunter Sung Jin-Woo barely survives a low-level dungeon while struggling to pay his family‚Äôs medical bills.",\r
        "Tags": ["introduction", "low-rank", "desperation"],\r
        "Characters": "Sung Jin-Woo"\r
      },\r
      {\r
        "ChapterSE": "Episode 2 ‚Äì Double Dungeon",\r
        "Description": "A hidden dungeon reveals a deadly trial where survival depends on following cryptic rules.",\r
        "Tags": ["double-dungeon", "statues", "death"],\r
        "Characters": "Sung Jin-Woo, Dungeon Party"\r
      },\r
      {\r
        "ChapterSE": "Episode 3 ‚Äì The System",\r
        "Description": "After facing death, Jin-Woo awakens to a mysterious system that only he can see.",\r
        "Tags": ["awakening", "system", "rebirth"],\r
        "Characters": "Sung Jin-Woo"\r
      }\r
    ],\r
    "category": "Manhwa",\r
    "dataType": "json"\r
  },\r
  // ...\r
]\r
\`\`\``;var Ga=M('<div role="alert" class="fixed bottom-2 left-2 z-300 alert alert-info alert-outline bg-base-100"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>');function Ut(f,n){let i=fe(n,"showAlert",8,!1),p=fe(n,"message",8,"");var h=_t(),c=Ue(h);{var w=b=>{var u=Ga(),$=l(a(u),2),I=a($,!0);t($),t(u),Z(()=>oe(I,p())),k(b,u)};q(c,b=>{i()&&b(w)})}k(f,h)}var Ya=M('<div class="text-xs text-gray-500 mt-1 pl-1"> <br/> ‚è∞ Every 12 hours (12:00 AM & 12:00 PM)</div>'),Za=M('<button class="btn btn-md btn-ghost rounded-full flex justify-between py-3 px-0"><span>üïõ Auto Backup :</span> <input type="checkbox" class="toggle toggle-primary"/> </button> <!> <!>',1);function Xa(f,n){Be(n,!1);let i=T(localStorage.getItem("autoBackupEnabled")==="true"),p=T(localStorage.getItem("autoBackupFolderName")),h=T(!1),c=T("");async function w(){try{e(i)?(Aa(),s(i,!1),s(p,null),s(c,"Auto backup disabled")):(await Sa(),s(i,!0),s(p,localStorage.getItem("autoBackupFolderName")),s(c,"Auto backup enabled (12:00 AM & 12:00 PM)"))}catch{s(i,!1),s(c,"Backup permission denied")}s(h,!0),setTimeout(()=>s(h,!1),1500)}Le();var b=Za(),u=Ue(b),$=l(a(u),2);de($);var I=l($,1,!0);t(u);var j=l(u,2);{var D=C=>{var S=Ya(),x=a(S);Ee(2),t(S),Z(()=>oe(x,`üìÅ ${e(p)??""}/lib-autobackup.json`)),k(C,S)};q(j,C=>{e(i)&&e(p)&&C(D)})}var L=l(j,2);Ut(L,{get showAlert(){return e(h)},get message(){return e(c)}}),Z(()=>{Qt($,e(i)),oe(I,e(i)==!0?"On":"Off")}),d("click",u,w),k(f,b),Oe()}var Ka=M('<div class="fixed inset-0 bg-black/50 z-150 flex" role="presentation"><div class="bg-base-100 w-80 h-full shadow-xl p-6 flex flex-col justify-between" role="dialog" tabindex="-1"><div><h2 class="text-2xl font-bold mb-6">Menu <button class="float-right cursor-pointer" aria-label="Close menu" type="button"><!></button></h2> <ul class="menu bg-base-200 rounded-box gap-1 md:gap-3"><li><button aria-label="Import JSON" class="btn btn-md btn-ghost"><!> Import JSON</button></li> <li><button aria-label="Export data" class="btn btn-md btn-ghost"><!> Export JSON</button></li> <li><button class="btn btn-md btn-ghost" aria-label="Export Markdown"><!> Export Md</button></li> <li><button aria-label="Open categories" class="btn btn-md btn-ghost"><!> Categories</button></li> <li><button class="btn btn-md btn-ghost">JSON Format</button></li></ul></div> <dialog class="modal"><div class="modal-box max-w-3xl w-85 md:w-full h-auto max-h-[65vh]"><form method="dialog"><button type="button" aria-label="CloseJSONmodal" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 text-lg p-5"><!></button></form> <h3 class="font-bold mb-2">Import JSON Structure</h3> <div class="prose max-w-full overflow-auto text-sm"><!></div></div></dialog> <div class="text-sm text-gray-500"><!> <div class="divider"></div> <p class="font-semibold my-4">ü§ñ AI √ó <a href="https://github.com/avinash-027/" target="_blank" class="link link-primary no-underline">User-A027</a> üë®‚Äçüíª</p></div></div></div>'),Qa=M('<!> <!> <input type="file" accept=".json" class="hidden"/>',1);function el(f,n){Be(n,!1);let i=fe(n,"show",12,!1),p=T(""),h=T(!1);const c=nt();let w=T();function b(){e(w).click()}function u(y){const N=y.target.files?.[0];if(!N)return;const O=new FileReader;O.onload=F=>{try{const H=JSON.parse(F.target?.result),Y=Array.isArray(H)?H:[H];c("import",Y)}catch{s(p,"Invalid JSON file"),s(h,!0),setTimeout(()=>{s(h,!1)},2e3)}},O.readAsText(N)}function $(){c("export")}let I=ha.parse(Va),j=T();function D(){e(j).showModal()}function L(){e(j).close()}Le();var C=Qa(),S=Ue(C);Ut(S,{get showAlert(){return e(h)},get message(){return e(p)}});var x=l(S,2);{var _=y=>{var g=Ka(),N=a(g),O=a(N),F=a(O),H=l(a(F)),Y=a(H);he(Y,()=>(te(W),J(()=>W.circleClose))),t(H),t(F);var A=l(F,2),R=a(A),re=a(R),ae=a(re);he(ae,()=>(te(W),J(()=>W.import))),Ee(),t(re),t(R);var X=l(R,2),ne=a(X),V=a(ne);he(V,()=>(te(W),J(()=>W.export))),Ee(),t(ne),t(X);var v=l(X,2),E=a(v),G=a(E);he(G,()=>(te(W),J(()=>W.export))),Ee(),t(E),t(v);var ce=l(v,2),ve=a(ce),le=a(ve);he(le,()=>(te(W),J(()=>W.category))),Ee(),t(ve),t(ce);var K=l(ce,2),Q=a(K);t(K),t(A),t(O);var z=l(O,2),ue=a(z),je=a(ue),Se=a(je),be=a(Se);he(be,()=>(te(W),J(()=>W.circleClose))),t(Se),t(je);var pe=l(je,4),Ae=a(pe);he(Ae,()=>I),t(pe),t(ue),t(z),Ot(z,ie=>s(j,ie),()=>e(j));var ke=l(z,2),Ge=a(ke);Xa(Ge,{}),Ee(4),t(ke),t(N),t(g),d("click",H,()=>i(!1)),d("click",re,b),d("click",ne,$),d("click",E,()=>c("exportMd")),d("click",ve,()=>c("showCategories")),d("click",Q,D),d("click",Se,L),d("click",z,ie=>{ie.target===e(j)&&L()}),d("click",N,Ve(function(ie){Qe.call(this,n,ie)})),d("keydown",N,Ve(function(ie){Qe.call(this,n,ie)})),d("click",g,()=>i(!1)),d("keydown",g,ie=>ie.key==="Escape"&&i(!1)),k(y,g)};q(x,y=>{i()&&y(_)})}var P=l(x,2);Ot(P,y=>s(w,y),()=>e(w)),d("change",P,u),k(f,C),Oe()}var tl=M('<option class="border border-base-200"> </option>'),al=M("<span>|</span>"),ll=M("<span> </span>"),sl=M('<div class="flex gap-2 flex-wrap mb-2 p-2 rounded-lg bg-base-200 border border-base-300"><div class="flex gap-2 w-full"><label class="floating-label w-full" for="charName"><span><span class="label-text">Name **</span></span> <input type="text" id="charName" placeholder="Name *" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charRole"><span><span class="label-text">Role</span></span> <input type="text" id="charRole" placeholder="role" class="input input-sm w-full"/></label> <button class="btn btn-sm btn-square btn-error btn-outline">‚úï</button></div> <label class="floating-label w-full" for="charImgUrl"><span><span class="label-text">Image URL</span></span> <input type="text" id="charImgUrl" placeholder="Img URL" class="input input-sm w-full"/></label> <details class="w-full mt-2"><summary class="cursor-pointer text-sm font-medium text-primary text-center">Extra Details</summary> <div class="space-y-2 mt-2"><label class="floating-label w-full" for="charAltNames"><span><span class="label-text">alternativeNames</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="charAltNames" placeholder="Alternative Names [Ex: Name01, name-01]" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charTags"><span><span class="label-text">char-Tags</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="charTags" placeholder="Tags [Ex: Hero, Villain]" class="input input-sm w-full"/></label> <label class="floating-label w-full" for="charDescription"><span><span class="label-text">Description</span></span> <textarea id="charDescription" placeholder="Description" class="textarea textarea-bordered w-full"></textarea></label></div></details></div>'),rl=M('<div class="card bg-base-200 border border-base-300 p-4"><div class="flex gap-2 mb-2"><label class="floating-label w-full"><span>Chapter *</span> <input type="text" placeholder="Chapter (e.g., 1-5)" class="input input-bordered w-full input-sm flex-1"/></label> <button class="btn btn-square btn-error btn-outline btn-sm"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-4 h-4 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <label class="floating-label w-full"><span>Description</span> <textarea placeholder="Description" class="textarea textarea-bordered w-full textarea-sm mb-2"></textarea></label> <label class="floating-label w-full"><span>Tags (comma separated)</span> <input type="text" placeholder="Tags (comma separated)" class="input input-bordered w-full input-sm mb-2"/></label> <label class="floating-label w-full"><span>Characters</span> <input type="text" placeholder="Characters" class="input input-bordered w-full input-sm"/></label></div>'),nl=M('<div class="fixed inset-0 bg-black/50 z-150 flex items-center justify-center p-4"><div class="bg-base-100 w-full max-w-4xl max-h-[90vh] overflow-auto rounded-lg shadow-xl"><div class="bg-base-100 border-b border-base-300 p-4 flex justify-between items-center"><h2 class="text-2xl font-bold"> </h2> <button class="btn btn-square btn-ghost btn-sm"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="p-6 space-y-4"><div class="form-control"><label for="newtitle" class="floating-label"><span>Title <span class="label-text-alt text-info italic">: required</span></span> <input id="newtitle" type="text" placeholder="Title" class="input input-bordered w-full" required=""/></label></div> <div class="form-control"><label for="newAltTitles" class="floating-label"><span><span class="label-text">Alternative Titles</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <input id="newAltTitles" type="text" placeholder="Alternative Titles [Ex: Title1, Title2]" class="input input-bordered w-full"/></label></div> <div class="form-control"><label for="newCoverImg" class="floating-label"><span class="label-text">Cover Image URL</span> <input id="newCoverImg" type="text" placeholder="Cover Image URL: Web Img Link" class="input input-bordered w-full"/></label></div> <div class="form-control"><label class="floating-label"><span class="label-text">Description</span> <textarea placeholder="Description" class="textarea textarea-bordered w-full h-24"></textarea></label></div> <div class="form-control"><label for="newBadges" class="floating-label"><span><span class="label-text">Badges</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <textarea id="newBadges" placeholder="Badges [Ex: Completed, Ongoing, Author, Artist, Favorite]" class="textarea textarea-bordered w-full"></textarea></label></div> <div class="form-control"><label for="newTags" class="floating-label"><span><span class="label-text">Tags</span> <span class="label-text-alt text-info italic">: Comma separated</span></span> <textarea id="newTags" placeholder="Tags [Ex: Themes, Genres]" class="textarea textarea-bordered w-full"></textarea></label></div> <div class="form-control"><label class="floating-label"><span class="label-text font-semibold">Category</span></label> <select class="select select-bordered w-full"><option class="border border-base-content/20 hover:bg-base-200">All</option><!></select></div> <div class="form-control"><label class="flex flex-wrap gap-2 justify-between"><span><span class="label-text font-semibold">Rating <span class="text-info">(0‚Äì10)</span></span></span> <div class="text-xs md:text-sm text-info"><span class="font-semibold">Value:</span> </div></label> <div class="w-full max-w-xs"><input type="range" min="0" max="10" step="1" class="range range-xs range-info"/> <div class="flex justify-between px-2.5 mt-1 text-xs"></div> <div class="flex justify-between px-2.5 mt-1 text-xs"></div></div></div> <div class="divider">Characters</div> <div class="space-y-2"><!> <button class="btn btn-outline btn-sm">+ Add Character</button></div> <div class="divider">Chapters</div> <div class="space-y-2"><!> <button class="btn btn-outline btn-sm">+ Add Chapter</button></div></div> <div class="sticky bottom-0 bg-base-100 border-t border-base-300 p-4 flex gap-2 justify-end"><button class="btn btn-outline">Cancel</button> <button class="btn btn-primary">Save</button></div></div></div>');function ol(f,n){Be(n,!1);const i=()=>Me(Pe,"$categories",p),[p,h]=ot();let c=fe(n,"entryId",8,null);const w=nt();let b=T(""),u=T(""),$=T(""),I=T(""),j=T(""),D=T(0),L=T(""),C=T("All"),S=T([]),x=T([]);Jt(async()=>{if(c()!==null){const m=await se.getEntryById(c());m&&(s(b,m.title),s(u,m.alternativeTitles.join(", ")),s($,m.coverImageUrl||""),s(I,m.description),s(j,m.badges.join(", ")),s(D,Number(m.rating)),s(L,m.tags.join(", ")),s(C,m.category),s(S,m.characters.map(o=>({...o,_alternativeNamesString:(o.alternativeNames??[]).join(", "),_tagsString:(o.tags??[]).join(", ")}))),s(x,m.rows.map(o=>({...structuredClone(o),_tagsText:o.tags.join(", ")}))))}});function _(){s(S,[...e(S),{Name:"",Image:"",role:"",alternativeNames:[],tags:[],description:"",_alternativeNamesString:"",_tagsString:""}])}function P(m){s(S,e(S).filter((o,U)=>U!==m))}function y(){s(x,[...e(x),{chapterSE:"",description:"",characters:"",_tagsText:""}])}function g(m){s(x,e(x).filter((o,U)=>U!==m))}async function N(){const m={title:e(b),alternativeTitles:e(u).split(",").map(o=>o.trim()).filter(Boolean),coverImageUrl:e($)||null,description:e(I),badges:e(j).split(",").map(o=>o.trim()).filter(Boolean),rating:Number(e(D)),createdAt:null,openedAt:null,editedAt:null,tags:e(L).split(",").map(o=>o.trim()).filter(Boolean),category:e(C)||"All",dataType:"Lib",characters:e(S).filter(o=>o.name).map(o=>({name:o.name,image:o.image,role:o.role,description:o.description,alternativeNames:(o._alternativeNamesString??"").split(",").map(U=>U.trim()).filter(Boolean),tags:(o._tagsString??"").split(",").map(U=>U.trim()).filter(Boolean)})),rows:e(x).filter(o=>o.chapterSE).map(o=>({chapterSE:o.chapterSE,description:o.description,characters:o.characters,tags:o._tagsText.split(",").map(U=>U.trim()).filter(Boolean)}))};c()!==null?await se.updateEntry(c(),m):await se.addEntry(m),w("save")}function O(){w("cancel")}Le();var F=nl(),H=a(F),Y=a(H),A=a(Y),R=a(A,!0);t(A);var re=l(A,2);t(Y);var ae=l(Y,2),X=a(ae),ne=a(X),V=l(a(ne),2);de(V),t(ne),t(X);var v=l(X,2),E=a(v),G=l(a(E),2);de(G),t(E),t(v);var ce=l(v,2),ve=a(ce),le=l(a(ve),2);de(le),t(ve),t(ce);var K=l(ce,2),Q=a(K),z=l(a(Q),2);ft(z),t(Q),t(K);var ue=l(K,2),je=a(ue),Se=l(a(je),2);ft(Se),t(je),t(ue);var be=l(ue,2),pe=a(be),Ae=l(a(pe),2);ft(Ae),t(pe),t(be);var ke=l(be,2),Ge=l(a(ke),2),ie=a(Ge);ie.value=ie.__value="All";var kt=l(ie);Ie(kt,1,()=>(i(),J(()=>i().filter(m=>m!=="All"))),He,(m,o)=>{var U=tl(),we=a(U,!0);t(U);var Ce={};Z(()=>{oe(we,e(o)),Ce!==(Ce=e(o))&&(U.value=(U.__value=e(o))??"")}),k(m,U)}),t(Ge),t(ke);var et=l(ke,2),tt=a(et),Ct=l(a(tt),2),St=l(a(Ct));t(Ct),t(tt);var Ye=l(tt,2),it=a(Ye);de(it);var Ze=l(it,2);Ie(Ze,4,()=>J(()=>Array.from({length:11},(m,o)=>o)),He,(m,o)=>{var U=al();Z(()=>De(U,1,Wt(o===e(D)?"text-info font-bold":""))),k(m,U)}),t(Ze);var at=l(Ze,2);Ie(at,4,()=>J(()=>Array.from({length:11},(m,o)=>o)),He,(m,o)=>{var U=ll(),we=a(U,!0);t(U),Z(()=>{De(U,1,Wt(o===e(D)?"text-info font-bold":"")),oe(we,o)}),k(m,U)}),t(at),t(Ye),t(et);var dt=l(et,4),lt=a(dt);Ie(lt,1,()=>e(S),He,(m,o,U)=>{var we=sl(),Ce=a(we),xe=a(Ce),qe=l(a(xe),2);de(qe),t(xe);var ze=l(xe,2),Fe=l(a(ze),2);de(Fe),t(ze);var st=l(ze,2);t(Ce);var $e=l(Ce,2),Re=l(a($e),2);de(Re),t($e);var Ke=l($e,2),We=l(a(Ke),2),_e=a(We),ut=l(a(_e),2);de(ut),t(_e);var bt=l(_e,2),pt=l(a(bt),2);de(pt),t(bt);var Mt=l(bt,2),gt=l(a(Mt),2);ft(gt),t(Mt),t(We),t(Ke),t(we),ee(qe,()=>e(o).name,ye=>(e(o).name=ye,Ne(()=>e(S)))),ee(Fe,()=>e(o).role,ye=>(e(o).role=ye,Ne(()=>e(S)))),d("click",st,()=>P(U)),ee(Re,()=>e(o).image,ye=>(e(o).image=ye,Ne(()=>e(S)))),ee(ut,()=>e(o)._alternativeNamesString,ye=>(e(o)._alternativeNamesString=ye,Ne(()=>e(S)))),ee(pt,()=>e(o)._tagsString,ye=>(e(o)._tagsString=ye,Ne(()=>e(S)))),ee(gt,()=>e(o).description,ye=>(e(o).description=ye,Ne(()=>e(S)))),k(m,we)});var ct=l(lt,2);t(dt);var At=l(dt,4),Xe=a(At);Ie(Xe,1,()=>e(x),He,(m,o,U)=>{var we=rl(),Ce=a(we),xe=a(Ce),qe=l(a(xe),2);de(qe),t(xe);var ze=l(xe,2);t(Ce);var Fe=l(Ce,2),st=l(a(Fe),2);ft(st),t(Fe);var $e=l(Fe,2),Re=l(a($e),2);de(Re),t($e);var Ke=l($e,2),We=l(a(Ke),2);de(We),t(Ke),t(we),ee(qe,()=>e(o).chapterSE,_e=>(e(o).chapterSE=_e,Ne(()=>e(x)))),d("click",ze,()=>g(U)),ee(st,()=>e(o).description,_e=>(e(o).description=_e,Ne(()=>e(x)))),ee(Re,()=>e(o)._tagsText,_e=>(e(o)._tagsText=_e,Ne(()=>e(x)))),ee(We,()=>e(o).characters,_e=>(e(o).characters=_e,Ne(()=>e(x)))),k(m,we)});var Dt=l(Xe,2);t(At),t(ae);var Tt=l(ae,2),vt=a(Tt),Et=l(vt,2);t(Tt),t(H),t(F),Z(()=>{oe(R,c()!==null?"Edit Entry":"New Entry"),oe(St,` ${e(D)??""} - ${te(Pt),e(D),J(()=>Pt[e(D)])??""}`),Et.disabled=!e(b)||!e(C)}),d("click",re,O),ee(V,()=>e(b),m=>s(b,m)),ee(G,()=>e(u),m=>s(u,m)),ee(le,()=>e($),m=>s($,m)),ee(z,()=>e(I),m=>s(I,m)),ee(Se,()=>e(j),m=>s(j,m)),ee(Ae,()=>e(L),m=>s(L,m)),Kt(Ge,()=>e(C),m=>s(C,m)),ee(it,()=>e(D),m=>s(D,m)),d("click",ct,_),d("click",Dt,y),d("click",vt,O),d("click",Et,N),d("click",H,Ve(function(m){Qe.call(this,n,m)})),d("click",F,O),k(f,F),Oe(),h()}var il=M('<input class="input input-sm input-bordered flex-1 mr-2"/>'),dl=M('<span class="truncate cursor-pointer"> </span>'),cl=M('<button class="btn btn-sm btn-success">Save</button>'),vl=M('<button class="btn btn-xs btn-info">Edit</button> <button class="btn btn-xs btn-error">Delete</button>',1),ul=M('<div class="flex gap-2"><!></div>'),bl=M('<li class="mb-2 flex items-center justify-between"><!> <!></li>'),pl=M(`<div class="fixed inset-0 z-150 flex bg-black/50" role="button" tabindex="0" aria-label="Close categories modal"><div class="h-full w-96 bg-base-100 p-6 shadow-xl flex flex-col" role="document"><h2 class="mb-6 text-2xl font-bold">Categories</h2> <div class="flex-1 overflow-y-auto pr-1 border border-base-content/30 rounded-xl p-1 px-2"><ul class="mb-4"></ul></div> <div class="flex gap-2 mt-3"><input class="input-bordered input flex-1" placeholder="New category"/> <button aria-label="Add new category" class="btn btn-primary">Add</button></div> <button class="btn btn-soft mt-2 w-full">Close</button> <div class="mt-1 px-1 text-xs justify-center text-success"><span> </span></div> <div class="my-2 alert alert-default alert-soft "><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>When a category is <b>deleted</b>, all entries in that category are <b>moved to the 'All'</b> category</span></div></div></div>`);function gl(f,n){Be(n,!1);const i=()=>Me(Pe,"$categories",p),[p,h]=ot();let c=fe(n,"show",8,!1);const w=nt();let b=T(""),u=T(null),$=T("");function I(g){s(u,g),s($,g)}async function j(g){const N=e($).trim();if(!N||N==="All"||N===g){s(u,null);return}await Pe.rename(g,N),w("rename",{old:g,new:N}),s(u,null),S(`Category renamed to "${N}"`)}async function D(){const g=e(b).trim();!g||g==="All"||(await Pe.add(g),s(b,""))}let L=T(""),C=T(!1);function S(g,N=2e3){s(L,g),s(C,!0),setTimeout(()=>{s(C,!1)},N)}async function x(g){g!=="All"&&(await se.moveCategoryToAll(g),await Pe.remove(g),S(`Category "${g}" deleted. Entries moved to 'All'.`))}Jt(()=>{Pe.load()}),Le();var _=_t(),P=Ue(_);{var y=g=>{var N=pl(),O=a(N),F=l(a(O),2),H=a(F);Ie(H,5,()=>(i(),J(()=>["All",...i().filter(V=>V!=="All")])),He,(V,v)=>{var E=bl(),G=a(E);{var ce=Q=>{var z=il();de(z),da(z),ee(z,()=>e($),ue=>s($,ue)),d("keydown",z,ue=>ue.key==="Enter"&&j(e(v))),d("blur",z,()=>j(e(v))),k(Q,z)},ve=Q=>{var z=dl(),ue=a(z,!0);t(z),Z(()=>oe(ue,e(v))),d("dblclick",z,()=>I(e(v))),k(Q,z)};q(G,Q=>{e(u)===e(v)?Q(ce):Q(ve,!1)})}var le=l(G,2);{var K=Q=>{var z=ul(),ue=a(z);{var je=be=>{var pe=cl();d("click",pe,Ve(()=>j(e(v)))),k(be,pe)},Se=be=>{var pe=vl(),Ae=Ue(pe),ke=l(Ae,2);d("click",Ae,Ve(()=>I(e(v)))),d("click",ke,Ve(()=>x(e(v)))),k(be,pe)};q(ue,be=>{e(u)===e(v)?be(je):be(Se,!1)})}t(z),k(Q,z)};q(le,Q=>{e(v)!=="All"&&Q(K)})}t(E),k(V,E)}),t(H),t(F);var Y=l(F,2),A=a(Y);de(A);var R=l(A,2);t(Y);var re=l(Y,2),ae=l(re,2),X=a(ae),ne=a(X,!0);t(X),t(ae),Ee(2),t(O),t(N),Z(()=>{ea(ae,`min-height: 1.55rem; max-height: 1.55rem; visibility: ${e(C)?"visible":"hidden"}`),oe(ne,e(L))}),ee(A,()=>e(b),V=>s(b,V)),d("click",R,D),d("click",re,()=>w("close")),d("click",O,Ve(function(V){Qe.call(this,n,V)})),d("click",N,()=>w("close")),d("keydown",N,V=>{(V.key==="Enter"||V.key===" ")&&w("close")}),k(g,N)};q(P,g=>{c()&&g(y)})}k(f,_),Oe(),h()}var fl=M('<li><input type="radio" name="theme-dropdown" class="theme-controller btn btn-sm btn-block btn-ghost justify-start"/></li>'),ml=M('<div><div tabindex="0" role="button" class="btn p-2 m-0 rounded-2xl">üé® <svg width="12px" height="12px" class="inline-block h-1 w-1 fill-current opacity-60" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048"><path d="M1799 349l242 241-1017 1017L7 590l242-241 775 775 775-775z"></path></svg></div> <ul tabindex="-1" class="dropdown-content menu bg-base-300 rounded-2xl z-150 w-52 p-2 shadow-sm"></ul></div>');function hl(f,n){Be(n,!1);const i=()=>Me(Vt,"$theme",p),[p,h]=ot(),c=["light","cupcake","night","dark","emerald","fantasy","luxury","acid","coffee","retro","business","dracula","dim","garden"];let w=fe(n,"dropdownDirection",8,"dropdown-end");function b(I){Vt.set(I)}Le();var u=ml(),$=l(a(u),2);Ie($,5,()=>c,He,(I,j)=>{var D=fl(),L=a(D);de(L),t(D),Z(()=>{yt(L,"aria-label",e(j)),wa(L,e(j)),Qt(L,i()===e(j))}),d("change",L,()=>b(e(j))),k(I,D)}),t($),t(u),Z(()=>De(u,1,`dropdown ${w()}`)),k(f,u),Oe(),h()}var wl=M('<span class="absolute -top-6 -left-2 flex h-5 w-20 items-center justify-center rounded-full bg-red-600 text-xs font-bold text-white p-1"> </span>'),xl=M('<li><button class="w-full border border-base-300 text-left hover:bg-base-200"> </button></li>'),_l=M('<ul class="dropdown-content menu mt-3 w-52 rounded-box bg-base-100 p-2 shadow-md"></ul>'),yl=M('<div class="fixed top-16 left-1/2 z-50 flex items-center gap-4 rounded-lg border border-base-300 bg-base-100 p-2 shadow-md select-none"><div role="button" tabindex="0" class="cursor-grab rounded-md bg-base-200 p-2 hidden md:inline-block" aria-label="Drag toolbar">‚†ø</div> <div class="tooltip" data-tip="Delete"><button class="btn relative btn-square btn-error" aria-label="Delete selected"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 7h12M10 11v6m4-6v6M5 7l1 12a2 2 0 002 2h8a2 2 0 002-2l1-12M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3"></path></svg> <!></button></div> <div class="tooltip" data-tip="Select all"><button class="btn btn-square btn-ghost" aria-label="Select all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7M5 7l4 4L19 1"></path></svg></button></div> <div class="tooltip" data-tip="Deselect all"><button class="btn btn-square opacity-50 btn-ghost" aria-label="Deselect all"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current opacity-20"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7M5 7l4 4L19 1"></path></svg></button></div> <div><div class="tooltip" data-tip="Move to category"><button class="btn btn-square btn-ghost" aria-label="Move to category"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4h16v4H4V4zm0 8h16v4H4v-4zm0 8h16v4H4v-4z"></path></svg></button></div> <!></div> <div class="tooltip" data-tip="Cancel"><button class="btn btn-square bg-red-700 text-white btn-ghost hover:bg-red-500" aria-label="Cancel selection"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div role="button" tabindex="0" class="drag-handle cursor-grab rounded-md bg-base-200 p-2" aria-label="Drag toolbar">‚†ø</div></div>');function kl(f,n){Be(n,!1);let i=fe(n,"selectedCount",8,0),p=fe(n,"categoryList",24,()=>[]),h=fe(n,"showCategoryDropdown",8,!1);const c=nt();let w=!1,b=0,u=0,$=T(0),I=T(0);function j(v){w=!0,b=v.clientX-e($),u=v.clientY-e(I),window.addEventListener("pointermove",D),window.addEventListener("pointerup",L)}function D(v){w&&(s($,v.clientX-b),s(I,v.clientY-u))}function L(){w=!1,window.removeEventListener("pointermove",D),window.removeEventListener("pointerup",L)}Le();var C=yl(),S=a(C),x=l(S,2),_=a(x),P=l(a(_),2);{var y=v=>{var E=wl(),G=a(E,!0);t(E),Z(()=>oe(G,i())),k(v,E)};q(P,v=>{i()>0&&v(y)})}t(_),t(x);var g=l(x,2),N=a(g);t(g);var O=l(g,2),F=a(O);t(O);var H=l(O,2);let Y;var A=a(H),R=a(A);t(A);var re=l(A,2);{var ae=v=>{var E=_l();Ie(E,5,p,He,(G,ce)=>{var ve=xl(),le=a(ve),K=a(le,!0);t(le),t(ve),Z(()=>oe(K,e(ce))),d("click",le,()=>c("moveCategory",e(ce))),k(G,ve)}),t(E),k(v,E)};q(re,v=>{te(h()),te(p()),J(()=>h()&&p().length>0)&&v(ae)})}t(H);var X=l(H,2),ne=a(X);t(X);var V=l(X,2);t(C),Z(()=>{ea(C,`transform: translate(calc(-50% + ${e($)??""}px), ${e(I)??""}px);`),_.disabled=i()===0,Y=De(H,1,"dropdown dropdown-end",null,Y,{"dropdown-open":h()}),R.disabled=i()===0}),d("pointerdown",S,j),d("click",_,()=>c("delete")),d("click",N,()=>c("selectAll")),d("click",F,()=>c("deselectAll")),d("click",R,()=>c("toggleCategoryDropdown")),d("click",ne,()=>c("cancel")),d("pointerdown",V,j),k(f,C),Oe()}var Cl=Zt('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4h16v16H4V4z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M8 12h8"></path></svg>'),Sl=Zt('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2"><rect x="4" y="4" width="16" height="16" stroke="currentColor" stroke-width="2"></rect><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h8"></path></svg>'),Al=M('<button><div class="indicator"><span class="indicator-item bg-base-100 text-xs rounded-3xl px-1.5 py-0.5 -top-1"> </span> <div class="z-10"> </div></div></button>'),Tl=M('<div class="flex h-screen flex-col"><div class="navbar bg-base-100 shadow-lg"><div class="flex-none"><button class="btn btn-square btn-ghost" aria-label="Open menu"><!></button></div> <div class="flex-1"><span class="text-md md:text-xl font-bold"> <span class="hide-on-320 svelte-j9gjs9"> </span></span></div> <div class="flex-none"><button class="btn btn-square btn-ghost" aria-label="Toggle search"><!></button> <div class="tooltip tooltip-bottom" data-tip="Open filters"><button class="btn btn-square btn-ghost" aria-label="Open filters"><!></button></div> <div class="tooltip tooltip-bottom" data-tip="Select entries"><button class="btn btn-square btn-ghost" aria-label="Select entries"><!></button></div> <button class="btn btn-square btn-ghost inline-block md:hidden" aria-label="Toggle grid columns" title="Toggle grid columns"><!></button> <!></div></div> <!> <div class="tabs tabs-border flex-nowrap gap-1 overflow-x-auto bg-base-200 px-2 pt-2 pb-1 scrollbar-hide"><button class="p-0 m-0" title="Toggle unique entries" aria-label="Show unique entries only"><!></button> <button><div class="z-10">All</div> <span class="bg-base-100 text-xs rounded-3xl px-1.5 py-0.5"> </span></button> <!></div> <button class="z-100 btn fixed right-6 bottom-6 btn-circle shadow-xl btn-lg btn-primary" aria-label="Add new entry"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block h-6 w-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg></button> <!>  <div class="flex-1 overflow-auto p-4"><!></div></div> <!> <!> <!> <!> <!> <!>',1);function El(f,n){Be(n,!1);const i=()=>Me(Ca,"$filteredEntries",b),p=()=>Me(rt,"$selectedCategory",b),h=()=>Me(Pe,"$categories",b),c=()=>Me($t,"$entries",b),w=()=>Me(Yt,"$gridCols",b),[b,u]=ot(),$=T(),I=T();let j=T(!1),D=T(!1),L=T(!1),C=T(!1),S=T(!1),x=T(null),_=T(null),P=T(!1),y=T(new Set),g=T(!1);const N=nt();let O=T(!1),F=T(""),H=T(!1);function Y(){Yt.update(r=>r===3?4:3)}async function A(){const r=await se.getAllEntries();$t.set(r),Array.from(new Set(r.map(B=>B.category).filter(B=>B&&B!=="All"))),Pe.load()}Jt(async()=>{await A(),Ta();const r=localStorage.getItem("selectedCategory");r&&rt.set(r)});function R(){s(x,null),s(S,!0),s(g,!1)}async function re(){s(S,!1),s(x,null),await A()}function ae(){s(S,!1),s(x,null)}async function X(){s(C,!1),s(_,null),await A()}function ne(){s(C,!1),s(_,null)}let V;function v(r){s(F,r),s(H,!0),clearTimeout(V),V=window.setTimeout(()=>{s(H,!1)},1500)}async function E(r){await se.importFromJSON(r),await A(),s(L,!1)}async function G(){const r=await se.exportToJSON(),B=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),me=URL.createObjectURL(B),ge=document.createElement("a");ge.href=me,ge.download=`lib-export-${new Date().toISOString()}.json`,document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),URL.revokeObjectURL(me),s(L,!1),v("Exported to JSON üëç :Downloads/")}async function ce(){const r=await se.exportToMarkdown(),B=new Blob([r],{type:"text/markdown"}),me=URL.createObjectURL(B),ge=document.createElement("a");ge.href=me,ge.download=`lib-export-${new Date().toISOString()}.md`,document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),URL.revokeObjectURL(me),s(L,!1),v("Exported to Markdown üëç :Downloads/")}async function ve(r){await se.moveCategoryToAll(r),p()===r&&rt.set("All"),await A(),s(P,!1)}let le=T(!1);async function K(r){for(const me of e(y))c().find(jt=>jt.id===me)&&await se.updateEntry(me,{category:r});e(y).clear(),s(y,new Set(e(y))),s(g,!1);const B=await se.getAllEntries();$t.set(B),s(le,!1)}function Q(r){e(y).has(r)?e(y).delete(r):e(y).add(r),s(y,new Set(e(y)))}async function z(){if(e(y).size===0)return;const r=Array.from(e(y));for(const B of r)await se.deleteEntry(B);e(y).clear(),s(y,new Set(e(y))),await A(),s(g,!1)}function ue(){s(y,new Set(i().map(r=>r.id)))}function je(){e(y).clear(),s(y,new Set(e(y)))}wt(()=>(e(O),i(),Gt),()=>{s($,e(O)?Array.from(new Map(i().map(r=>[Gt(r),r])).values()):i())}),wt(()=>h(),()=>{s(I,h().filter(r=>r!=="All"))}),Xt(),Le();var Se=Tl(),be=Ue(Se),pe=a(be),Ae=a(pe),ke=a(Ae),Ge=a(ke);he(Ge,()=>(te(W),J(()=>W.menu))),t(ke),t(Ae);var ie=l(Ae,2),kt=a(ie),et=a(kt);et.nodeValue="Lib ";var tt=l(et),Ct=a(tt);t(tt),t(kt),t(ie);var St=l(ie,2),Ye=a(St),it=a(Ye);he(it,()=>(te(W),J(()=>W.search))),t(Ye);var Ze=l(Ye,2),at=a(Ze),dt=a(at);he(dt,()=>(te(W),J(()=>W.filter))),t(at),t(Ze);var lt=l(Ze,2),ct=a(lt),At=a(ct);he(At,()=>(te(W),J(()=>W.select))),t(ct),t(lt);var Xe=l(lt,2),Dt=a(Xe);he(Dt,()=>(te(W),J(()=>W.toggleGrid))),t(Xe);var Tt=l(Xe,2);hl(Tt,{dropdownDirection:"dropdown-bottom dropdown-end"}),t(St),t(pe);var vt=l(pe,2);{var Et=r=>{Ra(r,{get show(){return e(j)},set show(B){s(j,B)},$$legacy:!0})};q(vt,r=>{e(j)&&r(Et)})}var m=l(vt,2),o=a(m),U=a(o);{var we=r=>{var B=Cl();k(r,B)},Ce=r=>{var B=Sl();k(r,B)};q(U,r=>{e(O)?r(we):r(Ce,!1)})}t(o);var xe=l(o,2);let qe;var ze=l(a(xe),2),Fe=a(ze,!0);t(ze),t(xe);var st=l(xe,2);Ie(st,1,()=>e(I),He,(r,B)=>{var me=Al();let ge;var jt=a(me),Lt=a(jt),ra=a(Lt,!0);t(Lt);var Ft=l(Lt,2),na=a(Ft,!0);t(Ft),t(jt),t(me),Z(Bt=>{ge=De(me,1,"tab",null,ge,{"tab-active":p()===e(B)}),oe(ra,Bt),oe(na,e(B))},[()=>(c(),e(B),J(()=>c().filter(Bt=>Bt.category===e(B)).length))]),d("click",me,()=>rt.set(e(B))),k(r,me)}),t(m);var $e=l(m,2),Re=l($e,2);{var Ke=r=>{kl(r,{get selectedCount(){return e(y),J(()=>e(y).size)},get categoryList(){return e(I)},get showCategoryDropdown(){return e(le)},$$events:{delete:z,selectAll:ue,deselectAll:je,toggleCategoryDropdown:()=>s(le,!e(le)),moveCategory:B=>K(B.detail),cancel:()=>{s(g,!1),s(le,!1),e(y).clear(),s(y,new Set(e(y)))}}})};q(Re,r=>{e(g)&&r(Ke)})}var We=l(Re,2),_e=a(We);Oa(_e,{get entries(){return e($)},get selectionMode(){return e(g)},get selectedEntries(){return e(y)},get gridCols(){return w()},$$events:{toggleSelect:r=>Q(r.detail)}}),t(We),t(be);var ut=l(be,2);{var bt=r=>{Pa(r,{get show(){return e(D)},set show(B){s(D,B)},$$legacy:!0})};q(ut,r=>{e(D)&&r(bt)})}var pt=l(ut,2);{var Mt=r=>{el(r,{get show(){return e(L)},set show(B){s(L,B)},$$events:{import:B=>E(B.detail),export:G,exportMd:ce,showCategories:()=>{s(L,!1),s(P,!0)}},$$legacy:!0})};q(pt,r=>{e(L)&&r(Mt)})}var gt=l(pt,2);{var ye=r=>{gl(r,{get show(){return e(P)},$$events:{close:()=>s(P,!1),rename:B=>N("renameCategory",B.detail),delete:B=>ve(B.detail)}})};q(gt,r=>{e(P)&&r(ye)})}var qt=l(gt,2);{var aa=r=>{xa(r,{get entryId(){return e(_)},$$events:{save:X,cancel:ne}})};q(qt,r=>{e(C)&&r(aa)})}var zt=l(qt,2);{var la=r=>{ol(r,{get entryId(){return e(x)},$$events:{save:re,cancel:ae}})};q(zt,r=>{e(S)&&r(la)})}var sa=l(zt,2);Ut(sa,{get showAlert(){return e(H)},get message(){return e(F)}}),Z(()=>{oe(Ct,`(${c(),J(()=>c().length)??""})`),qe=De(xe,1,"tab relative",null,qe,{"tab-active":p()==="All"}),oe(Fe,(c(),J(()=>c().length)))}),d("click",ke,()=>s(L,!0)),d("click",Ye,()=>{s(j,!e(j)),s(g,!1)}),d("click",at,()=>{s(D,!e(D)),s(g,!1)}),d("click",ct,()=>{e(g)&&(e(y).clear(),s(y,new Set(e(y))),s(le,!1)),s(g,!e(g))}),d("click",Xe,Y),d("click",o,()=>s(O,!e(O))),d("click",xe,()=>rt.set("All")),d("click",$e,R),k(f,Se),Oe(),u()}function Hl(f){ua("1uha8ag",n=>{ca(()=>{va.title="lib"})}),El(f,{})}export{Hl as component};
